# Attack Surface Analysis for mislav/will_paginate

## Attack Surface: [Cross-Site Scripting (XSS) via Pagination Links](./attack_surfaces/cross-site_scripting__xss__via_pagination_links.md)

*   **Attack Surface:** Cross-Site Scripting (XSS) via Pagination Links
    *   **Description:** If user-provided data (e.g., search terms, filters) is used to construct pagination links generated by `will_paginate` without proper encoding, it can lead to XSS vulnerabilities.
    *   **How will_paginate contributes:** The gem generates HTML links for navigation. If the application integrates user input into these links without sanitization, malicious scripts can be injected.
    *   **Example:** An attacker crafts a URL with a malicious script in a search parameter that is then reflected in the pagination links generated by `will_paginate`. When another user clicks on this link, the script executes in their browser.
    *   **Impact:**
        *   Account compromise: Attackers can steal cookies or session tokens.
        *   Redirection to malicious websites.
        *   Defacement of the website.
        *   Execution of arbitrary JavaScript in the user's browser.
    *   **Risk Severity:** High
    *   **Mitigation Strategies:**
        *   **Output encoding:**  Ensure all user-provided data used in generating pagination links is properly HTML encoded before being rendered. This prevents the browser from interpreting the data as executable code.
        *   **Contextual output escaping:** Use appropriate escaping methods based on the context where the data is being used (e.g., URL encoding for parameters).
        *   **Content Security Policy (CSP):** Implement a strong CSP to mitigate the impact of XSS attacks by controlling the sources from which the browser is allowed to load resources.

## Attack Surface: [Unvalidated `per_page` Parameter (if enabled)](./attack_surfaces/unvalidated__per_page__parameter__if_enabled_.md)

*   **Attack Surface:** Unvalidated `per_page` Parameter (if enabled)
    *   **Description:** If the application allows users to specify the number of items per page using a `per_page` parameter, lack of validation can lead to abuse.
    *   **How will_paginate contributes:** While `will_paginate` can utilize a `per_page` parameter, it doesn't enforce limits on its value. The application developer is responsible for handling this.
    *   **Example:** An attacker modifies the URL to include `?per_page=9999` or `?per_page=0`.
    *   **Impact:**
        *   **Denial of Service (DoS):** Requesting an extremely large `per_page` value can cause the server to attempt to retrieve and render a massive amount of data, potentially overwhelming resources.
        *   **Performance degradation:**  Large `per_page` values can lead to slow page load times for all users.
        *   Unexpected application behavior if `per_page` is set to zero or a negative value.
    *   **Risk Severity:** High
    *   **Mitigation Strategies:**
        *   **Server-side validation:** Implement strict validation on the `per_page` parameter, enforcing a reasonable maximum and minimum value.
        *   **Whitelisting allowed values:** If there are specific allowed values for `per_page`, enforce this whitelist.
        *   **Default value:** Set a sensible default value for `per_page` to mitigate the impact of missing or invalid parameters.

