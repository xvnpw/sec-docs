## Deep Security Analysis of Octopress - Security Design Review

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to provide a thorough evaluation of the Octopress blogging framework, focusing on its architecture, components, and typical deployment scenarios to identify potential security vulnerabilities and recommend actionable mitigation strategies. The analysis will delve into the security implications of each key component, considering the specific context of a static site generator built on Jekyll and commonly deployed on platforms like GitHub Pages. The ultimate objective is to enhance the security posture of Octopress blogs, protecting blog content, author integrity, and user experience.

**Scope:**

The scope of this analysis encompasses the following:

* **Octopress Framework:** Core components, CLI tools, and integration with Jekyll.
* **Jekyll Engine:** As the underlying static site generator, its security characteristics are inherently part of Octopress's security posture.
* **Themes and Plugins:** Security considerations related to third-party themes and plugins used within Octopress.
* **Content Creation and Management Workflow:** Security aspects of blog authoring, content storage, and version control using Git.
* **Deployment Process:** Typical deployment scenarios, particularly focusing on GitHub Pages and similar static hosting platforms, including the build process using GitHub Actions.
* **Identified Security Controls and Risks:** Analysis of the security controls and accepted risks outlined in the provided Security Design Review.

The analysis will **exclude** the detailed security assessment of the underlying infrastructure of hosting platforms like GitHub Pages, as this is considered an accepted risk and is managed by the hosting provider.

**Methodology:**

The methodology employed for this deep analysis will involve the following steps:

1. **Document Review:**  In-depth review of the provided Security Design Review document, C4 Context and Container diagrams, Deployment and Build process descriptions, and Risk Assessment.
2. **Architecture and Data Flow Inference:** Based on the provided documentation and general knowledge of Octopress and Jekyll, infer the system architecture, component interactions, and data flow paths.
3. **Component-Based Security Analysis:** Break down the Octopress system into its key components (as identified in the Container Diagram) and analyze the security implications of each component. This will involve identifying potential threats and vulnerabilities specific to each component and its function within the system.
4. **Threat Modeling:**  Utilize a threat modeling approach to identify potential attack vectors and threat actors relevant to Octopress blogs. This will be informed by the business and security posture outlined in the design review.
5. **Control Effectiveness Evaluation:** Assess the effectiveness of existing and recommended security controls in mitigating the identified threats.
6. **Tailored Mitigation Strategy Development:**  Develop specific, actionable, and tailored mitigation strategies for each identified security risk, focusing on practical recommendations applicable to Octopress and its typical usage.
7. **Documentation and Reporting:**  Document the findings, analysis, identified risks, and recommended mitigation strategies in a comprehensive report.

### 2. Security Implications of Key Components

Based on the C4 Container Diagram and the provided descriptions, the key components of Octopress and their security implications are analyzed below:

**2.1. Octopress CLI (Container):**

* **Function:** Command-line interface for blog authors to create, manage, and generate blog websites. Orchestrates Jekyll and Theme Engines.
* **Security Implications:**
    * **Local Machine Security:** The security of the Octopress CLI is heavily dependent on the security of the Blog Author's local machine. If the author's machine is compromised, the Octopress environment and blog content could be at risk.
    * **Command Injection (Low Risk):** While unlikely in standard Octopress usage, if the CLI were to process untrusted external input (e.g., through a poorly designed plugin or script), there could be a risk of command injection. However, in its core functionality, Octopress CLI primarily executes predefined commands.
    * **Dependency Vulnerabilities:** The CLI relies on Ruby and potentially other dependencies. Vulnerabilities in these dependencies could indirectly affect the CLI's security.
    * **Configuration Exposure:**  If configuration files are not properly secured on the local machine, sensitive information (though minimal in typical Octopress setups) could be exposed if the machine is compromised.

**2.2. Jekyll Engine (Container):**

* **Function:** Core static site generation engine. Processes content files, configuration, and themes to generate static website files.
* **Security Implications:**
    * **Jekyll Vulnerabilities:** Octopress directly inherits any vulnerabilities present in the underlying Jekyll engine. Staying updated with Jekyll security patches is crucial.
    * **Plugin Vulnerabilities (Accepted Risk):** Jekyll's plugin ecosystem is a significant attack surface. Malicious or vulnerable plugins can introduce various security issues, including XSS, arbitrary code execution during build time, or information disclosure. This is an accepted risk in the Security Design Review, highlighting the importance of careful plugin selection and management.
    * **Theme Vulnerabilities (Accepted Risk):** Similar to plugins, themes can also contain vulnerabilities, particularly XSS if themes dynamically render user-controlled content or are poorly coded. This is also an accepted risk, emphasizing the need for theme vetting.
    * **Input Validation during Content Processing:** Jekyll parses Markdown and other content formats. Vulnerabilities in the parsing process could potentially be exploited, although this is less likely in well-maintained parsers. However, if custom Liquid tags or complex content processing is introduced, input validation becomes more critical.

**2.3. Theme Engine (Container):**

* **Function:** Applies themes and layouts to style the generated blog website.
* **Security Implications:**
    * **Theme Vulnerabilities (Repetitive, but important):** As mentioned, themes are a primary source of potential vulnerabilities, especially XSS. If a theme includes JavaScript or dynamically generates HTML based on configuration or content, it can be exploited if not properly secured.
    * **Insecure Theme Configurations:**  Themes might offer configuration options that, if misused, could introduce security weaknesses. For example, allowing arbitrary HTML injection through theme settings.

**2.4. Configuration Files (Container):**

* **Function:** Stores blog settings, theme configurations, and plugin configurations.
* **Security Implications:**
    * **Exposure of Sensitive Configuration (Low Risk in typical Octopress):**  While static sites generally minimize server-side secrets, configuration files might contain API keys for external services (e.g., analytics, commenting systems) or other sensitive settings. If these files are exposed (e.g., accidentally committed to a public repository or left with insecure permissions on the author's machine), it could lead to unauthorized access or misuse of these services.
    * **Configuration Tampering (Local Risk):** If an attacker gains access to the Blog Author's machine, they could modify configuration files to deface the blog or inject malicious content during the build process.

**2.5. Content Files (Container):**

* **Function:** Markdown files containing blog post content.
* **Security Implications:**
    * **Content Integrity:** Ensuring the integrity of content files is important. Version control with Git helps track changes and allows for rollback in case of accidental or malicious modifications.
    * **Malicious Content Injection by Author (Author Responsibility):** While less of a technical vulnerability in Octopress itself, Blog Authors could unintentionally or maliciously inject harmful content (e.g., XSS payloads) into their blog posts. This highlights the need for author awareness and potentially content review processes if multiple authors are involved.
    * **Draft Content Exposure (If not managed properly):** If draft content is not properly managed and accidentally published or exposed, it could lead to unintended information disclosure.

**2.6. Static Website Files (Container):**

* **Function:** Generated HTML, CSS, JavaScript, and asset files that constitute the final blog website.
* **Security Implications:**
    * **Generally Low Runtime Vulnerabilities (Architectural Advantage):** The static nature of the generated website significantly reduces runtime vulnerabilities compared to dynamic websites. There is no server-side code to exploit in the deployed static files themselves.
    * **Vulnerabilities Inherited from Generation Process:**  However, vulnerabilities can still be introduced during the generation process through vulnerable Jekyll, plugins, or themes. If the generated files contain malicious code due to these sources, the deployed website will be vulnerable.
    * **Information Disclosure (If misconfigured):**  If the hosting platform is misconfigured, sensitive files (e.g., `.git` directory, configuration backups) within the static website files directory could be unintentionally exposed.

**2.7. GitHub Repository (External System):**

* **Function:** Hosts source code, blog content, and configuration. Used for version control and potentially deployment.
* **Security Implications:**
    * **Repository Access Control:**  Proper access control to the GitHub repository is crucial. Unauthorized access could allow attackers to modify blog content, configuration, or even introduce malicious code into the build process.
    * **Secrets Management in Workflows:** If GitHub Actions workflows are used for deployment (as is common), secrets (API keys, deployment credentials) need to be managed securely. Misconfigured or exposed secrets in workflows can lead to unauthorized access to hosting platforms or other services.
    * **Workflow Security:**  Compromised GitHub Actions workflows can be used to inject malicious code into the build process or deface the deployed website.

**2.8. GitHub Actions Workflow (Build Process - within Deployment):**

* **Function:** Automates the build and deployment process.
* **Security Implications:**
    * **Workflow Permissions:** Overly permissive workflow permissions can increase the potential impact if a workflow is compromised. Workflows should ideally operate with the least privilege necessary.
    * **Dependency Vulnerabilities (Build Environment):** The build environment in GitHub Actions also relies on dependencies (Ruby, gems, Node.js if used for asset processing). Vulnerabilities in these dependencies could be exploited during the build process.
    * **Secrets Management (Workflow Secrets):** Securely managing secrets used in the workflow (e.g., for deployment) is critical.
    * **Supply Chain Attacks via Dependencies:**  If dependencies used in the build process (gems, npm packages) are compromised, it could lead to malicious code being injected into the generated website.

**2.9. GitHub Pages Hosting (External System):**

* **Function:** Hosts and serves the generated static blog website.
* **Security Implications:**
    * **Reliance on Hosting Provider Security (Accepted Risk):**  The security of the hosting infrastructure is managed by GitHub Pages. This is an accepted risk, meaning the blog owner relies on GitHub's security measures.
    * **HTTPS Configuration:** Ensuring HTTPS is properly configured for the GitHub Pages site is essential to protect user communication and prevent man-in-the-middle attacks.
    * **Misconfiguration Risks (Less likely on GitHub Pages):** While GitHub Pages simplifies hosting, misconfigurations (e.g., incorrect DNS settings, improper file permissions if custom configurations are allowed) could potentially introduce vulnerabilities.

### 3. Architecture, Components, and Data Flow Inference

Based on the diagrams and descriptions, the architecture and data flow of an Octopress blog deployment (specifically Option 1: GitHub Pages) can be summarized as follows:

1. **Content Creation (Blog Author's Machine):** Blog Author writes content in Markdown and configures the blog using Octopress CLI on their local machine.
2. **Version Control (GitHub Repository):** Blog content, configuration, themes, and plugins are stored and versioned in a GitHub Repository.
3. **Build Trigger (GitHub Repository):** Pushing changes to the GitHub Repository triggers a GitHub Actions workflow.
4. **Build Process (GitHub Actions):**
    * **Checkout Code:** GitHub Actions checks out the latest code from the repository.
    * **Install Dependencies:** Installs necessary dependencies (Jekyll, Ruby gems, etc.).
    * **Octopress Build:** Executes the Octopress build command, which utilizes Jekyll and the Theme Engine to process content and configuration files, generating static website files.
5. **Deployment (GitHub Actions & GitHub Pages):**
    * **Deploy to GitHub Pages:** The GitHub Actions workflow deploys the generated static website files to GitHub Pages Hosting.
6. **Content Delivery (GitHub Pages Hosting & Blog User):** GitHub Pages Hosting serves the static website files to Blog Users who access the blog through their web browsers.

**Data Flow:**

* **Blog Author -> Octopress CLI -> Content Files & Configuration Files -> Jekyll Engine & Theme Engine -> Static Website Files -> GitHub Repository -> GitHub Actions Workflow -> GitHub Pages Hosting -> Blog User.**

This data flow highlights the key components involved and the path that blog content takes from creation to publication. It emphasizes the reliance on external systems like GitHub Repository and GitHub Pages for hosting and deployment.

### 4. Tailored and Specific Security Recommendations for Octopress

Based on the identified security implications and the Octopress context, here are tailored and specific security recommendations:

**4.1. Dependency Management and Vulnerability Scanning:**

* **Recommendation:** **Implement Dependency Scanning in GitHub Actions Workflow.** Integrate a dependency scanning tool (e.g., `bundler-audit` for Ruby gems, `npm audit` if using Node.js for asset pipeline) into the GitHub Actions workflow. This should be configured to run on each push to the repository and fail the build if vulnerabilities are detected in Jekyll, Octopress dependencies, or any plugins/themes.
    * **Actionable Mitigation:** Add steps to the GitHub Actions workflow YAML file to perform dependency scanning. For example, for Ruby gems:
        ```yaml
        steps:
          - uses: actions/checkout@v3
          - name: Set up Ruby
            uses: ruby/setup-ruby@v1
            with:
              ruby-version: '3.x' # or your required Ruby version
              bundler-cache: true
          - name: Dependency Vulnerability Scan
            run: bundle audit --update
        ```
* **Recommendation:** **Regularly Update Jekyll and Octopress Dependencies.** Establish a process for regularly updating Jekyll, Octopress, and all Ruby gems/Node.js packages used in the build process. Consider using automated dependency update tools like Dependabot for GitHub repositories to streamline this process.
    * **Actionable Mitigation:** Enable Dependabot for the GitHub repository and configure it to automatically create pull requests for dependency updates. Review and merge these updates regularly.

**4.2. Theme and Plugin Security:**

* **Recommendation:** **Carefully Select and Vet Themes and Plugins.**  Choose themes and plugins from trusted sources (official Jekyll plugin directory, reputable developers). Prioritize themes and plugins that are actively maintained and have a good security track record. Avoid using abandoned or outdated themes and plugins.
    * **Actionable Mitigation:** Before using a new theme or plugin, research its source, check for recent updates, and look for any reported security vulnerabilities. Consider reviewing the theme/plugin code for potential security issues if possible.
* **Recommendation:** **Perform Static Analysis Security Testing (SAST) on Custom Themes/Plugins.** If custom themes or plugins are developed, integrate SAST tools into the development and build process to scan for potential vulnerabilities (e.g., XSS, code injection).
    * **Actionable Mitigation:** Explore SAST tools suitable for Ruby and JavaScript (if applicable in themes/plugins) and integrate them into the GitHub Actions workflow.

**4.3. Secure Deployment Practices:**

* **Recommendation:** **Enforce HTTPS.** Ensure that HTTPS is enabled for the GitHub Pages site (or any hosting platform used). GitHub Pages automatically provides HTTPS for custom domains.
    * **Actionable Mitigation:** Verify that the GitHub Pages site is accessible via HTTPS and that HTTP requests are redirected to HTTPS.
* **Recommendation:** **Minimize Exposed Files in the Deployed Website.**  Ensure that only necessary static files are deployed to the hosting platform. Avoid deploying sensitive files like `.git` directories, configuration backups, or development-related files. Octopress's build process should ideally only generate and deploy the `_site` directory (or equivalent output directory).
    * **Actionable Mitigation:** Review the GitHub Actions workflow and ensure that only the generated static website files (typically within `_site`) are deployed to GitHub Pages.
* **Recommendation:** **Implement Content Security Policy (CSP) if Dynamic Elements are Introduced.** If dynamic elements or user-generated content (e.g., comments via external services) are added to the blog, implement a Content Security Policy (CSP) to mitigate XSS risks.
    * **Actionable Mitigation:** Configure CSP headers in the web server configuration (if possible on the hosting platform) or via meta tags in the HTML to restrict the sources from which the browser is allowed to load resources.

**4.4. Blog Author Security Awareness:**

* **Recommendation:** **Educate Blog Authors on Secure Content Creation Practices.**  Provide guidelines to Blog Authors on how to create secure blog content, emphasizing the importance of avoiding embedding untrusted external content, being cautious with JavaScript in posts (if allowed by themes/plugins), and understanding basic web security principles.
    * **Actionable Mitigation:** Create a security awareness document for Blog Authors outlining best practices for content creation and potential security risks.

**4.5. GitHub Actions Workflow Security:**

* **Recommendation:** **Apply Least Privilege Principle to GitHub Actions Workflow Permissions.**  Review and restrict the permissions granted to the GitHub Actions workflow. Grant only the necessary permissions required for building and deploying the site. Avoid granting overly broad permissions like `write` access to the repository if not strictly needed.
    * **Actionable Mitigation:**  In the GitHub Actions workflow YAML file, explicitly define the necessary permissions using the `permissions` key and avoid using overly permissive settings.
* **Recommendation:** **Securely Manage Secrets in GitHub Actions.** If secrets are required in the GitHub Actions workflow (e.g., for deployment to platforms other than GitHub Pages), use GitHub Actions Secrets to store and manage them securely. Avoid hardcoding secrets in workflow files.
    * **Actionable Mitigation:** Utilize GitHub Actions Secrets to store sensitive information and access them in the workflow using the `${{ secrets.SECRET_NAME }}` syntax.

### 5. Actionable Mitigation Strategies Applicable to Identified Threats

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             