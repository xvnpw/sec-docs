## Key Attack Surface List (Direct `requests` Involvement, High & Critical)

| Description | How `requests` Contributes to the Attack Surface | Example | Impact | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Server-Side Request Forgery (SSRF)** | `requests` makes HTTP requests to URLs provided to it. If the application allows user-controlled input to define these URLs without proper validation, attackers can force the application to make requests to internal resources or arbitrary external servers. | An application takes a URL from user input to fetch an image. An attacker provides `http://localhost:6379/` to interact with an internal Redis server. | Access to internal services, data exfiltration, denial of service against internal infrastructure. | **Critical** | - **Strict Input Validation:** Validate and sanitize URLs provided by users. Use allowlists of allowed domains or protocols. - **URL Parsing:** Use `urllib.parse` to dissect the URL and validate its components. - **Network Segmentation:** Restrict network access of the application server to only necessary external resources. - **Avoid User-Controlled URLs:** Minimize or eliminate scenarios where users directly control the full URL passed to `requests`. |
| **HTTP Header Injection** | `requests` allows setting custom HTTP headers. If the application incorporates user-controlled input into these headers without proper sanitization, attackers can inject malicious headers. | An application allows users to set a custom `User-Agent` header. An attacker injects `X-Forwarded-For: <script>alert('XSS')</script>` which might be logged or processed unsafely by the target server. | Information disclosure, session hijacking, request smuggling, cross-site scripting (if the target server reflects the header). | **High** | - **Strict Input Validation:** Validate and sanitize all user-provided input before adding it to headers. Use allowlists of allowed characters and values. - **Avoid Dynamic Header Generation:** Minimize the use of user input directly in headers. If necessary, use predefined header values or carefully constructed, validated values. |
| **Man-in-the-Middle (MITM) Attacks due to Disabled Certificate Verification** | `requests` allows disabling TLS/SSL certificate verification (`verify=False`). If this is done, the application becomes vulnerable to MITM attacks where an attacker can intercept and modify communication. | A developer sets `verify=False` in the `requests.get()` call for convenience during development and forgets to remove it in production. An attacker on the network can intercept and modify the communication with the remote server. | Data interception, data manipulation, credential theft. | **Critical** | - **Always Verify Certificates:** Ensure `verify=True` (the default) is used in production. - **Use a Trusted Certificate Authority (CA) Bundle:** Rely on the default CA bundle or provide a custom, trusted bundle. - **Certificate Pinning (Advanced):** Pin specific certificates or public keys to prevent attacks using compromised CAs. |
