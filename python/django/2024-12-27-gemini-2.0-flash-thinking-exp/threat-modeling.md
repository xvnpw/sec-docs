
## High and Critical Django Threats

| Threat | Description | Impact | Affected Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **SQL Injection (Indirect via Raw SQL)** | An attacker crafts malicious SQL queries by manipulating user input that is directly incorporated into raw SQL queries (using `raw()` or `extra()`). This bypasses the ORM's intended protection. | Data breach (access to sensitive information), data manipulation (modifying or deleting data), potential for command execution on the database server. | `django.db.models.query` (when using `raw()` or `extra()`), potentially custom database functions. | High | Avoid using raw SQL queries whenever possible. If necessary, sanitize user input rigorously using database-specific escaping functions or parameterized queries. |
| **Cross-Site Scripting (XSS) via Disabled Auto-Escaping** | An attacker injects malicious scripts into templates by exploiting areas where auto-escaping has been explicitly disabled using the `safe` filter or `autoescape off` tags, and user-provided data is rendered without proper sanitization. | Account compromise, session hijacking, defacement, redirection to malicious sites, information theft. | `django.template.base` (template rendering engine) | High | Rely on Django's default auto-escaping. Carefully review the usage of the `safe` filter and `autoescape off` tags. Sanitize user-provided data before rendering it in templates where auto-escaping is disabled. |
| **Cross-Site Request Forgery (CSRF) Bypass** | An attacker crafts malicious requests that can be unknowingly executed by an authenticated user due to missing or improperly implemented CSRF protection. | Unauthorized actions performed on behalf of the victim user (e.g., changing passwords, making purchases, deleting data). | `django.middleware.csrf` (CsrfViewMiddleware), `django.template.backends.django` (template tag `{% csrf_token %}`) | High | Ensure `CsrfViewMiddleware` is enabled in `MIDDLEWARE`. Use the `{% csrf_token %}` template tag in all forms using the POST, PUT, PATCH, or DELETE methods. For AJAX requests, include the CSRF token in the request headers. |
| **Brute-Force Attacks on Admin Login** | An attacker attempts to guess the credentials for the Django admin interface. | Full control over the application and its data. | `django.contrib.admin.views.decorators` (`staff_member_required`), `django.contrib.auth.views` (login view) | Critical | Change default admin credentials immediately. Implement strong password policies for admin users. Enable two-factor authentication for admin logins. Implement rate limiting and account lockout mechanisms for the admin interface. Restrict access to the admin interface to trusted networks or IP addresses. |
| **Path Traversal via File Upload/Download** | An attacker manipulates file paths during upload or download operations to access files or directories outside the intended scope. | Access to sensitive files on the server, potential for remote code execution if executable files can be uploaded and accessed. | `django.core.files.upload`, `django.http.response.FileResponse`, custom file handling logic. | High | Validate and sanitize file paths rigorously. Store uploaded files outside the web server's document root. Avoid constructing file paths directly from user input. |
| **Arbitrary File Upload** | An attacker uploads malicious files (e.g., scripts, executables) to the server, which can then be executed or used to compromise the system. | Remote code execution, defacement, denial of service. | `django.core.files.upload`, custom file upload handling logic. | Critical | Implement strict file type validation based on content, not just extension. Sanitize uploaded files. Store uploaded files in a non-executable location. Limit file sizes. |
