## Deep Security Analysis of JAX Application

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to identify and evaluate potential security vulnerabilities and risks associated with the JAX system, as described in the provided security design review. The analysis will focus on understanding the architecture, components, and data flow of JAX to pinpoint specific security implications within its design and build process.  The ultimate goal is to provide actionable and tailored security recommendations to the JAX development team to enhance the security posture of this critical research tool.

**Scope:**

The scope of this analysis is limited to the JAX system as described in the provided "SECURITY DESIGN REVIEW" document, including:

*   **Components:** JAX Library (Python Packages), JIT Compiler (XLA), Dispatcher (Python), Backend Runtimes (CPU, GPU, TPU).
*   **Deployment Environments:** Researcher's Local Machine and Cloud Environment (as outlined in the Deployment section).
*   **Build Process:**  From code changes to package distribution (as outlined in the Build section).
*   **Security Controls:** Existing, accepted, and recommended security controls mentioned in the review.
*   **Business and Security Posture:** As defined in the review.

This analysis will *not* cover:

*   Security aspects of specific research datasets or user applications built using JAX.
*   Detailed code-level vulnerability analysis (SAST and DAST are recommended controls, but not performed in this analysis).
*   Operational security aspects of user deployments beyond the general deployment architectures described.
*   Security of external systems JAX interacts with beyond those explicitly mentioned (Data Storage, Compute Resources, Package Managers).

**Methodology:**

This analysis will employ a component-based security review methodology, focusing on the following steps:

1.  **Architecture and Data Flow Inference:** Based on the provided C4 diagrams and descriptions, infer the architecture, key components, and data flow within the JAX system.
2.  **Threat Identification:** For each key component, identify potential security threats and vulnerabilities relevant to its function and interactions within the JAX ecosystem. This will be informed by common software security vulnerabilities and the specific context of high-performance numerical computing and machine learning research.
3.  **Security Implication Analysis:** Analyze the potential impact of identified threats on the business priorities and goals of the JAX project, as well as the security posture outlined in the review.
4.  **Mitigation Strategy Development:**  Develop specific, actionable, and tailored mitigation strategies for each identified threat. These strategies will be practical and applicable to the JAX development process and architecture, considering the open-source nature and research focus of the project.
5.  **Recommendation Prioritization:**  Prioritize mitigation strategies based on their potential impact and feasibility of implementation, aligning with the business risks and security requirements outlined in the design review.

### 2. Security Implications of Key Components

Based on the Container Diagram and descriptions, the key components of JAX are:

*   **JAX Library (Python Packages)**
*   **JIT Compiler (XLA)**
*   **Dispatcher (Python)**
*   **Backend Runtimes (CPU, GPU, TPU)**

We will analyze the security implications of each component.

#### 2.1 JAX Library (Python Packages)

**Function and Data Flow:**

The JAX Library is the user-facing API of JAX, written in Python and distributed as Python packages. Researchers interact with this library to define numerical computations, apply automatic differentiation, and initiate JIT compilation. It receives user-provided Python code and data, and dispatches computation requests to the Dispatcher.

**Security Implications:**

*   **Threat 1: Malicious Input via API Exploitation (Input Validation Vulnerabilities)**
    *   **Description:**  Researchers might unknowingly or maliciously provide crafted inputs to JAX APIs that could exploit vulnerabilities in the library's code. This could lead to unexpected behavior, crashes, denial of service, or potentially even code execution if input validation is insufficient.  Specifically, vulnerabilities in handling array shapes, data types, or control flow within JAX functions could be exploited.
    *   **Likelihood:** Medium - High, given the complexity of numerical computation libraries and the potential for intricate API interactions.
    *   **Impact:** Medium - High, ranging from disruption of research to potential code execution depending on the vulnerability.
    *   **Specific JAX Context:**  JAX's API is designed for flexibility and expressiveness, which can sometimes come at the cost of increased complexity and potential input validation gaps.  The use of dynamic shapes and types in JAX could also introduce vulnerabilities if not handled carefully.

    *   **Mitigation Strategy 1.1: Robust API Input Validation and Sanitization:**
        *   **Action:** Implement comprehensive input validation at all JAX API boundaries. This includes:
            *   **Shape and Data Type Validation:**  Strictly validate array shapes and data types against expected values and constraints. Use type hints and runtime checks to enforce data type integrity.
            *   **Range Checks:**  Validate numerical inputs to ensure they fall within expected ranges, preventing overflow, underflow, or division by zero errors.
            *   **Control Flow Validation:**  If APIs accept user-provided functions or control flow structures, carefully validate these to prevent unexpected or malicious behavior.
        *   **Tool/Technique:**  Utilize Python's type hinting and validation libraries (e.g., `pydantic`, `cerberus`) to enforce input constraints. Integrate automated testing with fuzzing techniques to identify input validation vulnerabilities.
        *   **Tailored to JAX:** Focus validation on numerical and array-related inputs, considering JAX's core functionalities. Prioritize validation for APIs that directly interact with XLA or backend runtimes.

    *   **Mitigation Strategy 1.2: API Security Code Reviews:**
        *   **Action:** Conduct regular security-focused code reviews of the JAX Library codebase, specifically targeting API handling logic and input processing routines.
        *   **Process:**  Incorporate security experts or developers with security awareness into code review processes. Use checklists focusing on common input validation vulnerabilities (e.g., injection flaws, buffer overflows, format string bugs).
        *   **Tailored to JAX:** Focus reviews on areas of the API that are complex, handle external data, or interact with lower-level components like XLA.

*   **Threat 2: Supply Chain Vulnerabilities in Python Dependencies:**
    *   **Description:** JAX relies on various Python packages. Vulnerabilities in these dependencies could be exploited to compromise JAX or user environments. This is a general accepted risk, but needs specific mitigation.
    *   **Likelihood:** Medium - Vulnerabilities in dependencies are common.
    *   **Impact:** Medium - High, depending on the severity of the dependency vulnerability and its impact on JAX functionality.
    *   **Specific JAX Context:** JAX's dependency tree might be complex, increasing the attack surface.

    *   **Mitigation Strategy 2.1: Automated Dependency Vulnerability Scanning and SBOM:**
        *   **Action:** Implement automated dependency scanning in the CI/CD pipeline to detect known vulnerabilities in JAX's Python dependencies. Generate and maintain a Software Bill of Materials (SBOM) for all dependencies.
        *   **Tool/Technique:** Integrate tools like `pip-audit`, `safety`, or commercial dependency scanning solutions into GitHub Actions. Utilize SBOM generation tools to create a comprehensive dependency inventory.
        *   **Tailored to JAX:**  Focus scanning on both direct and transitive dependencies. Establish a process for promptly updating vulnerable dependencies and communicating updates to users.

    *   **Mitigation Strategy 2.2: Dependency Pinning and Review:**
        *   **Action:** Pin specific versions of dependencies in `requirements.txt` or `pyproject.toml` to ensure reproducible builds and control dependency updates. Regularly review and update dependencies, prioritizing security patches.
        *   **Process:**  Establish a process for reviewing dependency updates, considering security advisories and release notes. Test dependency updates thoroughly to ensure compatibility and prevent regressions.
        *   **Tailored to JAX:**  Balance the need for up-to-date dependencies with the stability required for research environments. Consider providing different dependency profiles (e.g., stable, latest) for different user needs.

#### 2.2 JIT Compiler (XLA)

**Function and Data Flow:**

The JIT Compiler (XLA) is responsible for compiling JAX computations into optimized machine code for various backends. It receives computation graphs from the Dispatcher and generates executable code.

**Security Implications:**

*   **Threat 3: Compiler Vulnerabilities and Malicious Compilation Input:**
    *   **Description:** XLA itself might contain vulnerabilities that could be exploited if malicious or specially crafted computation graphs are provided.  Furthermore, vulnerabilities in the compilation process could potentially lead to code injection or other security breaches.
    *   **Likelihood:** Low - Medium, XLA is a mature project, but compiler vulnerabilities are possible.
    *   **Impact:** Medium - High, potentially leading to code execution, privilege escalation, or denial of service on the backend runtime.
    *   **Specific JAX Context:** JAX relies heavily on XLA for performance. Security vulnerabilities in XLA would directly impact JAX's security posture. The complexity of compiler optimization and code generation increases the potential for subtle vulnerabilities.

    *   **Mitigation Strategy 3.1: Regular XLA Updates and Security Monitoring:**
        *   **Action:**  Stay up-to-date with the latest XLA releases and security patches. Monitor XLA security advisories and mailing lists for reported vulnerabilities.
        *   **Process:**  Establish a process for promptly updating the XLA version used by JAX when security updates are released. Test XLA updates thoroughly to ensure compatibility and prevent regressions.
        *   **Tailored to JAX:**  Given JAX's dependency on XLA, prioritize XLA security updates.  Communicate XLA update information to JAX users, especially if security implications are significant.

    *   **Mitigation Strategy 3.2: Secure Compilation Environment and Sandboxing (If Feasible):**
        *   **Action:** Ensure the compilation environment where XLA operates is securely configured and isolated. Explore the feasibility of sandboxing the compilation process to limit the impact of potential compiler vulnerabilities.
        *   **Technique:**  Utilize containerization or virtualization to isolate the compilation environment.  Investigate XLA's capabilities for sandboxing or process isolation during compilation.
        *   **Tailored to JAX:**  Sandboxing compilation might introduce performance overhead. Evaluate the trade-offs between security and performance. Focus on securing the build environment used to compile XLA itself.

*   **Threat 4: Information Disclosure through Compiled Code or Optimization Artifacts:**
    *   **Description:**  In certain scenarios, the compiled machine code or intermediate optimization artifacts generated by XLA might inadvertently leak sensitive information about the computation or the data being processed. This is less likely but worth considering in high-security contexts.
    *   **Likelihood:** Very Low - Low, but depends on the nature of optimizations and backend architecture.
    *   **Impact:** Low - Medium, potential information disclosure.
    *   **Specific JAX Context:**  JAX is used for research, which can sometimes involve sensitive data. While not a primary concern, data leakage through compiled code should be considered, especially if JAX is used in more sensitive environments.

    *   **Mitigation Strategy 4.1:  Code Review of XLA Optimization Passes (If Possible and Relevant):**
        *   **Action:**  If feasible and relevant to the JAX development team's expertise, conduct code reviews of XLA's optimization passes to identify potential information leakage vulnerabilities.
        *   **Process:**  This requires deep expertise in compiler design and security. Focus reviews on optimization passes that handle sensitive data or control flow.
        *   **Tailored to JAX:**  This is a more advanced mitigation and might be less practical for the JAX team to implement directly, as XLA is a separate project.  However, reporting potential issues upstream to the XLA team is valuable.

#### 2.3 Dispatcher (Python)

**Function and Data Flow:**

The Dispatcher is Python code within JAX that orchestrates the compilation and execution of computations. It receives requests from the JAX Library, interacts with the JIT Compiler (XLA), and manages data transfer to backend runtimes.

**Security Implications:**

*   **Threat 5: Dispatch Logic Flaws and Privilege Escalation:**
    *   **Description:** Vulnerabilities in the Dispatcher's logic could lead to incorrect routing of computations, unauthorized access to backend resources, or privilege escalation if the dispatcher is not properly secured.
    *   **Likelihood:** Low - Medium, depending on the complexity of the dispatching logic.
    *   **Impact:** Medium, potentially leading to unauthorized access or disruption of computations.
    *   **Specific JAX Context:** The Dispatcher acts as a central orchestrator within JAX. Security flaws here could have wide-ranging consequences.

    *   **Mitigation Strategy 5.1: Secure Dispatch Logic Review and Testing:**
        *   **Action:** Conduct thorough security code reviews of the Dispatcher component, focusing on access control, routing logic, and data handling. Implement comprehensive unit and integration tests to validate the correctness and security of dispatching operations.
        *   **Process:**  Use threat modeling techniques to identify potential attack vectors in the dispatching process. Focus testing on edge cases, error handling, and boundary conditions.
        *   **Tailored to JAX:**  Pay special attention to dispatching logic that handles different backends (CPU, GPU, TPU) and manages resource allocation.

*   **Threat 6: Denial of Service through Dispatcher Overload:**
    *   **Description:**  A malicious actor could potentially overload the Dispatcher with excessive computation requests, leading to denial of service and preventing legitimate users from running JAX computations.
    *   **Likelihood:** Low - Medium, depending on the dispatcher's resource management and rate limiting capabilities.
    *   **Impact:** Medium, disruption of research activities.
    *   **Specific JAX Context:**  In shared research environments or cloud deployments, denial of service attacks on JAX could impact multiple users.

    *   **Mitigation Strategy 6.1: Rate Limiting and Resource Management in Dispatcher:**
        *   **Action:** Implement rate limiting and resource management mechanisms in the Dispatcher to prevent overload and denial of service attacks.
        *   **Technique:**  Introduce mechanisms to limit the number of concurrent computation requests or the rate of incoming requests. Implement resource quotas and monitoring to prevent resource exhaustion.
        *   **Tailored to JAX:**  Consider the typical usage patterns of JAX in research environments when setting rate limits. Make rate limiting configurable if possible to accommodate different deployment scenarios.

#### 2.4 Backend Runtimes (CPU, GPU, TPU)

**Function and Data Flow:**

Backend Runtimes are the environments where compiled JAX code is executed on specific hardware (CPU, GPU, TPU). These are often provided by hardware vendors or specialized libraries.

**Security Implications:**

*   **Threat 7: Vulnerabilities in Backend Runtime Libraries and Drivers:**
    *   **Description:** Backend runtimes rely on libraries and drivers provided by hardware vendors or third parties. Vulnerabilities in these components could be exploited to compromise the execution environment or the underlying hardware.
    *   **Likelihood:** Medium - Vulnerabilities in drivers and runtime libraries are possible.
    *   **Impact:** Medium - High, potentially leading to code execution, privilege escalation, or hardware compromise.
    *   **Specific JAX Context:** JAX's performance relies on efficient backend runtimes. Security vulnerabilities in these runtimes would directly impact the security of JAX computations.

    *   **Mitigation Strategy 7.1:  Backend Runtime Security Updates and Monitoring:**
        *   **Action:**  Encourage users to keep their backend runtime libraries and drivers up-to-date with the latest security patches. Provide guidance on secure configuration of backend runtime environments. Monitor security advisories for relevant runtime libraries and drivers.
        *   **Process:**  Include information about backend runtime security in JAX documentation and security advisories.  Provide links to vendor security resources.
        *   **Tailored to JAX:**  Since JAX users manage their own runtime environments, focus on providing clear guidance and best practices for securing these environments.

*   **Threat 8: Access Control and Isolation in Multi-Tenant Backend Environments:**
    *   **Description:** In cloud or shared HPC environments, multiple users might share backend compute resources (GPUs, TPUs).  Insufficient access control and isolation between user computations could lead to data leakage or cross-tenant attacks.
    *   **Likelihood:** Low - Medium, depending on the deployment environment and the isolation mechanisms in place.
    *   **Impact:** Medium - High, potential data leakage or cross-tenant compromise.
    *   **Specific JAX Context:**  JAX is increasingly used in cloud environments. Security in multi-tenant backend environments is crucial for protecting user data and computations.

    *   **Mitigation Strategy 8.1:  Guidance on Secure Multi-Tenant Backend Deployment:**
        *   **Action:**  Provide guidance and best practices for deploying JAX in secure multi-tenant backend environments. This includes recommendations for access control, resource isolation, and secure configuration of compute resources.
        *   **Content:**  Document best practices for using containerization, virtualization, or hardware-level isolation to separate user computations.  Provide examples of secure cloud deployment configurations.
        *   **Tailored to JAX:**  Focus guidance on the specific security considerations for running JAX computations on shared GPUs and TPUs in cloud or HPC environments.

### 3. Actionable and Tailored Mitigation Strategies Summary

| Threat ID | Component          | Threat Description                                     | Mitigation Strategy                                                                 | Actionable Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         