
## High and Critical Streamlit-Specific Threats

| Threat | Description (Attacker Action & Method) | Impact | Affected Streamlit Component | Risk Severity | Mitigation Strategies (Developers/Users) |
|---|---|---|---|---|---|
| **Malicious Custom Component Installation** | An attacker creates a seemingly legitimate Streamlit component and hosts it on a public repository or tricks a user into installing it. Upon installation, the component executes malicious code, potentially exfiltrating data, compromising the server, or performing other harmful actions. | Data breach, server compromise, reputational damage, unauthorized access to resources. | `streamlit.components.v1` (when used to integrate the malicious component), potentially the entire application if the component has broad access. | **Critical** | **Developers:**  - Educate users on the risks of installing untrusted components. - Implement a process for vetting and recommending trusted components. - Use dependency management tools with security scanning. - Consider using isolated environments for testing components. **Users:** - Only install components from trusted and verified sources. - Review the component's code before installation if possible. - Be wary of components requesting excessive permissions. |
| **Injection via `st.experimental_set_query_params`** | An attacker crafts a malicious URL with manipulated query parameters and tricks a user into accessing it. If the application uses `st.experimental_set_query_params` to dynamically update the URL and doesn't properly sanitize or validate these parameters on the server-side, it could lead to unexpected behavior, information disclosure, or even server-side vulnerabilities. | Application logic bypass, potential for server-side vulnerabilities if parameters are used unsafely, information disclosure through manipulated URLs. | `streamlit.experimental_set_query_params`, any server-side code that processes query parameters. | **High** | **Developers:** - Thoroughly validate and sanitize all input received from query parameters before using it in application logic. - Avoid directly using query parameters in sensitive operations without proper checks. - Consider using a more robust routing mechanism if complex parameter handling is required. |
| **Code Injection via User-Provided Code Snippets (if implemented)** | If the application allows users to provide and execute arbitrary Python code snippets (e.g., through a text input and `exec()` or `eval()`), an attacker could inject malicious code that executes on the server with the privileges of the Streamlit application. | Complete server compromise, data breach, unauthorized access to resources. | Any part of the application that allows execution of user-provided code (strongly discouraged). | **Critical** | **Developers:** - **Strongly avoid** allowing users to execute arbitrary code on the server. If absolutely necessary, implement extremely strict sandboxing and security controls (which is very complex and generally not recommended for web applications). |
| **Component Vulnerabilities Leading to Server-Side Execution** | A vulnerability exists within a custom Streamlit component (either developed in-house or third-party). An attacker exploits this vulnerability, potentially through crafted input or interactions with the component, to execute arbitrary code on the server running the Streamlit application. | Server compromise, data breach, unauthorized access to resources. | Specific custom Streamlit components. | **High** | **Developers:** - Thoroughly audit and secure custom components. - Follow secure coding practices when developing components. - Keep component dependencies up-to-date. - Encourage users to report potential vulnerabilities in components. **Users:** - Be cautious about using components from untrusted sources. - Keep components updated to the latest versions. |
