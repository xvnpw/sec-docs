
## High and Critical Airflow Specific Threats

This table outlines high and critical threats that directly involve Apache Airflow components.

| Threat | Description (Attacker Action & How) | Impact | Affected Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Unauthorized Access to Airflow UI** | An attacker gains unauthorized access to the Airflow web UI, potentially by exploiting weak authentication, default credentials, or exposed network access. They might then view sensitive DAG information, trigger/pause DAGs, modify connections/variables, or even execute arbitrary code through DAG runs. |  Confidentiality breach (sensitive data exposure), Integrity compromise (DAG modification, data manipulation), Availability disruption (pausing critical DAGs), Potential for Remote Code Execution (RCE). | Airflow Webserver (UI, authentication modules) | Critical | * Implement strong authentication and authorization mechanisms (e.g., RBAC, LDAP/OIDC integration).<br> * Enforce HTTPS and proper TLS configuration.<br> * Restrict network access to the webserver through firewalls and network segmentation.<br> * Regularly update Airflow to patch known vulnerabilities.<br> * Disable or secure example DAGs.<br> * Implement Content Security Policy (CSP). |
| **Malicious DAG Injection/Modification** | An attacker with write access to the DAGs folder or through a vulnerability in Airflow's DAG management mechanisms injects or modifies a DAG file containing malicious code. The scheduler then parses this DAG, and the worker executes the malicious code. | Integrity compromise (arbitrary code execution on worker nodes), Potential for data breach or system compromise, Availability disruption. | Airflow Scheduler (DAG parsing), Airflow Workers (task execution), DAG Files | Critical | * Implement strict access control and authorization for DAG file management.<br> * Implement robust validation and sanitization of DAG files before processing.<br> * Consider using a Git-based DAG synchronization mechanism with code review processes.<br> * Employ static code analysis tools to scan DAG files for potential vulnerabilities. |
| **Code Injection through Task Definitions** | An attacker exploits insufficient input validation within DAG definitions, injecting malicious code or commands that are executed by the Airflow workers during task execution. This is especially relevant when using templating engines like Jinja. | Integrity compromise (arbitrary code execution on worker nodes), Potential for data breach or system compromise. | Airflow Workers (task execution), DAG Files (task definitions) | High | * Implement strict input validation and sanitization for any data used in task definitions.<br> * Avoid using user-provided data directly in shell commands or code execution contexts.<br> * Utilize parameterized queries or secure APIs when interacting with external systems.<br> * Implement security context and isolation for worker processes (e.g., using containers). |
| **Credential Theft from Connections/Variables** | An attacker gains unauthorized access to Airflow's connection management or variables, which often store sensitive credentials (database passwords, API keys). They can then use these credentials to compromise external systems. | Confidentiality breach (credential exposure), Potential for lateral movement and further compromise of connected systems. | Airflow Metadata Database (storing connections and variables), Airflow Webserver (UI for managing connections/variables) | High | * Utilize Airflow's built-in connection management and secrets backends (e.g., HashiCorp Vault, AWS Secrets Manager, GCP Secret Manager).<br> * Avoid storing credentials directly in DAG files or environment variables.<br> * Implement strong access control for managing connections and variables.<br> * Regularly rotate credentials. |
| **Secrets Backend Compromise** | If the chosen secrets backend (e.g., HashiCorp Vault) is compromised, attackers could gain access to all secrets managed by Airflow, including database credentials, API keys, etc. | Critical | Airflow Connections, Airflow Variables, Secrets Backend Integration | Critical | * Follow security best practices for the chosen secrets backend.<br> * Implement strong authentication and authorization for accessing the secrets backend.<br> * Regularly audit access to the secrets backend.<br> * Ensure proper network segmentation for the secrets backend. |
