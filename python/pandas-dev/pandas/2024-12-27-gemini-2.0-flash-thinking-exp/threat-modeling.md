
## High and Critical Pandas Threats

This table outlines high and critical threats that directly involve the Pandas library.

| Threat | Description (Attacker Action & Method) | Impact | Pandas Component Affected | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **`eval()`/`query()` Injection** | An attacker leverages user-controlled input that is directly passed to `pandas.eval()` or `DataFrame.query()` without proper sanitization. This allows the attacker to execute arbitrary Python code or manipulate data within the DataFrame. | Code execution, data manipulation, information disclosure, potential for privilege escalation depending on the application context. | `pandas.eval`, `DataFrame.query` | Critical | - **Avoid using `eval()` and `query()` with unsanitized user input.** <br> - If absolutely necessary, implement extremely strict whitelisting and sanitization of user input. <br> - Consider alternative methods for filtering and evaluating data that do not involve dynamic code execution. |
| **Exploiting Vulnerabilities in Dependencies (e.g., NumPy)** | Pandas relies on other libraries like NumPy. Vulnerabilities in these dependencies can indirectly affect Pandas' security. An attacker could exploit these vulnerabilities through Pandas' interaction with the affected library. | Code execution, denial of service, data corruption, depending on the vulnerability. | Various Pandas functions that rely on the vulnerable dependency (e.g., numerical operations using NumPy) | High | - **Keep Pandas and all its dependencies updated to the latest stable versions.** <br> - Monitor security advisories for Pandas and its dependencies. <br> - Consider using dependency scanning tools to identify vulnerable packages. |
| **Pickle Deserialization Vulnerabilities** | If the application uses Pandas' `to_pickle()` and `read_pickle()` functions to serialize and deserialize DataFrames from untrusted sources, an attacker could craft a malicious pickle file that executes arbitrary code upon deserialization. | Code execution, full system compromise. | `pandas.to_pickle`, `pandas.read_pickle` | Critical | - **Avoid using `read_pickle()` to load data from untrusted sources.** <br> - If necessary, implement strict controls and validation on the source of pickle files. <br> - Consider using safer serialization formats like JSON or CSV for data exchange with untrusted sources. |
| **File System Access through Insecure File Path Handling** | If the application allows users to specify file paths for reading or writing using Pandas functions (e.g., `pd.read_csv(user_provided_path)`), attackers could potentially access or modify arbitrary files on the server. | Unauthorized file access, data manipulation, potential system compromise. | `pandas.read_csv`, `pandas.to_csv`, other file I/O functions | High | - **Never directly use user-provided input as file paths for Pandas operations.** <br> - Implement strict whitelisting and validation of file paths. <br> - Use secure methods for handling file uploads and access. |
| **Exploiting Vulnerabilities in Data Source Connectors** | If Pandas is used to connect to external data sources (e.g., databases, APIs), vulnerabilities in the specific connector libraries used by Pandas could be exploited. | Data breaches, unauthorized access to external systems, code execution depending on the connector vulnerability. | Functions related to data input from external sources (e.g., `pandas.read_sql`, `pandas.read_gbq`) | High | - Keep the connector libraries updated. <br> - Follow security best practices for connecting to external data sources (e.g., using secure authentication, encrypted connections). |
