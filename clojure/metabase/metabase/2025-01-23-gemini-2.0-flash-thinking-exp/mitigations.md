# Mitigation Strategies Analysis for metabase/metabase

## Mitigation Strategy: [Principle of Least Privilege for Database Connections](./mitigation_strategies/principle_of_least_privilege_for_database_connections.md)

**Description:**
1.  **Identify Required Access for Metabase:** Determine the minimum database permissions Metabase needs to function for its intended purpose (e.g., `SELECT` for reporting, potentially limited `INSERT`, `UPDATE` for specific features if used).
2.  **Create Dedicated Metabase Database User:** Create a unique database user account *specifically* for Metabase to use for each database connection. Avoid using shared or overly privileged accounts.
3.  **Grant Minimal Permissions to Metabase User:**  Grant only the identified minimum permissions to the dedicated Metabase database user. Restrict access to specific databases, schemas, and tables as needed.
4.  **Configure Metabase Connection with Dedicated User:** Configure Metabase data source connections to use these newly created, least-privileged database user accounts.
5.  **Test and Verify Functionality:** Thoroughly test Metabase functionality after implementing these restricted connections to ensure all necessary features work as expected with the reduced privileges.
6.  **Regularly Review and Adjust Permissions:** Periodically review and adjust database user permissions used by Metabase to maintain the principle of least privilege as requirements evolve.
**List of Threats Mitigated:**
*   **Data Breach via Metabase Vulnerability (High Severity):** Limits the scope of a potential data breach if Metabase is compromised, as the attacker's database access is restricted.
*   **Accidental Data Modification/Deletion via Metabase (Medium Severity):** Reduces the risk of unintended data changes through Metabase, especially via native queries, if write permissions are minimized.
*   **Lateral Movement from Metabase to Database (Medium Severity):** Hinders an attacker's ability to use compromised Metabase credentials to gain broader access within the database system.
**Impact:**
*   **Data Breach via Metabase Vulnerability:** High Impact - Significantly reduces potential damage from a Metabase compromise.
*   **Accidental Data Modification/Deletion via Metabase:** Medium Impact - Lowers the risk of unintended data changes originating from Metabase actions.
*   **Lateral Movement from Metabase to Database:** Medium Impact - Restricts attacker movement within the database environment.
**Currently Implemented:** Partially implemented. Dedicated users are used, but permission granularity needs improvement.
**Missing Implementation:** Refine database user permissions to be schema and table-specific. Implement automated scripts to provision and manage these restricted users.

## Mitigation Strategy: [Data Masking and Redaction within Metabase](./mitigation_strategies/data_masking_and_redaction_within_metabase.md)

**Description:**
1.  **Identify Sensitive Fields in Metabase Data:** Within Metabase, identify data fields that contain sensitive information (PII, financial data, etc.) across all connected data sources.
2.  **Implement Metabase Data Masking Rules:** Utilize Metabase's built-in data masking features (if available in your Metabase edition) to define rules for masking or redacting sensitive data.
    *   **Field-level masking:** Apply masking to specific fields based on data type or content.
    *   **User/Group-based masking:** Apply different masking rules based on the Metabase user or group accessing the data.
3.  **Configure Masking Techniques:** Choose appropriate masking techniques within Metabase (e.g., partial masking, full masking, tokenization, hashing) based on data sensitivity and usability requirements.
4.  **Apply Masking to Dashboards and Questions:** Ensure masking rules are applied consistently across all Metabase dashboards, questions, and data explorations where sensitive data might be displayed.
5.  **Redact Sensitive Data in Metabase Logs:** Configure Metabase logging settings to redact sensitive data from log files and error messages generated by Metabase itself.
**List of Threats Mitigated:**
*   **Data Exposure to Unauthorized Metabase Users (Medium to High Severity):** Prevents unauthorized users within Metabase from viewing sensitive data they should not access.
*   **Data Leakage via Metabase Logs (Low to Medium Severity):** Reduces the risk of sensitive data being exposed in Metabase server logs.
**Impact:**
*   **Data Exposure to Unauthorized Metabase Users:** High Impact - Significantly reduces internal data exposure risks within Metabase.
*   **Data Leakage via Metabase Logs:** Medium Impact - Lowers the risk of data leaks through Metabase logging.
**Currently Implemented:** Partially implemented. Basic field-level permissions are used, but advanced masking within Metabase is not fully utilized.
**Missing Implementation:** Implement granular data masking rules for sensitive fields within Metabase. Configure log redaction. Evaluate upgrading Metabase edition for advanced masking features if needed.

## Mitigation Strategy: [Restrict Native Query Access in Metabase](./mitigation_strategies/restrict_native_query_access_in_metabase.md)

**Description:**
1.  **Identify Users Needing Native SQL:** Determine which Metabase users *truly* require the ability to write and execute native SQL queries (e.g., data engineers, advanced analysts).
2.  **Utilize Metabase Permissions to Restrict Native Query:**  Use Metabase's permission system to specifically restrict the "Native Query" permission to only the identified users and groups. Deny this permission for general business users.
3.  **Promote Query Builder and Saved Questions:** Encourage users without native query access to utilize Metabase's query builder, saved questions, and dashboards for their data exploration needs.
4.  **Implement Review Process for Native Queries (Optional):** For users with native query access, consider implementing a code review process for complex or sensitive native SQL queries before they are deployed or shared.
**List of Threats Mitigated:**
*   **SQL Injection Vulnerabilities via Metabase Native Queries (High Severity):** Reduces the attack surface for SQL injection by limiting native query access to a smaller, more controlled group.
*   **Accidental Database Damage via Native Queries (Medium Severity):** Lowers the risk of unintentional database issues caused by inexperienced users writing potentially harmful native SQL queries.
**Impact:**
*   **SQL Injection Vulnerabilities via Metabase Native Queries:** High Impact - Significantly reduces SQL injection risks originating from Metabase.
*   **Accidental Database Damage via Native Queries:** Medium Impact - Lowers the risk of database issues caused by user errors in native queries.
**Currently Implemented:** Partially implemented. Native query access is limited to specific groups, but could be further restricted.
**Missing Implementation:** Remove native query access from broader user groups. Implement a formal approval process for granting native query access.

## Mitigation Strategy: [Multi-Factor Authentication (MFA) for Metabase Users](./mitigation_strategies/multi-factor_authentication__mfa__for_metabase_users.md)

**Description:**
1.  **Enable MFA in Metabase Authentication Settings:** Configure MFA within Metabase's authentication settings. Choose a supported MFA method (TOTP recommended).
2.  **Enforce MFA for All Metabase Accounts:** Make MFA mandatory for *all* Metabase user accounts, especially administrators and users accessing sensitive data or features.
3.  **Provide User Onboarding for MFA:** Provide clear instructions and support to Metabase users on how to set up and use MFA with their accounts.
4.  **Regularly Verify MFA Enforcement:** Periodically check Metabase user accounts to ensure MFA is enabled and enforced as intended.
**List of Threats Mitigated:**
*   **Account Takeover of Metabase Users (High Severity):** Significantly reduces the risk of unauthorized access to Metabase accounts, even if passwords are compromised through phishing or breaches.
**Impact:**
*   **Account Takeover of Metabase Users:** High Impact - Dramatically reduces the risk of unauthorized Metabase account access.
**Currently Implemented:** Not implemented. MFA is not currently enabled in Metabase.
**Missing Implementation:** Enable MFA for all Metabase users. Select and configure a suitable MFA method (TOTP). Document MFA setup for users.

## Mitigation Strategy: [Integrate Metabase with Existing Identity Providers (SSO/LDAP/SAML)](./mitigation_strategies/integrate_metabase_with_existing_identity_providers__ssoldapsaml_.md)

**Description:**
1.  **Configure Metabase SSO Settings:** Configure Metabase to integrate with your organization's chosen identity provider (e.g., Active Directory, Okta, Azure AD) using SAML, LDAP, or OAuth 2.0 protocols within Metabase's authentication settings.
2.  **Test SSO Integration Thoroughly:**  Test the SSO integration from various user perspectives to ensure seamless and secure authentication to Metabase using organizational credentials.
3.  **Disable Local Metabase Authentication (Recommended):** After successful SSO implementation, disable local Metabase username/password authentication to enforce SSO as the primary and sole authentication method.
4.  **Leverage Identity Provider Security Features:** Utilize security features offered by your identity provider, such as centralized password policies, MFA enforcement (if configured at the IDP level), and account lifecycle management, to enhance Metabase security.
**List of Threats Mitigated:**
*   **Weak Password Security for Metabase Accounts (Medium Severity):** Replaces potentially weak, locally managed Metabase passwords with stronger, centrally managed organizational credentials.
*   **Inefficient Metabase User Management (Medium Severity):** Centralizes user management through the identity provider, simplifying user provisioning, deprovisioning, and access control for Metabase.
*   **Phishing Attacks Targeting Metabase Logins (Medium Severity):** Reduces susceptibility to phishing by directing users to a trusted identity provider login page instead of a potentially spoofed Metabase login.
**Impact:**
*   **Weak Password Security for Metabase Accounts:** Medium Impact - Improves password security for Metabase access.
*   **Inefficient Metabase User Management:** Medium Impact - Streamlines user administration for Metabase.
*   **Phishing Attacks Targeting Metabase Logins:** Medium Impact - Reduces phishing risks related to Metabase authentication.
**Currently Implemented:** Not implemented. Metabase currently uses local authentication.
**Missing Implementation:** Implement SSO integration with our organization's identity provider (Active Directory). Configure Metabase for SAML SSO. Disable local authentication after successful SSO setup.

## Mitigation Strategy: [Metabase-Specific Security Audits and Penetration Testing](./mitigation_strategies/metabase-specific_security_audits_and_penetration_testing.md)

**Description:**
1.  **Schedule Regular Metabase Security Assessments:** Plan for periodic security audits and penetration testing specifically focused on the Metabase application and its configuration.
2.  **Engage Security Experts with Metabase Knowledge:** Engage security professionals who have experience with web application security and ideally with Metabase or similar BI tools to conduct these assessments.
3.  **Focus Scope on Metabase Vulnerabilities:** Define the scope to specifically target potential vulnerabilities within Metabase itself, including SQL injection in native queries, API security, authentication mechanisms, and data access controls.
4.  **Remediate Metabase-Specific Findings:** Prioritize and remediate any vulnerabilities identified in Metabase during the security assessments, focusing on Metabase configuration and usage patterns.
**List of Threats Mitigated:**
*   **Unidentified Metabase Vulnerabilities (Variable Severity):** Proactively identifies and addresses security weaknesses specific to Metabase before they can be exploited.
**Impact:**
*   **Unidentified Metabase Vulnerabilities:** High Impact - Reduces the risk of exploitation of unknown Metabase-specific vulnerabilities.
**Currently Implemented:** Not implemented. General infrastructure audits are performed, but no dedicated Metabase security assessments.
**Missing Implementation:** Schedule a dedicated security audit and penetration test focused on Metabase. Establish a recurring schedule for these assessments.

## Mitigation Strategy: [Content Security Policy (CSP) for Metabase](./mitigation_strategies/content_security_policy__csp__for_metabase.md)

**Description:**
1.  **Define Metabase-Specific CSP Directives:** Create a Content Security Policy (CSP) tailored for Metabase, defining allowed sources for scripts, styles, images, and other resources that Metabase needs to load.
2.  **Configure CSP Headers in Web Server for Metabase:** Configure your web server (e.g., Nginx, Apache) that serves Metabase to send the `Content-Security-Policy` HTTP header with the defined CSP directives in responses for Metabase application requests.
3.  **Test Metabase CSP Implementation:** Thoroughly test Metabase functionality after implementing CSP to ensure it doesn't break features while effectively restricting unauthorized resource loading. Use browser developer tools to monitor CSP violations.
4.  **Refine and Monitor Metabase CSP:** Refine the CSP based on testing and consider setting up CSP reporting to monitor for violations and potential XSS attempts targeting Metabase.
**List of Threats Mitigated:**
*   **Cross-Site Scripting (XSS) Vulnerabilities in Metabase (High Severity):** Mitigates XSS attacks within Metabase by restricting the sources from which the browser can load resources, limiting the impact of potential XSS flaws.
**Impact:**
*   **Cross-Site Scripting (XSS) Vulnerabilities in Metabase:** High Impact - Significantly reduces XSS risks within the Metabase application.
**Currently Implemented:** Not implemented. CSP headers are not configured for Metabase.
**Missing Implementation:** Implement a CSP for Metabase. Configure the web server to send CSP headers for Metabase requests. Test CSP implementation thoroughly.

## Mitigation Strategy: [Secure Metabase API Access](./mitigation_strategies/secure_metabase_api_access.md)

**Description:**
1.  **Implement API Authentication for Metabase API:** Secure Metabase's API endpoints with appropriate authentication mechanisms.
    *   **API Keys/Tokens:** Use API keys or tokens for applications or services accessing the Metabase API.
    *   **Session-based Authentication:** For user-driven API access, leverage Metabase's session-based authentication.
2.  **Implement API Authorization Checks:** Ensure proper authorization checks are in place for API requests to verify that only authorized users or applications can access specific API endpoints and data.
3.  **Apply Rate Limiting to Metabase API Endpoints:** Implement rate limiting on Metabase API endpoints to prevent abuse, denial-of-service attacks, and brute-force attempts.
4.  **Validate API Input Data:** Validate and sanitize all input data received through Metabase API endpoints to prevent injection vulnerabilities and other input-related security issues.
5.  **Monitor Metabase API Access Logs:** Regularly monitor and review Metabase API access logs to detect any suspicious or unauthorized API usage patterns.
**List of Threats Mitigated:**
*   **Unauthorized Access to Metabase API (High Severity):** Prevents unauthorized users or applications from accessing and manipulating data or configurations through the Metabase API.
*   **API Abuse and Denial of Service (Medium Severity):** Rate limiting mitigates API abuse and DoS attempts targeting the Metabase API.
*   **Injection Vulnerabilities via Metabase API (Medium to High Severity):** Input validation reduces the risk of injection vulnerabilities through API endpoints.
**Impact:**
*   **Unauthorized Access to Metabase API:** High Impact - Prevents unauthorized API access and potential data breaches or system compromise.
*   **API Abuse and Denial of Service:** Medium Impact - Improves API availability and resilience against abuse.
*   **Injection Vulnerabilities via Metabase API:** Medium to High Impact - Reduces injection risks through the API.
**Currently Implemented:** Partially implemented. Basic API authentication is in place, but more granular authorization and rate limiting are missing.
**Missing Implementation:** Implement granular API authorization checks. Implement rate limiting for Metabase API endpoints. Enhance API input validation.

## Mitigation Strategy: [Keep Metabase Up-to-Date](./mitigation_strategies/keep_metabase_up-to-date.md)

**Description:**
1.  **Establish Metabase Update Schedule:** Create a regular schedule for checking for and applying Metabase updates (e.g., monthly or quarterly).
2.  **Subscribe to Metabase Security Advisories:** Subscribe to Metabase security mailing lists or channels to receive notifications about security updates and vulnerabilities.
3.  **Test Updates in Non-Production Environment:** Before applying updates to production Metabase instances, thoroughly test them in a non-production (staging or testing) environment to identify and resolve any compatibility issues or regressions.
4.  **Apply Updates Promptly:** Apply security updates and patches to production Metabase instances promptly after testing and verification to address known vulnerabilities.
5.  **Monitor Metabase Release Notes:** Regularly review Metabase release notes to stay informed about new features, bug fixes, and security enhancements in each release.
**List of Threats Mitigated:**
*   **Exploitation of Known Metabase Vulnerabilities (High Severity):**  Patching known vulnerabilities prevents attackers from exploiting them to compromise Metabase.
**Impact:**
*   **Exploitation of Known Metabase Vulnerabilities:** High Impact - Directly addresses and eliminates known security weaknesses in Metabase.
**Currently Implemented:** Partially implemented. Updates are applied, but not on a strictly regular schedule and testing could be more rigorous.
**Missing Implementation:** Formalize a regular Metabase update schedule. Implement a more robust testing process for updates before production deployment.

## Mitigation Strategy: [Role-Based Access Control (RBAC) within Metabase](./mitigation_strategies/role-based_access_control__rbac__within_metabase.md)

**Description:**
1.  **Define Metabase Roles and Permissions:** Define clear roles within Metabase (e.g., Admin, Analyst, Viewer) and assign granular permissions to each role based on the principle of least privilege. Permissions should control access to data sources, dashboards, questions, features (like native query), and administrative functions.
2.  **Assign Users to Appropriate Metabase Roles:** Assign Metabase users to the roles that best match their responsibilities and data access needs.
3.  **Regularly Review and Update Roles and Permissions:** Periodically review and update Metabase roles and permissions to ensure they remain aligned with user responsibilities and organizational security policies as they evolve.
4.  **Audit User Role Assignments:** Regularly audit user role assignments in Metabase to verify that users have the correct level of access and that no users have excessive or inappropriate permissions.
**List of Threats Mitigated:**
*   **Unauthorized Data Access within Metabase (Medium to High Severity):** Prevents users from accessing data, dashboards, or features within Metabase that they are not authorized to use.
*   **Privilege Escalation within Metabase (Medium Severity):** Limits the potential for users to gain elevated privileges or access administrative functions they should not have.
**Impact:**
*   **Unauthorized Data Access within Metabase:** High Impact - Significantly reduces internal unauthorized data viewing and manipulation risks.
*   **Privilege Escalation within Metabase:** Medium Impact - Lowers the risk of users gaining inappropriate administrative access.
**Currently Implemented:** Partially implemented. RBAC is used, but roles and permissions could be more granular and regularly reviewed.
**Missing Implementation:** Refine Metabase roles and permissions to be more granular and aligned with least privilege. Implement a process for regular review and update of roles and user assignments.

## Mitigation Strategy: [Row-Level Permissions and Data Sandboxing in Metabase](./mitigation_strategies/row-level_permissions_and_data_sandboxing_in_metabase.md)

**Description:**
1.  **Implement Row-Level Permissions in Metabase:** Utilize Metabase's row-level permissions features (if available in your edition) to control data access at the row level based on user attributes or roles. This ensures users only see data relevant to their responsibilities within datasets.
2.  **Configure Data Sandboxes (Optional):** Consider creating separate, sandboxed Metabase environments for development, testing, or specific user groups. Use anonymized or synthetic data in sandboxes to prevent accidental exposure of production data.
3.  **Test and Validate Row-Level Permissions:** Thoroughly test and validate row-level permission rules to ensure they function correctly and effectively restrict data access as intended.
4.  **Regularly Review Row-Level Permission Rules:** Periodically review and update row-level permission rules to maintain their effectiveness and alignment with data access requirements.
**List of Threats Mitigated:**
*   **Unauthorized Access to Specific Data Rows within Metabase (Medium to High Severity):** Prevents users from viewing data rows within datasets that they are not authorized to access, even if they have general access to the dataset.
*   **Accidental Data Exposure in Development/Testing (Medium Severity):** Data sandboxing reduces the risk of accidentally exposing production data in non-production Metabase environments.
**Impact:**
*   **Unauthorized Access to Specific Data Rows within Metabase:** High Impact - Significantly enhances data access control and prevents granular data exposure within Metabase.
*   **Accidental Data Exposure in Development/Testing:** Medium Impact - Lowers the risk of data leaks in non-production environments.
**Currently Implemented:** Not implemented. Row-level permissions and data sandboxing are not currently utilized.
**Missing Implementation:** Explore and implement row-level permissions for sensitive datasets in Metabase. Consider setting up data sandboxes for development and testing.

## Mitigation Strategy: [Regularly Audit Metabase Data Access Logs](./mitigation_strategies/regularly_audit_metabase_data_access_logs.md)

**Description:**
1.  **Enable Metabase Audit Logging:** Ensure that Metabase's audit logging feature is enabled to capture data access events, user actions, and other relevant security-related activities within Metabase.
2.  **Configure Log Retention and Storage:** Configure appropriate log retention policies and secure storage for Metabase audit logs to ensure logs are available for analysis and investigation when needed.
3.  **Regularly Review and Analyze Metabase Audit Logs:** Establish a process for regularly reviewing and analyzing Metabase audit logs. This can be done manually or by integrating logs with a SIEM system.
4.  **Set Up Alerts for Suspicious Activity:** Configure alerts based on Metabase audit log events to detect and respond to suspicious or unauthorized data access patterns or user activities in near real-time.
**List of Threats Mitigated:**
*   **Unauthorized Data Exploration and Access (Medium Severity):** Audit logs provide visibility into data access patterns and help detect unauthorized data exploration or access attempts within Metabase.
*   **Insider Threats (Medium Severity):** Audit logs can help identify and investigate potential insider threats or malicious activities by authorized users within Metabase.
*   **Data Breach Detection and Response (Medium Severity):** Audit logs are crucial for investigating data breaches or security incidents involving Metabase and understanding the scope and impact of the incident.
**Impact:**
*   **Unauthorized Data Exploration and Access:** Medium Impact - Improves detection of unauthorized data access within Metabase.
*   **Insider Threats:** Medium Impact - Enhances visibility into user activities and helps detect potential insider threats.
*   **Data Breach Detection and Response:** Medium Impact - Provides valuable information for incident investigation and response.
**Currently Implemented:** Partially implemented. Audit logging is enabled, but regular log review and alerting are not fully established.
**Missing Implementation:** Implement a process for regular review and analysis of Metabase audit logs. Set up alerts for suspicious activities based on log events. Integrate Metabase logs with a SIEM system for centralized monitoring.

## Mitigation Strategy: [Review and Audit Native Queries in Metabase](./mitigation_strategies/review_and_audit_native_queries_in_metabase.md)

**Description:**
1.  **Implement Native Query Review Process:** Establish a process for reviewing and auditing native SQL queries written within Metabase, especially those created by less experienced users or those accessing sensitive data.
2.  **Utilize Code Review Practices:** Apply code review practices to native SQL queries to identify potential SQL injection vulnerabilities, performance issues, or logic errors before they are deployed or shared.
3.  **Automated Query Analysis Tools (Optional):** Explore and utilize automated SQL query analysis tools that can help identify potential security vulnerabilities or performance issues in native queries.
4.  **Educate Users on Secure SQL Practices:** Provide training and guidance to Metabase users who write native SQL queries on secure SQL coding practices and common SQL injection vulnerabilities.
**List of Threats Mitigated:**
*   **SQL Injection Vulnerabilities in Native Queries (High Severity):** Reduces the risk of introducing SQL injection vulnerabilities through poorly written or malicious native SQL queries in Metabase.
*   **Performance Issues from Inefficient Queries (Medium Severity):** Code review can help identify and optimize inefficient native queries that could impact database performance.
**Impact:**
*   **SQL Injection Vulnerabilities in Native Queries:** High Impact - Reduces SQL injection risks from native queries.
*   **Performance Issues from Inefficient Queries:** Medium Impact - Improves database performance and resource utilization.
**Currently Implemented:** Not implemented. No formal review process for native queries is in place.
**Missing Implementation:** Implement a mandatory review process for native SQL queries, especially those accessing sensitive data or created by less experienced users. Provide training on secure SQL coding.

## Mitigation Strategy: [Parameterized Queries in Metabase Query Builder](./mitigation_strategies/parameterized_queries_in_metabase_query_builder.md)

**Description:**
1.  **Promote Use of Query Builder Features:** Encourage Metabase users to primarily use the query builder interface and its features (filters, variables, custom expressions) instead of native SQL queries whenever possible.
2.  **Utilize Parameterized Queries in Query Builder:** When using the query builder, leverage parameterized queries (variables and filters) to separate SQL code from user-supplied data. Metabase query builder generally uses parameterized queries under the hood.
3.  **Educate Users on Parameterization Benefits:** Educate users about the security benefits of parameterized queries in preventing SQL injection and encourage their use within the query builder.
**List of Threats Mitigated:**
*   **SQL Injection Vulnerabilities via Query Builder (Low Severity):** While Metabase query builder is generally safer, promoting parameterized queries further minimizes potential SQL injection risks even within the builder.
**Impact:**
*   **SQL Injection Vulnerabilities via Query Builder:** Low Impact - Provides an additional layer of defense against SQL injection, even though the query builder is already designed to mitigate this risk.
**Currently Implemented:** Implicitly implemented as Metabase query builder encourages parameterized queries. User education is missing.
**Missing Implementation:**  Explicitly educate users on the security benefits of using parameterized queries within the Metabase query builder and how to effectively use variables and filters.

## Mitigation Strategy: [Input Validation and Sanitization in Metabase Expressions and Filters](./mitigation_strategies/input_validation_and_sanitization_in_metabase_expressions_and_filters.md)

**Description:**
1.  **Validate User Inputs in Custom Expressions:** When using custom expressions or formulas within Metabase (e.g., in calculated fields or filters), be mindful of user-provided inputs. Implement input validation where feasible within Metabase's expression language to check for unexpected or malicious input patterns.
2.  **Sanitize User Inputs in Filters (Where Possible):**  While Metabase handles filters to a degree, be aware of potential injection risks if filters are constructed dynamically based on user input. Sanitize or validate user-provided filter values where possible within Metabase's filter mechanisms.
3.  **Limit Use of Dynamic or Unvalidated Inputs:** Minimize the use of dynamic or unvalidated user inputs directly within Metabase expressions or filters, especially when dealing with sensitive operations or data manipulation.
**List of Threats Mitigated:**
*   **Expression Injection Vulnerabilities (Medium Severity):** Prevents potential injection vulnerabilities that could arise from malicious user inputs within Metabase's expression language.
*   **Filter Bypass or Manipulation (Medium Severity):** Reduces the risk of attackers manipulating filters to bypass security controls or access unauthorized data.
**Impact:**
*   **Expression Injection Vulnerabilities:** Medium Impact - Lowers the risk of injection vulnerabilities within Metabase expressions.
*   **Filter Bypass or Manipulation:** Medium Impact - Reduces the risk of filter-based attacks.
**Currently Implemented:** Partially implemented. Metabase provides some level of input handling, but explicit validation and sanitization are not consistently applied in custom expressions and filters.
**Missing Implementation:**  Develop guidelines for secure coding practices within Metabase expressions and filters, emphasizing input validation and sanitization. Provide training to users on these practices.

