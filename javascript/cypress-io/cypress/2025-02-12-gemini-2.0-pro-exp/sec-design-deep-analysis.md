Okay, let's perform a deep security analysis of Cypress based on the provided design review.

**1. Objective, Scope, and Methodology**

*   **Objective:** To conduct a thorough security analysis of the Cypress testing framework and its associated Cypress Cloud service, identifying potential vulnerabilities and weaknesses in its key components.  This analysis aims to uncover architectural, design, and implementation-level security risks that could be exploited by malicious actors.  The focus is on preventing code execution, data breaches, and compromise of the testing environment.

*   **Scope:**
    *   **Cypress Test Runner:**  The core open-source testing framework, including the desktop application, test runner process, browser interaction mechanisms, and reporting functionality.
    *   **Cypress Cloud:** The optional cloud service, including its API, data storage (database and object storage), and user authentication/authorization mechanisms.
    *   **CI/CD Integration (GitHub Actions):** The security of the build and deployment pipeline, focusing on dependency management and secret handling.
    *   **Exclusions:** The security of the *applications being tested* is explicitly out of scope, as Cypress is a testing tool, not a security assessment tool for the target application.  We are concerned with the security *of Cypress itself*.

*   **Methodology:**
    1.  **Architecture Review:** Analyze the provided C4 diagrams (Context, Container, Deployment, Build) and element descriptions to understand the system's architecture, data flow, and trust boundaries.
    2.  **Component Analysis:** Break down each key component and identify potential security implications based on its function and interactions.
    3.  **Threat Modeling:**  Consider relevant threat actors (script kiddies, opportunistic attackers, and potentially more sophisticated actors targeting Cypress Cloud) and potential attack vectors.  We'll use the business risks identified in the design review as a starting point.
    4.  **Vulnerability Identification:**  Identify potential vulnerabilities based on common web application security risks (OWASP Top 10), specific risks associated with testing frameworks, and the identified threat model.
    5.  **Mitigation Recommendations:** Provide actionable and specific mitigation strategies for each identified vulnerability, tailored to the Cypress architecture and development practices.

**2. Security Implications of Key Components**

Let's analyze each component from a security perspective, building upon the design review:

**2.1 Cypress Test Runner**

*   **Desktop Application (Electron):**
    *   **Threats:**
        *   **Code Injection:**  If an attacker can modify the application's code (e.g., through a compromised dependency or a supply chain attack), they could execute arbitrary code on the user's machine.
        *   **Insecure Defaults:**  Misconfigured Electron settings could expose the application to vulnerabilities.
        *   **Unsigned/Tampered Builds:**  Users might download a malicious version of Cypress from an unofficial source.
    *   **Mitigations:**
        *   **Code Signing:**  Digitally sign all Cypress releases to ensure authenticity and integrity.  Verify the signature before installation.
        *   **Secure Electron Configuration:**  Follow Electron security best practices (e.g., disable Node.js integration in renderers where not absolutely necessary, use `contextBridge` for safe inter-process communication, enable `sandbox: true`).
        *   **Dependency Management:**  Use a lockfile (`package-lock.json` or `yarn.lock`) and regularly audit dependencies for known vulnerabilities (e.g., using `npm audit` or a dedicated vulnerability scanning tool).  Consider using tools like `socket.dev` to analyze dependency risks.
        *   **SBOM:** Maintain a Software Bill of Materials (SBOM) to track all dependencies and their versions.
        *   **Harden Electron:** Use a hardened version of Electron, if available, or apply security patches promptly.

*   **Test Runner Process:**
    *   **Threats:**
        *   **Test Code Execution (Arbitrary Code Execution):**  The biggest risk.  Cypress executes JavaScript code within the context of the browser.  If a test contains malicious code (either intentionally or through a compromised test), it could potentially escape the browser sandbox and execute code on the host machine.
        *   **Cross-Origin Leaks:**  Tests might inadvertently leak sensitive information from one origin to another.
        *   **Network Manipulation:**  Tests could be manipulated to make malicious network requests.
    *   **Mitigations:**
        *   **Strict Input Validation:**  While Cypress itself doesn't directly take user input in the traditional sense, it *does* execute user-provided test code.  This is the "input" to be validated.  Mitigation here focuses on *limiting the capabilities* of the test code.
        *   **Browser Context Isolation:**  Ensure that each test runs in a completely isolated browser context.  Leverage browser features like `<iframe>` sandboxing and process isolation to the fullest extent possible.  Clear cookies, local storage, and other persistent data between tests.
        *   **Network Monitoring/Filtering:**  Consider implementing a mechanism to monitor and potentially filter network requests made by tests.  This could help prevent malicious requests or data exfiltration.  This is a complex area, as Cypress needs to interact with the network to test web applications.  A configurable allowlist/denylist of domains might be a starting point.
        *   **Command Whitelisting:**  Cypress provides a set of commands (e.g., `cy.visit`, `cy.get`, `cy.request`).  Internally, ensure that these commands are the *only* way to interact with the browser and the system.  Prevent direct access to underlying Node.js APIs or browser APIs from within the test code, except where explicitly allowed and carefully controlled.
        *   **Resource Limits:**  Consider imposing resource limits (CPU, memory, network) on the test runner process to prevent denial-of-service attacks.

*   **Browser (Controlled by Cypress):**
    *   **Threats:**
        *   **Browser Exploits:**  Vulnerabilities in the underlying browser engine (Chromium, Gecko) could be exploited.
        *   **Extension Abuse:**  If Cypress allows browser extensions, a malicious extension could compromise the testing environment.
    *   **Mitigations:**
        *   **Regular Browser Updates:**  Keep the bundled browser (Electron or other) up-to-date with the latest security patches.  This is *critical*.
        *   **Disable Unnecessary Features:**  Disable browser features that are not required for testing (e.g., WebGL, WebRTC) if they pose a security risk.
        *   **Extension Control:**  *Strongly* restrict or completely disable the use of browser extensions within the Cypress testing environment.  If extensions are absolutely necessary, implement a strict allowlist and vet each extension thoroughly.
        *   **Leverage Browser Security Features:**  Utilize built-in browser security features like Content Security Policy (CSP), Subresource Integrity (SRI), and HTTP Strict Transport Security (HSTS) where applicable, even within the testing environment.

*   **Reporter:**
    *   **Threats:**
        *   **Data Leakage:**  Test results might contain sensitive information (e.g., credentials, API keys) that could be exposed if the reporter is not handled securely.
        *   **Injection Attacks:**  If the reporter uses user-provided data (e.g., test names, error messages) without proper sanitization, it could be vulnerable to injection attacks.
    *   **Mitigations:**
        *   **Secure Data Handling:**  Avoid logging or storing sensitive data in test results.  If sensitive data must be included, redact or encrypt it.
        *   **Input Sanitization:**  Sanitize all user-provided data before using it in reports.  Use output encoding to prevent XSS vulnerabilities.
        *   **Secure Transmission:**  If reporting to Cypress Cloud, use HTTPS with strong TLS configuration.

**2.2 Cypress Cloud**

*   **Cypress Cloud API:**
    *   **Threats:**
        *   **Authentication Bypass:**  Attackers could bypass authentication mechanisms to access the API.
        *   **Authorization Flaws:**  Users might be able to access data or perform actions they are not authorized to.
        *   **Injection Attacks:**  SQL injection, NoSQL injection, command injection, etc.
        *   **Denial of Service (DoS):**  Attackers could flood the API with requests, making it unavailable.
        *   **Data Breaches:**  Attackers could exploit vulnerabilities to gain access to sensitive data stored in the cloud.
    *   **Mitigations:**
        *   **Strong Authentication:**  Implement robust authentication mechanisms, including multi-factor authentication (MFA) and strong password policies.  Use industry-standard authentication protocols (e.g., OAuth 2.0, OpenID Connect).
        *   **Role-Based Access Control (RBAC):**  Implement RBAC to restrict user access to only the resources and actions they need.  Follow the principle of least privilege.
        *   **Input Validation and Sanitization:**  Validate and sanitize *all* input received by the API, on *every* endpoint.  Use a whitelist approach where possible.  Use parameterized queries or ORM to prevent SQL injection.
        *   **Rate Limiting:**  Implement rate limiting to prevent DoS attacks.
        *   **TLS Encryption:**  Use HTTPS with a strong TLS configuration for all communication with the API.
        *   **Regular Security Audits and Penetration Testing:**  Conduct regular security audits and penetration tests to identify and address vulnerabilities.
        *   **Web Application Firewall (WAF):**  Deploy a WAF to protect against common web attacks.

*   **Cloud Storage (e.g., S3, GCS):**
    *   **Threats:**
        *   **Unauthorized Access:**  Attackers could gain access to test artifacts (screenshots, videos) due to misconfigured access controls.
        *   **Data Leakage:**  Sensitive data stored in artifacts could be exposed.
    *   **Mitigations:**
        *   **Strict Access Control Lists (ACLs):**  Use the principle of least privilege to restrict access to storage buckets.  Ensure that only authorized users and services can access the data.
        *   **Encryption at Rest:**  Enable server-side encryption to protect data stored in the cloud.
        *   **Object Versioning:**  Enable object versioning to protect against accidental deletion or modification of data.
        *   **Regular Audits:**  Regularly audit access logs and configurations to identify any unauthorized access attempts.

*   **Cloud Database (e.g., PostgreSQL, MongoDB):**
    *   **Threats:**
        *   **SQL Injection/NoSQL Injection:**  Attackers could inject malicious code into database queries.
        *   **Unauthorized Access:**  Attackers could gain access to the database due to weak credentials or misconfigured access controls.
        *   **Data Breaches:**  Attackers could exploit vulnerabilities to steal sensitive data.
    *   **Mitigations:**
        *   **Parameterized Queries/ORM:**  Use parameterized queries or an Object-Relational Mapper (ORM) to prevent SQL injection.  Avoid constructing queries by concatenating strings.
        *   **Strong Authentication and Authorization:**  Use strong passwords and enforce the principle of least privilege for database users.
        *   **Encryption at Rest:**  Encrypt the database to protect data at rest.
        *   **Regular Backups:**  Implement regular backups and ensure that backups are stored securely.
        *   **Database Security Best Practices:**  Follow database-specific security best practices (e.g., disabling unnecessary features, applying security patches).
        *   **Network Segmentation:** Isolate the database from the public internet using network segmentation.

**2.3 CI/CD Integration (GitHub Actions)**

*   **Threats:**
    *   **Compromised Dependencies:**  A malicious dependency could be introduced into the build process.
    *   **Secret Leakage:**  API keys, credentials, or other secrets stored in the CI environment could be exposed.
    *   **Malicious Workflow Modifications:**  An attacker could modify the workflow configuration to execute malicious code.
    *   **Runner Compromise:** The CI runner itself could be compromised.
    *   **Supply Chain Attacks on GitHub Actions:** A vulnerability in a third-party GitHub Action could be exploited.
    *   **Insecure use of `cypress run --record --key`:** If the record key is exposed, an attacker could potentially upload fake test results.
    *   **Insecure use of environment variables:** If environment variables containing secrets are not properly managed, they could be exposed.

*   **Mitigations:**
    *   **Dependency Management:**  Use a lockfile and regularly audit dependencies for vulnerabilities.  Pin dependencies to specific versions. Use tools to analyze dependency risks.
    *   **Secret Management:**  Use GitHub Actions secrets to store sensitive information.  *Never* hardcode secrets in the workflow configuration or source code.  Rotate secrets regularly.
    *   **Workflow Security:**  Review and audit workflow configurations regularly.  Use branch protection rules to prevent unauthorized modifications to workflows.
    *   **Runner Security:**  Use self-hosted runners only if necessary and ensure they are properly secured.  Keep the runner software up-to-date.
    *   **Third-Party Action Auditing:**  Carefully vet any third-party GitHub Actions used in the workflow.  Use specific commit SHAs instead of tags to avoid unexpected updates.
    *   **Secure Record Key Handling:**  Treat the Cypress record key as a highly sensitive secret.  Store it securely using GitHub Actions secrets.  Monitor for any suspicious activity related to the record key.
    *   **Environment Variable Best Practices:**  Use environment variables for configuration, but avoid storing secrets directly in environment variables if possible.  Use a dedicated secret management solution.

**3. Actionable Mitigation Strategies (Summary & Prioritization)**

The following table summarizes the key vulnerabilities and mitigation strategies, prioritized by severity:

| Vulnerability Category          | Specific Vulnerability                                                                                                                               | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              