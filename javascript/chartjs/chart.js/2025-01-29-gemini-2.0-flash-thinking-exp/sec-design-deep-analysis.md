## Deep Security Analysis of Chart.js Library

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to comprehensively evaluate the security posture of the Chart.js JavaScript charting library. The primary objective is to identify potential security vulnerabilities and risks associated with the library's architecture, components, development lifecycle, and deployment methods.  The analysis will focus on understanding the security implications for web applications that integrate Chart.js, ensuring the library is robust against common web security threats, and providing actionable recommendations to enhance its security posture.  Specifically, we will delve into the client-side security risks inherent in a JavaScript library, supply chain security considerations related to its distribution, and the security of its development and build processes.

**Scope:**

The scope of this analysis encompasses the following aspects of Chart.js:

* **Chart.js Library Codebase:** Analysis of the source code to identify potential vulnerabilities such as Cross-Site Scripting (XSS), injection flaws, and logic errors.
* **Dependencies:** Examination of third-party dependencies used by Chart.js to identify known vulnerabilities and assess supply chain risks.
* **Build and Release Process:** Review of the automated build pipeline (GitHub Actions CI) to identify potential security weaknesses in the software supply chain.
* **Deployment Methods:** Analysis of common deployment options (CDN, npm, self-hosting) and their associated security implications.
* **Security Controls:** Evaluation of existing and recommended security controls outlined in the security design review.
* **Documentation and Developer Guidance:** Assessment of security-related documentation and guidance provided to developers using Chart.js.

The analysis will primarily focus on the security of the Chart.js library itself and its immediate ecosystem. It will not extend to the security of specific web applications that utilize Chart.js, but will consider how vulnerabilities in Chart.js could impact these applications.

**Methodology:**

This deep security analysis will employ the following methodology:

1. **Document Review:**  Thorough review of the provided security design review document, including business and security posture, C4 diagrams, deployment options, build process, risk assessment, questions, and assumptions.
2. **Architecture and Data Flow Inference:** Based on the provided documentation and understanding of JavaScript charting libraries, infer the architecture, key components, and data flow within Chart.js. This will involve considering how data is processed, rendered, and how user inputs are handled.
3. **Threat Modeling:** Identify potential security threats relevant to Chart.js, considering the OWASP Top Ten for web applications and supply chain security risks. This will be tailored to the specific context of a client-side JavaScript library.
4. **Security Implication Analysis:** Analyze the security implications of each key component and process identified in the architecture and data flow inference, focusing on potential vulnerabilities and attack vectors.
5. **Mitigation Strategy Development:**  Develop specific, actionable, and tailored mitigation strategies for the identified threats, focusing on practical recommendations that can be implemented by the Chart.js development team.
6. **Recommendation Prioritization:** Prioritize recommendations based on their potential impact and feasibility of implementation.

### 2. Security Implications of Key Components

Based on the provided security design review and inferred architecture, the key components and their security implications are analyzed below:

**2.1. Web Browser (Execution Environment)**

* **Security Implication:** Chart.js executes within the user's web browser, a potentially hostile environment. Any vulnerability in Chart.js can be directly exploited within the browser context, potentially leading to:
    * **Cross-Site Scripting (XSS):** If Chart.js fails to properly sanitize or validate user-provided data (chart data, configuration options), it could be vulnerable to XSS attacks. Malicious scripts could be injected and executed in the user's browser, potentially stealing cookies, session tokens, or performing actions on behalf of the user.
    * **Client-Side Denial of Service (DoS):**  Maliciously crafted chart data or configuration could exploit performance issues or logic flaws in Chart.js, causing excessive resource consumption in the browser and leading to a DoS condition.
    * **Information Disclosure:**  Vulnerabilities could potentially expose sensitive information processed or handled by Chart.js, although this is less likely as Chart.js primarily renders data provided by the application.
* **Mitigation Considerations:**
    * **Robust Input Validation:** Implement strict input validation and sanitization for all user-provided data and configuration options processed by Chart.js.
    * **Secure Coding Practices:** Adhere to secure coding practices to minimize logic flaws and vulnerabilities in the library's code.
    * **Browser Security Features:**  Provide guidance to developers on leveraging browser security features like Content Security Policy (CSP) to further mitigate XSS risks when using Chart.js.

**2.2. Chart.js Library (Core Logic)**

* **Security Implication:** The Chart.js library itself is the primary attack surface. Vulnerabilities within its code are the most direct and impactful security risks.
    * **Input Validation Vulnerabilities (XSS, Injection):** As mentioned above, insufficient input validation is a major concern.
    * **Logic Flaws and Bugs:**  Bugs in the charting logic, data processing, or rendering engine could be exploited to cause unexpected behavior, crashes, or potentially lead to security vulnerabilities.
    * **Prototype Pollution:** JavaScript's prototype-based inheritance can be a source of vulnerabilities if not handled carefully. Malicious input could potentially pollute prototypes, affecting the behavior of the library or even the application using it.
    * **Regular Expression Denial of Service (ReDoS):** If Chart.js uses regular expressions for input validation or data processing, poorly crafted regular expressions could be vulnerable to ReDoS attacks, leading to performance issues or DoS.
* **Mitigation Considerations:**
    * **Comprehensive Input Validation:** Implement input validation at multiple stages of data processing within the library.
    * **Static Application Security Testing (SAST):** Integrate SAST tools into the CI/CD pipeline to automatically detect potential code-level vulnerabilities.
    * **Penetration Testing:** Conduct periodic penetration testing by security experts to identify vulnerabilities that might be missed by automated tools and code reviews.
    * **Secure Coding Training:** Ensure developers are trained in secure coding practices and are aware of common web security vulnerabilities.

**2.3. npm Registry (Package Distribution)**

* **Security Implication:** The npm registry is a critical component in the supply chain. Compromise of the npm registry or Chart.js's npm package could lead to:
    * **Supply Chain Attacks:**  Malicious actors could potentially inject malware or vulnerabilities into the Chart.js package on npm. Developers unknowingly downloading and using the compromised package would then introduce vulnerabilities into their applications.
    * **Account Takeover:** If the npm account of the Chart.js maintainers is compromised, attackers could publish malicious versions of the library.
    * **Dependency Confusion:** In rare cases, if a private package name overlaps with a public package name, there's a theoretical risk of dependency confusion attacks, although less likely for a widely used library like Chart.js.
* **Mitigation Considerations:**
    * **Software Composition Analysis (SCA):** Implement SCA tools in the CI/CD pipeline to continuously monitor dependencies for known vulnerabilities.
    * **Dependency Pinning:** Utilize `package-lock.json` to ensure consistent dependency versions and mitigate risks from unexpected dependency updates.
    * **Code Signing:** Implement code signing for npm packages to ensure the integrity and authenticity of the distributed packages. This allows developers to verify that the package they are downloading is genuinely from the Chart.js team and has not been tampered with.
    * **npm Security Features:** Leverage npm's security features, such as 2FA for maintainer accounts and vulnerability scanning.

**2.4. CDN (Content Delivery Network) (Distribution)**

* **Security Implication:** CDNs are used for efficient distribution but introduce another point of potential compromise in the supply chain.
    * **CDN Compromise:** If the CDN infrastructure itself is compromised, malicious files could be served to users instead of the legitimate Chart.js library.
    * **CDN Account Takeover:**  Compromise of the Chart.js CDN account could allow attackers to replace the library files with malicious versions.
    * **Man-in-the-Middle (MitM) Attacks (without HTTPS):** If Chart.js is loaded over HTTP (which is strongly discouraged), it is vulnerable to MitM attacks where attackers could intercept and modify the library files in transit.
* **Mitigation Considerations:**
    * **HTTPS Enforcement:** Ensure Chart.js is always served over HTTPS from CDNs to prevent MitM attacks and ensure data integrity during transit.
    * **Subresource Integrity (SRI):** Encourage developers to use SRI attributes in `<script>` tags when loading Chart.js from CDNs. SRI allows browsers to verify the integrity of fetched resources against a cryptographic hash, preventing execution of tampered files.
    * **CDN Provider Security:** Choose reputable CDN providers with strong security practices and infrastructure.
    * **Regular CDN Account Security Audits:** Periodically review and audit the security settings and access controls for the CDN account.

**2.5. Build Process (GitHub Actions CI)**

* **Security Implication:** The build process is crucial for ensuring the integrity of the released library. A compromised build process can lead to:
    * **Compromised Build Artifacts:** Attackers could inject malicious code into the build process, resulting in compromised npm packages and CDN files being released to users.
    * **Secret Leakage:** Misconfigured CI/CD pipelines could inadvertently expose sensitive secrets (API keys, credentials) used in the build or deployment process.
    * **Unauthorized Access:**  Insufficient access controls to the CI/CD pipeline could allow unauthorized individuals to modify the build process or release malicious versions.
* **Mitigation Considerations:**
    * **Secure CI/CD Configuration:** Harden the CI/CD pipeline configuration by following security best practices. This includes:
        * **Principle of Least Privilege:** Grant only necessary permissions to CI/CD workflows and service accounts.
        * **Secrets Management:** Securely manage secrets used in the CI/CD pipeline using dedicated secrets management solutions provided by GitHub Actions or external vaults. Avoid hardcoding secrets in workflow files.
        * **Workflow Review and Auditing:** Regularly review and audit CI/CD workflow configurations for security vulnerabilities and misconfigurations.
    * **Build Process Integrity Checks:** Implement integrity checks within the build process to verify the integrity of source code and dependencies before building and releasing artifacts.
    * **Two-Factor Authentication (2FA) for GitHub Accounts:** Enforce 2FA for all developers and maintainers with access to the GitHub repository and CI/CD pipelines.

### 3. Architecture, Components, and Data Flow Inference

Based on the nature of a JavaScript charting library and the provided diagrams, we can infer the following architecture, components, and data flow for Chart.js:

**3.1. Architecture:**

Chart.js follows a client-side architecture. It is a pure JavaScript library that operates entirely within the web browser. It does not have a server-side component. The architecture can be broadly categorized into:

* **Core Library:** Contains the main logic for chart rendering, data processing, configuration handling, and API exposure.
* **Chart Types:** Modules responsible for rendering specific chart types (e.g., bar, line, pie). These likely extend or utilize the core library functionalities.
* **Utilities and Helpers:**  Modules providing utility functions for calculations, data manipulation, and DOM manipulation.
* **Plugins (Extensibility):**  Plugin architecture allowing developers to extend Chart.js functionality without modifying the core library.

**3.2. Components:**

* **Configuration Parser:** Component responsible for parsing and validating chart configuration options provided by the developer. This is a critical component for input validation.
* **Data Processor:** Component that processes the chart data provided by the developer, potentially performing calculations, transformations, and validation.
* **Rendering Engine:** Core component that uses browser APIs (primarily `<canvas>`) to render the charts based on processed data and configuration.
* **Event Handlers:** Components that handle user interactions with the chart (e.g., mouse clicks, hovers) and trigger corresponding events.
* **API (Application Programming Interface):**  Set of JavaScript functions and objects exposed to developers for configuring, manipulating, and interacting with charts.
* **Dependency Libraries:** External JavaScript libraries used by Chart.js for specific functionalities (e.g., date parsing, color manipulation).

**3.3. Data Flow:**

1. **Developer Integration:** Web developer includes Chart.js library in their web application (via `<script>` tag or module import).
2. **Chart Configuration and Data Input:** The web application provides chart configuration options and data to Chart.js through its API. This data originates from the application's backend, user input, or static data within the application.
3. **Configuration Parsing and Validation:** Chart.js's configuration parser component receives the configuration options and performs validation to ensure they are valid and within expected ranges.
4. **Data Processing and Validation:** The data processor component receives the chart data and performs necessary processing, transformations, and crucial input validation to sanitize and validate the data before rendering.
5. **Chart Rendering:** The rendering engine component takes the processed data and configuration and uses browser APIs (primarily `<canvas>`) to draw the chart in the web browser's DOM.
6. **User Interaction and Events:** When the user interacts with the rendered chart (e.g., mouse hover, click), event handlers within Chart.js capture these events and trigger corresponding actions or events that can be handled by the web application.

**Security-Critical Data Flow Points:**

* **Configuration Parsing and Validation (Step 3):**  Crucial for preventing injection attacks through configuration options.
* **Data Processing and Validation (Step 4):**  The most critical point for input validation to prevent XSS and other data-related vulnerabilities.  All user-provided data must be rigorously validated and sanitized before being used in rendering.

### 4. Specific Security Recommendations for Chart.js

Based on the analysis, here are specific and tailored security recommendations for the Chart.js project:

1. **Implement Automated Static Application Security Testing (SAST) in CI/CD Pipeline:**
    * **Action:** Integrate a SAST tool (e.g., SonarQube, ESLint with security plugins, or dedicated JavaScript SAST tools) into the GitHub Actions CI/CD pipeline.
    * **Rationale:** SAST will automatically scan the Chart.js codebase for potential vulnerabilities during each build, providing early detection of security flaws.
    * **Specific Tool Recommendation:** Consider ESLint with security-related plugins like `eslint-plugin-security` as a starting point, and explore more comprehensive SAST tools for JavaScript as the project matures.

2. **Implement Software Composition Analysis (SCA) in CI/CD Pipeline:**
    * **Action:** Integrate an SCA tool (e.g., Snyk, OWASP Dependency-Check, npm audit) into the GitHub Actions CI/CD pipeline.
    * **Rationale:** SCA will automatically identify known vulnerabilities in third-party dependencies used by Chart.js, enabling proactive management of dependency risks.
    * **Specific Tool Recommendation:** `npm audit` is a readily available starting point. Consider more advanced SCA tools like Snyk for broader vulnerability coverage and automated remediation advice.

3. **Establish a Clear Vulnerability Reporting and Response Process:**
    * **Action:** Create a dedicated security policy document (e.g., `SECURITY.md` in the GitHub repository) outlining how security vulnerabilities should be reported. Define a clear process for triaging, patching, and disclosing vulnerabilities.
    * **Rationale:** A clear vulnerability reporting process encourages responsible disclosure from the community and security researchers, enabling timely remediation of security issues.
    * **Specific Steps:**
        * Create a dedicated email address (e.g., `security@chartjs.org`) or a secure reporting platform for vulnerability submissions.
        * Define expected response times for acknowledging and addressing vulnerability reports.
        * Establish a process for verifying, patching, and releasing security fixes.
        * Consider a coordinated vulnerability disclosure policy to balance timely patching with responsible public disclosure.

4. **Regularly Update Dependencies and Automate Dependency Updates:**
    * **Action:** Implement a process for regularly updating dependencies. Explore using automated dependency update tools (e.g., Dependabot, Renovate Bot) to automatically create pull requests for dependency updates.
    * **Rationale:** Keeping dependencies up-to-date is crucial for patching known vulnerabilities in third-party libraries. Automation helps streamline this process and reduces the risk of using outdated and vulnerable dependencies.
    * **Specific Strategy:** Configure Dependabot or Renovate Bot to automatically create pull requests for dependency updates, especially security updates. Prioritize reviewing and merging security-related dependency updates promptly.

5. **Implement Code Signing for Releases (npm Packages and CDN Files):**
    * **Action:** Implement code signing for npm packages and CDN files to ensure the integrity and authenticity of distributed releases.
    * **Rationale:** Code signing provides assurance to developers that the Chart.js library they are using is genuinely from the Chart.js project and has not been tampered with. This mitigates supply chain attack risks.
    * **Specific Technology:** Explore using tools like `cosign` or `gpg` for signing npm packages. For CDN files, consider using CDN provider features for integrity verification or signing mechanisms.

6. **Strengthen Input Validation and Sanitization Throughout the Library:**
    * **Action:** Conduct a thorough review of the Chart.js codebase to identify all points where user-provided data (chart data, configuration options, plugin inputs) is processed. Implement robust input validation and sanitization at each of these points. Focus on preventing XSS vulnerabilities.
    * **Rationale:**  Robust input validation is the most critical security control for a client-side JavaScript library to prevent XSS and other injection vulnerabilities.
    * **Specific Techniques:**
        * **Data Type Validation:** Enforce expected data types for configuration options and data inputs.
        * **Range Validation:** Validate that numerical values are within acceptable ranges.
        * **Sanitization:** Sanitize string inputs to remove or encode potentially malicious characters (e.g., HTML entities, JavaScript event handlers). Consider using DOMPurify or similar libraries for robust HTML sanitization if Chart.js handles any HTML input.
        * **Context-Aware Output Encoding:** Ensure that data is properly encoded for the specific output context (HTML, JavaScript, URL) to prevent injection vulnerabilities.

7. **Provide Developer Guidance on Content Security Policy (CSP) and Subresource Integrity (SRI):**
    * **Action:** Update the Chart.js documentation to include best practices for using Chart.js securely, specifically focusing on:
        * **Content Security Policy (CSP):**  Provide guidance on how developers can configure CSP headers in their web applications to further mitigate XSS risks when using Chart.js. Recommend CSP directives that restrict inline scripts and `eval()`.
        * **Subresource Integrity (SRI):**  Encourage developers to use SRI attributes in `<script>` tags when loading Chart.js from CDNs to ensure the integrity of the loaded library files.
    * **Rationale:**  Providing clear security guidance empowers developers to use Chart.js more securely in their applications and implement defense-in-depth security measures.

### 5. Actionable Mitigation Strategies Applicable to Identified Threats

| Threat                                  | Actionable Mitigation Strategies for Chart.js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               