## Deep Security Analysis of Laravel Backpack CRUD Application

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to comprehensively evaluate the security posture of a Laravel application utilizing the Backpack CRUD package for its administration interface. The primary objective is to identify potential security vulnerabilities and weaknesses inherent in the architecture, components, and data flow of such an application, as inferred from the provided security design review and general understanding of Laravel Backpack CRUD. This analysis will provide specific, actionable, and tailored security recommendations and mitigation strategies to enhance the overall security of applications built with Laravel Backpack CRUD.

**Scope:**

The scope of this analysis encompasses the following aspects of a Laravel Backpack CRUD application, as defined in the security design review:

*   **Context Diagram:** Analyzing the interactions between Admin Users, the Laravel Backpack CRUD Admin Panel, the underlying Laravel Application, and the Database, focusing on access control and data flow security.
*   **Container Diagram:** Examining the security of the Web Application (Laravel/Backpack), Web Server (Nginx/Apache), and Database Server (MySQL/PostgreSQL) containers, including application-level, web server, and database security considerations.
*   **Deployment Diagram:** Assessing the security implications of a cloud-based deployment using container orchestration (ECS/GKE), Load Balancer, Firewall, and Database Server Instance (RDS/Cloud SQL), focusing on cloud infrastructure and network security.
*   **Build Process Diagram:** Evaluating the security of the CI/CD pipeline, code repository, security scanning tools (SAST/Dependency Check), and artifact repository, emphasizing secure development practices and supply chain security.
*   **Risk Assessment:** Considering the critical business process of data and configuration management and the sensitivity of data being protected by the admin panel.
*   **Security Requirements:** Reviewing the defined security requirements for Authentication, Authorization, Input Validation, and Cryptography and ensuring the analysis aligns with these requirements.

This analysis will **not** include a live penetration test or source code audit. It is based on the provided documentation and general knowledge of Laravel Backpack CRUD and web application security best practices.

**Methodology:**

The methodology employed for this deep analysis involves the following steps:

1.  **Document Review:** Thoroughly review the provided Security Design Review document, including the Business Posture, Security Posture, Design diagrams (Context, Container, Deployment, Build), Risk Assessment, and Questions & Assumptions.
2.  **Architecture and Data Flow Inference:** Based on the diagrams and descriptions, infer the application architecture, component interactions, and data flow within the Laravel Backpack CRUD application.
3.  **Threat Modeling:** For each component and interaction identified in the architecture, identify potential security threats and vulnerabilities relevant to Laravel Backpack CRUD and its typical deployment environment. This will be guided by common web application vulnerabilities (OWASP Top 10), container security best practices, and cloud security principles.
4.  **Security Implication Analysis:** Analyze the security implications of each identified threat, considering the potential impact on confidentiality, integrity, and availability of the application and its data.
5.  **Mitigation Strategy Development:** For each identified threat, develop specific, actionable, and tailored mitigation strategies applicable to Laravel Backpack CRUD and its development lifecycle. These strategies will focus on practical recommendations that the development team can implement.
6.  **Recommendation Prioritization:** Prioritize the mitigation strategies based on the severity of the identified threats and the ease of implementation, focusing on high-impact and readily achievable improvements.
7.  **Documentation and Reporting:** Document the entire analysis process, findings, identified threats, security implications, and recommended mitigation strategies in a clear and structured report.

### 2. Security Implications of Key Components and Mitigation Strategies

#### 2.1. Context Diagram Security Implications

**Component Interactions & Data Flow:**

*   **Admin User -> Laravel Backpack CRUD Admin Panel:** Admin users authenticate and interact with the admin panel through a web browser to manage data and configurations.
*   **Laravel Backpack CRUD Admin Panel -> Laravel Application:** The admin panel, built on Backpack CRUD, interacts with the core Laravel application to perform CRUD operations on data models and access application logic.
*   **Laravel Backpack CRUD Admin Panel -> Database:** The admin panel directly or indirectly interacts with the database to read and write data based on admin user actions.
*   **Laravel Application -> Database:** The core Laravel application also interacts with the database for its functionalities, potentially sharing the same database and models with the admin panel.

**Security Implications & Threats:**

1.  **Unauthorized Access (Admin User -> Laravel Backpack CRUD Admin Panel):**
    *   **Threat:** Weak passwords, credential stuffing, brute-force attacks, session hijacking, lack of Multi-Factor Authentication (MFA) can lead to unauthorized access to the admin panel, allowing malicious actors to manage sensitive data and configurations.
    *   **Specific to CRUD:** If default or weak admin credentials are used during setup, or if the login page is not properly protected against brute-force attacks, it becomes a prime target.
    *   **Mitigation Strategy:**
        *   **Enforce Strong Password Policies:** Implement password complexity requirements, minimum length, and regular password rotation reminders.
        *   **Implement Multi-Factor Authentication (MFA):** Mandate MFA for all admin users to add an extra layer of security beyond passwords. Backpack CRUD and Laravel support integration with MFA packages.
        *   **Implement Rate Limiting and Brute-Force Protection:** Utilize Laravel's built-in rate limiting features or dedicated packages to protect login routes from brute-force attempts.
        *   **Secure Session Management:** Configure secure session settings in Laravel (e.g., `secure`, `httponly` flags for cookies, appropriate session lifetime).

2.  **Authorization Bypass (Admin User -> Laravel Backpack CRUD Admin Panel & Panel -> Application/Database):**
    *   **Threat:** Insufficient Role-Based Access Control (RBAC) configuration in Backpack CRUD or Laravel authorization policies can lead to users gaining access to functionalities or data they are not authorized to manage. Misconfigured permissions can lead to privilege escalation.
    *   **Specific to CRUD:** Backpack CRUD relies heavily on developers correctly defining permissions for each CRUD operation and entity. Misconfigurations in `permission_manager` or custom authorization logic can be exploited.
    *   **Mitigation Strategy:**
        *   **Thoroughly Define and Implement RBAC:** Utilize Backpack CRUD's permission management features and Laravel's authorization gates/policies to define granular roles and permissions.
        *   **Principle of Least Privilege:** Grant users only the necessary permissions required for their roles. Regularly review and adjust permissions as roles evolve.
        *   **Audit Authorization Logic:** Conduct code reviews specifically focused on authorization logic to ensure it is correctly implemented and covers all critical functionalities.
        *   **Implement Audit Logging for Authorization Decisions:** Log all authorization attempts (both successful and failed) to monitor access patterns and detect potential unauthorized access attempts.

3.  **Data Breaches and Data Integrity Issues (Panel -> Application/Database & Application -> Database):**
    *   **Threat:** Vulnerabilities in the Laravel application or Backpack CRUD code, such as SQL Injection, insecure direct object references, or business logic flaws, can be exploited through the admin panel to access, modify, or delete sensitive data in the database.
    *   **Specific to CRUD:** CRUD interfaces inherently expose database operations. If input validation and authorization are not robust, they can become direct pathways to database manipulation.
    *   **Mitigation Strategy:**
        *   **Comprehensive Input Validation:** Implement server-side input validation for all CRUD operations using Laravel's validation features. Validate data types, formats, and ranges to prevent injection attacks and ensure data integrity.
        *   **Use Parameterized Queries/Eloquent ORM:** Leverage Laravel's Eloquent ORM, which inherently protects against SQL Injection by using parameterized queries. Avoid raw SQL queries where possible.
        *   **Output Encoding and Sanitization:** Properly encode and sanitize user inputs when displaying data in the admin panel to prevent Cross-Site Scripting (XSS) vulnerabilities.
        *   **Regular Security Audits and Penetration Testing:** Conduct periodic security audits and penetration testing to identify and address potential vulnerabilities in the application code and configuration.

#### 2.2. Container Diagram Security Implications

**Components & Interactions:**

*   **Admin User -> Web Server (Nginx/Apache):** Admin users access the admin panel through a web browser, sending HTTP/HTTPS requests to the web server.
*   **Web Server (Nginx/Apache) -> Web Application (PHP/Laravel):** The web server forwards requests to the Laravel application container for processing.
*   **Web Application (PHP/Laravel) -> Database Server (MySQL/PostgreSQL):** The Laravel application interacts with the database server to store and retrieve data.

**Security Implications & Threats:**

1.  **Web Server Vulnerabilities (Web Server Container):**
    *   **Threat:** Misconfigurations in the web server (Nginx/Apache), outdated software versions, or vulnerabilities in web server modules can be exploited to gain unauthorized access to the server or the application.
    *   **Specific to Containerized Deployment:** Base images for web server containers might contain vulnerabilities if not regularly updated. Default configurations might not be hardened.
    *   **Mitigation Strategy:**
        *   **Web Server Hardening:** Follow web server hardening best practices, including disabling unnecessary modules, setting appropriate permissions, and configuring security headers (e.g., HSTS, X-Frame-Options, X-XSS-Protection, Content-Security-Policy).
        *   **Regular Security Updates and Patching:** Keep the web server software and its dependencies up-to-date with the latest security patches. Automate patching processes where possible.
        *   **Minimize Container Image Footprint:** Use minimal base images for web server containers and remove unnecessary tools and libraries to reduce the attack surface.
        *   **Regularly Scan Web Server Configuration:** Use configuration scanning tools to identify potential misconfigurations in the web server setup.

2.  **Web Application Vulnerabilities (Web Application Container):**
    *   **Threat:** Vulnerabilities in the Laravel application code, Backpack CRUD package, or third-party dependencies (as highlighted in "accepted risk") can be exploited to compromise the application and potentially the underlying system. Common vulnerabilities include XSS, CSRF, insecure deserialization, and logic flaws.
    *   **Specific to Laravel Backpack CRUD:** Reliance on developers to correctly use Backpack CRUD features and Laravel security mechanisms. Vulnerabilities in custom code or misconfigurations of Backpack CRUD can be introduced.
    *   **Mitigation Strategy:**
        *   **Secure Coding Practices:** Enforce secure coding practices within the development team, including input validation, output encoding, secure session management, and proper error handling.
        *   **Regular Dependency Vulnerability Scanning:** Implement automated dependency vulnerability scanning tools (e.g., `composer audit`, tools like Snyk or OWASP Dependency-Check) in the CI/CD pipeline to detect and update vulnerable third-party packages.
        *   **Static Application Security Testing (SAST):** Integrate SAST tools into the development pipeline to automatically scan the application code for potential vulnerabilities during development.
        *   **Dynamic Application Security Testing (DAST):** Perform DAST on the running application to identify vulnerabilities that might not be detectable through static analysis, such as runtime issues and configuration flaws.

3.  **Database Server Vulnerabilities (Database Server Container/Instance):**
    *   **Threat:** Vulnerabilities in the database server software, weak database configurations, or insecure access controls can lead to unauthorized database access, data breaches, and data manipulation.
    *   **Specific to Database Interaction:** CRUD operations directly interact with the database. If database security is weak, the admin panel becomes a high-value target for database attacks.
    *   **Mitigation Strategy:**
        *   **Database Server Hardening:** Follow database server hardening best practices, including disabling unnecessary features, setting strong passwords for database users, and configuring appropriate access controls.
        *   **Database Access Controls:** Implement strict database access controls, granting the web application container only the necessary privileges to access the database. Use separate database users with limited permissions for the admin panel and the core application if feasible.
        *   **Encryption at Rest and in Transit:** Enable encryption for data at rest in the database (if required by compliance or business needs) and ensure all communication between the web application and the database server is encrypted (e.g., using TLS/SSL).
        *   **Regular Database Security Audits:** Conduct regular security audits of the database server configuration and access controls to identify and address potential weaknesses.

#### 2.3. Deployment Diagram Security Implications

**Components & Interactions:**

*   **Admin User -> Load Balancer:** Admin users access the admin panel through the load balancer, which distributes traffic.
*   **Load Balancer -> Firewall:** Traffic passes through a firewall for network security.
*   **Firewall -> Web Server Container:** Firewall allows traffic to the web server containers.
*   **Web Server Container -> Web Application Container:** Web server containers forward requests to application containers.
*   **Web Application Container -> Database Server Instance (RDS/Cloud SQL):** Application containers interact with the managed database service.

**Security Implications & Threats:**

1.  **Cloud Infrastructure Misconfigurations (Cloud Environment - AWS/GCP):**
    *   **Threat:** Misconfigurations in cloud services (AWS/GCP), such as overly permissive security groups, publicly exposed storage buckets, or insecure IAM roles, can create vulnerabilities and allow unauthorized access to the deployment environment.
    *   **Specific to Cloud Deployment:** Cloud environments offer numerous configuration options, and misconfigurations are a common source of security breaches.
    *   **Mitigation Strategy:**
        *   **Infrastructure as Code (IaC) Security:** Use IaC tools (e.g., Terraform, CloudFormation) to define and manage cloud infrastructure securely. Implement security best practices in IaC configurations and use security linters to detect misconfigurations.
        *   **Principle of Least Privilege for IAM Roles:** Grant cloud service IAM roles only the necessary permissions required for their functions. Regularly review and refine IAM policies.
        *   **Security Groups and Network ACLs:** Configure security groups and network ACLs to restrict network access to only necessary ports and protocols. Follow the principle of least privilege for network access.
        *   **Cloud Security Posture Management (CSPM):** Utilize CSPM tools to continuously monitor the cloud environment for misconfigurations and compliance violations.

2.  **Load Balancer and Firewall Misconfigurations (Load Balancer & Firewall):**
    *   **Threat:** Misconfigured load balancers or firewalls can fail to properly filter traffic, expose unnecessary ports, or be vulnerable to attacks like DDoS.
    *   **Specific to Network Perimeter Security:** Load balancer and firewall are the first line of defense. Misconfigurations here can bypass network security controls.
    *   **Mitigation Strategy:**
        *   **HTTPS Enforcement:** Configure the load balancer to enforce HTTPS and redirect HTTP traffic to HTTPS to ensure encrypted communication.
        *   **DDoS Protection:** Enable DDoS protection features offered by the cloud provider or use a dedicated DDoS mitigation service to protect against denial-of-service attacks.
        *   **Web Application Firewall (WAF):** Consider implementing a WAF in front of the web application to protect against common web application attacks (e.g., OWASP Top 10).
        *   **Regularly Review Firewall Rules:** Periodically review and refine firewall rules to ensure they are still relevant and effectively restrict unauthorized access.

3.  **Database Server Instance Security (Database Server Instance - RDS/Cloud SQL):**
    *   **Threat:** Even with managed database services, misconfigurations, weak access controls, or lack of encryption can lead to database breaches.
    *   **Specific to Managed Services:** While managed services handle infrastructure, security configuration is still the user's responsibility.
    *   **Mitigation Strategy:**
        *   **VPC and Network Isolation:** Deploy the database server instance within a Virtual Private Cloud (VPC) and isolate it from public internet access.
        *   **Database Access Controls (RDS/Cloud SQL):** Utilize the access control features provided by RDS/Cloud SQL to restrict database access to only authorized resources (e.g., web application containers).
        *   **Encryption at Rest and in Transit (RDS/Cloud SQL):** Enable encryption at rest and in transit for the database server instance as provided by RDS/Cloud SQL.
        *   **Database Monitoring and Logging:** Enable database monitoring and logging features to detect suspicious activity and security incidents.

#### 2.4. Build Diagram Security Implications

**Components & Interactions:**

*   **Developer -> Code Repository (GitHub):** Developers commit code changes to the code repository.
*   **Code Repository (GitHub) -> CI/CD Pipeline (GitHub Actions):** Code changes trigger the CI/CD pipeline.
*   **CI/CD Pipeline (GitHub Actions) -> Build Process:** The pipeline executes the build process steps.
*   **Build Process -> Security Scanners (SAST/Dependency Check):** Security scanners analyze the built artifacts.
*   **Security Scanners -> Artifact Repository (Container Registry):** Secure artifacts are pushed to the container registry.

**Security Implications & Threats:**

1.  **Code Repository Security (Code Repository - GitHub):**
    *   **Threat:** Compromised developer accounts, unauthorized access to the code repository, or malicious code injection can lead to the introduction of vulnerabilities or backdoors into the application.
    *   **Specific to Source Code Management:** The code repository is the foundation of the application. Compromise here can have severe consequences.
    *   **Mitigation Strategy:**
        *   **Secure Code Repository Access Controls:** Implement strong access controls for the code repository, granting access only to authorized developers and using role-based permissions.
        *   **Multi-Factor Authentication (MFA) for Developers:** Enforce MFA for all developer accounts accessing the code repository.
        *   **Code Review Process:** Implement a mandatory code review process for all code changes to identify potential security vulnerabilities and malicious code before they are merged into the main branch.
        *   **Audit Logging for Code Repository Activity:** Enable audit logging for code repository activity to track changes and detect suspicious actions.

2.  **CI/CD Pipeline Security (CI/CD Pipeline - GitHub Actions):**
    *   **Threat:** Compromised CI/CD pipeline configurations, insecure credentials management within the pipeline, or vulnerabilities in pipeline tools can lead to unauthorized modifications of the build process, injection of malicious code, or exposure of sensitive information.
    *   **Specific to Automation:** CI/CD pipelines automate critical processes. Security breaches here can automate the deployment of compromised applications.
    *   **Mitigation Strategy:**
        *   **Secure CI/CD Pipeline Configuration:** Harden the CI/CD pipeline configuration, following security best practices for workflow definitions and permissions.
        *   **Secure Credentials Management:** Use secure secrets management mechanisms provided by the CI/CD platform (e.g., GitHub Actions secrets) to store and access sensitive credentials. Avoid hardcoding credentials in pipeline configurations.
        *   **Pipeline Integrity Verification:** Implement mechanisms to verify the integrity of the CI/CD pipeline code and configurations to prevent unauthorized modifications.
        *   **Regularly Audit CI/CD Pipeline:** Periodically audit the CI/CD pipeline configuration and access controls to ensure they remain secure.

3.  **Build Artifact Security (Build Process & Artifact Repository - Container Registry):**
    *   **Threat:** Vulnerabilities in base images used for Docker builds, lack of security scanning during the build process, or insecure artifact repository access controls can lead to the deployment of vulnerable container images.
    *   **Specific to Containerization:** Container images are the final deployable artifact. Vulnerabilities here directly impact the deployed application.
    *   **Mitigation Strategy:**
        *   **Use Trusted Base Images:** Use trusted and regularly updated base images for Docker builds from reputable sources.
        *   **Container Image Scanning:** Integrate container image scanning tools into the CI/CD pipeline to automatically scan built Docker images for vulnerabilities before they are pushed to the artifact repository.
        *   **Artifact Repository Access Control:** Implement strict access controls for the artifact repository, restricting who can push and pull container images.
        *   **Image Signing and Verification:** Implement image signing and verification mechanisms to ensure the integrity and authenticity of container images deployed from the artifact repository.

### 3. Actionable and Tailored Mitigation Strategies Summary

| Security Area          | Threat Category                                  | Specific Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               