# Threat Model Analysis for erusev/parsedown

## Threat: [Cross-Site Scripting (XSS) via Malicious Markdown](./threats/cross-site_scripting__xss__via_malicious_markdown.md)

*   **Description:**
    *   An attacker crafts malicious Markdown input containing JavaScript code or HTML elements that execute scripts.
    *   Parsedown processes this input and converts it into HTML containing the malicious script *without* automatically encoding it.
    *   If the application renders this generated HTML in a user's browser without further encoding, the script will execute.
*   **Impact:**
    *   The attacker can execute arbitrary JavaScript code in the victim's browser within the context of the vulnerable application.
    *   This can lead to session hijacking, cookie theft, defacement of the website, redirection to malicious sites, or performing actions on behalf of the user.
*   **Affected Parsedown Component:**
    *   HTML Output Generation (specifically the lack of automatic encoding of potentially dangerous HTML tags and attributes).
*   **Risk Severity:** Critical
*   **Mitigation Strategies:**
    *   **Strict Output Encoding:**  Always encode the HTML output generated by Parsedown before rendering it in the browser. Use context-aware encoding functions appropriate for HTML (e.g., escaping HTML entities). This is the most crucial mitigation.
    *   **Content Security Policy (CSP):** Implement a strong CSP to restrict the sources from which the browser can load resources, mitigating the impact of successful XSS.

## Threat: [HTML Injection](./threats/html_injection.md)

*   **Description:**
    *   An attacker crafts Markdown input containing arbitrary HTML elements.
    *   Parsedown converts this Markdown into HTML, including the attacker's injected HTML.
    *   When the application renders this HTML, the attacker's injected content is displayed.
*   **Impact:**
    *   The attacker can inject arbitrary HTML content into the application's pages.
    *   This can lead to visual defacement, phishing attempts by mimicking legitimate UI elements, or embedding malicious iframes that could lead to further attacks.
*   **Affected Parsedown Component:**
    *   HTML Output Generation (specifically the parsing and rendering of HTML tags within Markdown).
*   **Risk Severity:** High
*   **Mitigation Strategies:**
    *   **Strict Output Encoding:** Encoding HTML entities will prevent the browser from interpreting injected HTML tags.
    *   **Content Security Policy (CSP):** Can help mitigate the impact of injected content, especially iframes.
    *   **Careful Consideration of Allowed HTML:** If the application's use case allows, consider using a more restrictive Markdown parser or a configuration that limits the allowed HTML tags.

