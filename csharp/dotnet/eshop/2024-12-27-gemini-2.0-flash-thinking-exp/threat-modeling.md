
## High and Critical eShop Threats

| Threat | Description (Attacker Action & How) | Impact | Affected Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Microservice Impersonation** | An attacker deploys a rogue microservice mimicking a legitimate one. This could be done by exploiting vulnerabilities in service discovery, insecure inter-service authentication, or network misconfigurations. The rogue service intercepts sensitive data or manipulates requests. | Data breaches, unauthorized access to services, denial of service by disrupting legitimate service interactions. | Service Discovery (e.g., Kubernetes DNS, Consul), all backend microservices. | High | Implement mutual TLS (mTLS) for inter-service communication, enforce strong authentication and authorization between services (e.g., using JWTs with proper validation), secure service discovery mechanisms, implement network segmentation and firewalls to restrict communication paths. |
| **Message Queue Spoofing/Tampering** | An attacker injects malicious messages into the RabbitMQ queue or intercepts and modifies existing messages. This can be achieved by exploiting weak access controls on the message broker or lack of message signing/encryption. | Data corruption, triggering unintended actions in other services, denial of service by flooding the queue with malicious messages, leaking sensitive information. | RabbitMQ message broker, all services communicating via RabbitMQ (e.g., Ordering, Basket). | High | Implement strong authentication and authorization for access to the message broker, use message signing and encryption to ensure integrity and confidentiality, implement message validation on the consumer side, consider using a more secure messaging protocol if feasible. |
| **Inter-Service Communication Tampering** | An attacker intercepts and modifies communication between microservices. This can happen if internal communication is not encrypted (e.g., using plain HTTP instead of HTTPS) or if authentication is weak. | Data corruption, unauthorized modifications to orders, catalogs, or user data, inconsistent state across services. | All backend microservices, API Gateways. | High | Enforce HTTPS for all internal communication between microservices, implement mutual TLS (mTLS) for authentication and encryption, ensure proper input validation on both sender and receiver sides. |
| **Exposure of Internal Service Endpoints** | Internal microservice endpoints are inadvertently exposed to the public internet. This could be due to misconfigured network policies or insecure deployment practices. Attackers can directly interact with these endpoints, bypassing API Gateways and security controls. | Direct access to sensitive data, potential for exploitation of service-specific vulnerabilities, bypassing authentication and authorization mechanisms. | All backend microservices. | Critical | Implement strict network segmentation and firewall rules to restrict access to internal services, ensure API Gateways are the only entry points for external traffic, regularly audit network configurations. |
| **Sensitive Data in Inter-Service Communication** | Sensitive data (e.g., user credentials, order details) is transmitted in plain text between microservices. | Eavesdropping and interception of sensitive information, potential for credential theft and further attacks. | All backend microservices, API Gateways. | High | Enforce HTTPS for all internal communication, avoid transmitting sensitive data in request parameters or URLs, encrypt sensitive data at rest and in transit. |
| **Exposure of Message Queue Contents** | Unauthorized access to the RabbitMQ queue allows attackers to read sensitive messages. | Exposure of business-critical data, user information, and internal processes. | RabbitMQ message broker. | High | Implement strong authentication and authorization for access to the message broker, encrypt sensitive data within messages, regularly audit access controls. |
| **Microservice Overload (DoS)** | An attacker floods a specific microservice with a large number of requests, overwhelming its resources and causing it to become unavailable. | Disruption of specific functionalities, potentially impacting the entire application if the overloaded service is critical. | Specific backend microservices (e.g., Catalog, Ordering). | High | Implement rate limiting and throttling on API Gateways and within individual microservices, implement circuit breakers to prevent cascading failures, ensure adequate resource allocation and autoscaling for microservices. |
| **Exploiting Inter-Service Authentication Weaknesses** | An attacker compromises the authentication mechanism used between microservices to gain access to other services with elevated privileges. This could involve exploiting weak or default credentials, vulnerabilities in token validation, or lack of mutual TLS. | Unauthorized access to sensitive data and functionalities across multiple services, potential for lateral movement within the system. | All backend microservices. | Critical | Enforce strong, unique credentials for inter-service authentication, implement robust token validation and rotation mechanisms, use mutual TLS (mTLS) for authentication and encryption. |
| **Authorization Bypass in Microservices** | An attacker exploits flaws in the authorization logic within individual microservices to perform actions that should be restricted. | Unauthorized modification of data, access to restricted functionalities, potential for privilege escalation within a specific service. | Specific backend microservices. | High | Implement consistent and well-defined authorization policies, conduct thorough code reviews to identify authorization vulnerabilities, use attribute-based access control (ABAC) for more granular control. |
| **Dependency Confusion/Substitution** | An attacker introduces a malicious package with the same name as an internal dependency, which is then inadvertently pulled into the build process. | Introduction of malicious code into the application, potentially leading to data breaches, remote code execution, or other malicious activities. | Build pipeline, all microservices. | Critical | Implement dependency pinning and checksum verification, use a private package registry or repository manager, regularly scan dependencies for vulnerabilities. |