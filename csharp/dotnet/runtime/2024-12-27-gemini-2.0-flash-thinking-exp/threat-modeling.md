
## High and Critical .NET Runtime Threats

This table outlines high and critical threats directly involving the `dotnet/runtime` repository.

| Threat | Description (Attacker Action & Method) | Impact | Affected Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **JIT Compiler Code Execution** | An attacker provides specially crafted input or code that triggers a bug in the Just-In-Time (JIT) compiler. This bug allows the compiler to generate incorrect or malicious native code, leading to arbitrary code execution. | Full system compromise, data breach, denial of service. | `clr/src/vm/jit.cpp` (JIT Compiler) | **Critical** | Keep the .NET runtime updated to the latest stable version with security patches. Consider using ReadyToRun (R2R) compilation for some performance benefits but be aware of potential trade-offs. Implement strong input validation and sanitization. |
| **Garbage Collector Memory Corruption** | An attacker manipulates object allocation patterns or triggers specific conditions that expose vulnerabilities in the Garbage Collector (GC). This can lead to memory corruption, use-after-free, or double-free conditions, potentially enabling code execution. | Code execution, application crash, data corruption. | `clr/src/gc/` (Garbage Collector) | **Critical** | Keep the .NET runtime updated. Be mindful of resource usage and avoid excessive object creation/destruction in performance-critical sections. Utilize memory profiling tools to identify potential issues. |
| **Type Confusion via Deserialization** | An attacker crafts malicious serialized data that, when deserialized, leads to type confusion. The runtime misinterprets the type of an object, allowing for unexpected operations and potential code execution. | Code execution, data corruption, information disclosure. | `src/libraries/System.Runtime.Serialization.Formatters.Binary/` (BinaryFormatter - **Avoid**) | **High** | **Avoid using `BinaryFormatter` for deserializing untrusted data.** Prefer secure serialization formats like JSON or Protocol Buffers. Implement strong input validation and schema validation for deserialized data. Use type-safe deserialization patterns. |
| **Native Interop Vulnerabilities (P/Invoke)** | An attacker exploits vulnerabilities in native libraries called through Platform Invoke (P/Invoke). This can occur due to insecure coding practices in the native code or improper data marshalling between managed and unmanaged code. | Code execution with the privileges of the application process, data corruption, system compromise. | `clr/src/vm/dllimport.cpp` (P/Invoke implementation) | **High** | Carefully review and validate input passed to native functions. Use secure coding practices in native libraries. Consider using safer alternatives to P/Invoke where possible. Implement robust error handling for native calls. |
| **Serialization/Deserialization Gadgets (Chains)** | An attacker leverages existing classes within the .NET runtime or its libraries (gadgets) to construct a chain of operations during deserialization that leads to unintended consequences, such as remote code execution. | Code execution, data manipulation. | Various BCL classes involved in serialization and deserialization. | **High** | Be extremely cautious when deserializing data from untrusted sources. Implement robust input validation and sanitization. Consider using allow-lists for deserialization types. Keep dependencies updated as gadget chains are often discovered and patched. |

**Risk Severity Definitions:**

* **Critical:** Exploitation is highly likely and leads to immediate and severe impact, such as remote code execution or full system compromise.
* **High:** Exploitation is likely and leads to significant impact, such as data breaches or significant service disruption.