## Deep Security Analysis of Bogus Fake Data Generator Application

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to thoroughly evaluate the security posture of the planned Bogus web application for generating fake data. The primary objective is to identify potential security vulnerabilities and threats within the application's design, focusing on its key components and data flow. This analysis will provide actionable and tailored security recommendations to the development team to enhance the application's security and protect against potential attacks.  A key aspect is to understand how the integration of the `bogus` library within the Data Generation Engine impacts the overall security of the web application.

**Scope:**

The scope of this analysis is limited to the Bogus web application as described in the provided "Security Design Review" document.  It encompasses the following key components and aspects:

* **Frontend (UI):** Analysis of client-side security considerations related to user interaction, schema definition, and data presentation.
* **Backend API (Flask):** Examination of API security, input validation, data processing, and communication with other components.
* **Data Generation Engine (Python, leveraging `bogus` library):**  Assessment of security implications related to schema processing, data generation logic, resource management, and potential vulnerabilities within the engine and its dependencies, including the `bogus` library itself (though we are analyzing its *usage* within this application context, not the library's internal security directly).
* **Data Storage (Optional):**  Security considerations for optional data storage components, including access control and data protection.
* **Data Flow:** Analysis of data flow pathways between components, identifying potential security checkpoints and vulnerabilities during data transmission and processing.
* **Deployment Architecture:** Review of the proposed deployment architecture and its security implications, including network segmentation and component isolation.

This analysis will not include:

* **Source code review of the `bogus` library itself:** We assume the `bogus` library is a functional data generation tool and focus on its integration and usage within the Bogus web application.
* **Penetration testing or dynamic security testing:** This analysis is based on the design document and is a static security review.
* **Compliance or regulatory aspects:**  While security is related to compliance, this analysis focuses on technical security vulnerabilities and mitigations.

**Methodology:**

This deep security analysis will employ a Security Design Review methodology, incorporating the following steps:

1. **Document Review:**  Thorough review of the provided "Security Design Review" document to understand the application's architecture, components, data flow, and intended functionality.
2. **Architecture and Component Decomposition:**  Break down the application into its key components (Frontend, Backend API, Data Generation Engine, Data Storage) and analyze their individual functionalities and interactions based on the design document.
3. **Threat Identification (STRIDE-based):** Utilize the STRIDE threat modeling methodology (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege) to systematically identify potential threats relevant to each component and data flow within the Bogus application.
4. **Vulnerability Analysis:**  Analyze potential vulnerabilities in the design and implementation of each component that could be exploited by the identified threats. This will be guided by common web application security vulnerabilities (OWASP Top Ten, etc.) and the specific functionalities of the Bogus application.
5. **Risk Assessment (Qualitative):**  Qualitatively assess the likelihood and potential impact of each identified threat and vulnerability to prioritize mitigation efforts.
6. **Mitigation Strategy Development:**  Develop specific, actionable, and tailored mitigation strategies for each identified threat and vulnerability. These strategies will be practical recommendations for the development team, focusing on security controls that can be implemented within the Bogus application.
7. **Documentation and Reporting:**  Document the entire analysis process, including identified threats, vulnerabilities, risks, and mitigation strategies in this report.

### 2. Security Implications of Key Components

#### 2.1 Frontend Component (UI)

**Security Implications:**

* **Cross-Site Scripting (XSS):** The Frontend handles user input for schema definition and displays generated data. If user input is not properly sanitized and output encoded, it could be vulnerable to XSS attacks. Malicious scripts could be injected through schema definitions or even within the generated data itself (though less likely in fake data generation, defensive programming is key).
* **Client-Side Input Validation Bypass:**  Relying solely on client-side validation for schema definitions is insecure. Attackers can bypass client-side checks and send malicious or invalid schemas directly to the Backend API.
* **Man-in-the-Middle (MitM) Attacks:** If communication between the Frontend and Backend API is not over HTTPS, sensitive data (schema definitions, potentially generated data) could be intercepted and eavesdropped upon.
* **Dependency Vulnerabilities:**  Frontend JavaScript frameworks and libraries may contain known security vulnerabilities. Outdated or unpatched dependencies can introduce security risks.
* **Content Security Policy (CSP) Misconfiguration:**  An improperly configured CSP can fail to adequately protect against XSS attacks or even introduce new vulnerabilities.

**Specific Security Considerations for Bogus Frontend:**

* **Schema Editor Vulnerabilities:**  If the schema editor uses complex JavaScript components, vulnerabilities in these components could be exploited.
* **Data Preview XSS:** If a real-time data preview is implemented, ensure that the preview mechanism properly sanitizes and encodes data to prevent XSS.
* **Download Functionality:** Ensure that the download functionality does not introduce any client-side vulnerabilities, especially if handling different output formats.

#### 2.2 Backend API Component (Flask)

**Security Implications:**

* **Injection Attacks (SQL Injection, Command Injection, NoSQL Injection - potentially less relevant here but consider code injection in data generation logic):**  If the Backend API interacts with a database (even for optional storage) or executes system commands based on user input (schema definitions), it could be vulnerable to injection attacks if input is not properly validated and sanitized. While SQL injection might be less direct, if schemas are stored and later retrieved and used in queries, it becomes relevant. Command injection could be a risk if the data generation engine executes external processes based on schema parameters.
* **Insecure Deserialization (Less likely in this design, but worth noting for future extensions):** If the API handles serialized objects (e.g., for complex schema definitions or caching), insecure deserialization vulnerabilities could arise if not handled carefully.
* **Authentication and Authorization Bypass (Future Feature):** If user authentication and authorization are implemented in the future, vulnerabilities in these mechanisms could allow unauthorized access to API endpoints and data.
* **API Abuse (Rate Limiting/Throttling):** Without rate limiting or throttling, the API could be susceptible to denial-of-service attacks by overwhelming it with excessive requests.
* **Information Disclosure:**  Improper error handling or verbose logging could expose sensitive information about the application's internal workings to attackers.
* **Cross-Origin Resource Sharing (CORS) Misconfiguration:**  Incorrect CORS configuration could allow unauthorized cross-origin requests, potentially leading to data breaches or other attacks.
* **Dependency Vulnerabilities:**  Flask and its Python dependencies may contain known security vulnerabilities.

**Specific Security Considerations for Bogus Backend API:**

* **Schema Validation Bypass:**  Insufficient or flawed schema validation is a critical vulnerability. Attackers could craft malicious schemas to bypass validation and potentially exploit vulnerabilities in the Data Generation Engine.
* **Resource Exhaustion through Schema Complexity:**  Maliciously crafted, extremely complex schemas could be designed to consume excessive server resources (CPU, memory), leading to denial-of-service.
* **Data Sanitization for Output Formats:**  Ensure proper sanitization and encoding of generated data when formatting it into different output formats (especially HTML) to prevent XSS when the data is displayed by users who might copy/paste it elsewhere.

#### 2.3 Data Generation Engine (Python, using `bogus` library)**

**Security Implications:**

* **Resource Exhaustion:**  Maliciously crafted schemas could be designed to trigger resource-intensive data generation processes, leading to denial-of-service.
* **Code Injection (Indirect):** While direct code injection into the engine itself might be less likely, vulnerabilities in schema parsing or data generation logic could potentially be exploited to indirectly execute malicious code or commands if the engine interacts with external systems or executes dynamic code based on schema parameters (less likely in this design but consider future extensibility).
* **Data Provider Security (If External Data Sources are Used):** If the engine uses external data sources to enhance realism, vulnerabilities in accessing or processing data from these sources could be exploited. Compromised external data sources could also inject malicious data.
* **Dependency Vulnerabilities:**  Python libraries used in the Data Generation Engine, including `bogus` and any other data generation libraries, may contain known security vulnerabilities.

**Specific Security Considerations for Bogus Data Generation Engine:**

* **Schema Parsing Vulnerabilities:**  Vulnerabilities in the schema parsing logic could be exploited to cause crashes, resource exhaustion, or even code execution.
* **`bogus` Library Vulnerabilities:** While we are not directly analyzing `bogus`, it's important to be aware of any known vulnerabilities in the specific version of the `bogus` library being used and to keep it updated.
* **Unintended Data Generation Behavior:**  Flaws in the data generation algorithms or logic could lead to the generation of data that is not truly "fake" but might inadvertently expose sensitive patterns or information if not carefully designed.

#### 2.4 Data Storage (Optional - Caching/Configuration)

**Security Implications:**

* **Unauthorized Access:**  If data storage is implemented, insufficient access control could allow unauthorized components or attackers to access sensitive data (e.g., user schemas, cached data).
* **Data Breach:**  Compromise of the data storage component could lead to a data breach, exposing stored schemas or cached generated data.
* **Data Integrity Issues:**  Lack of data validation on retrieval from storage could lead to data integrity issues or even injection attacks if stored data is later used in a vulnerable way.
* **Data Injection (Indirect):** If stored schemas are not properly sanitized when retrieved and used, they could become a vector for injection attacks in other components.

**Specific Security Considerations for Bogus Data Storage:**

* **Schema Storage Security:** If user-defined schemas are stored, they should be protected from unauthorized access and modification.
* **Cached Data Security:** If generated data is cached, consider the sensitivity of the cached data and implement appropriate access controls.
* **Configuration Data Security:** If configuration data is stored, protect sensitive configuration parameters (e.g., database credentials, API keys for external data sources).

### 3. Architecture, Components, and Data Flow Inference

The provided design document clearly outlines a three-tier architecture with Frontend, Backend API, and Data Generation Engine. The data flow is primarily driven by user requests from the Frontend to the Backend API, which then orchestrates the Data Generation Engine.

**Key Inferences based on the Design Document and Codebase (GitHub link points to a library, not a web app, so inference is primarily from the design document):**

* **RESTful API:** The Backend API is designed as a RESTful API, handling requests from the Frontend over HTTPS. This implies standard REST API security considerations apply.
* **Schema-Driven Data Generation:** The core functionality revolves around user-defined schemas. Security heavily relies on robust schema validation and sanitization at the Backend API level.
* **Data Flow Security Checkpoints:** The primary security checkpoints are:
    * **Frontend to Backend API communication (HTTPS):** Ensuring secure transmission of schema definitions and generated data.
    * **Backend API Schema Validation & Sanitization:**  Critical for preventing injection attacks and ensuring data integrity.
    * **Data Generation Engine Schema Processing:**  Ensuring secure and resource-efficient processing of validated schemas.
    * **Backend API Output Formatting:**  Proper encoding of generated data for different output formats to prevent XSS.
    * **Data Storage Access Control (Optional):**  If implemented, securing access to stored schemas and cached data.

**Data Flow Diagram (from Design Document) - Re-emphasized for Security Context:**

```mermaid
graph LR
    A["'User Browser'"] --> B["'Frontend (UI)'"]: User Input (Schema Definition, Format Selection)
    B --> C["'Backend API (Flask)'"]: API Request (Schema, Format) - HTTPS (Secure Channel)
    style C fill:#f9f,stroke:#333,stroke-width:2px
    C --> C1["'Schema Validation & Sanitization'"]: **CRITICAL SECURITY CHECKPOINT** - Validate Schema, Sanitize Input
    style C1 fill:#ccf,stroke:#333,stroke-width:2px
    C1 --> D["'Data Generation Engine (Python)'"]: Validated Schema
    style D fill:#ccf,stroke:#333,stroke-width:2px
    D --> C2["'Data Generation'"]: Generate Fake Data
    style C2 fill:#ccf,stroke:#333,stroke-width:2px
    C2 --> C3["'Format Data (JSON/CSV/HTML)'"]: **SECURITY CHECKPOINT** - Format Output Data (Encoding for XSS Prevention)
    style C3 fill:#ccf,stroke:#333,stroke-width:2px
    C3 --> C4["'Response Handling'"]: Send Formatted Data - HTTPS (Secure Channel)
    style C4 fill:#f9f,stroke:#333,stroke-width:2px
    C4 --> B: Formatted Data
    B --> A: Display Data

    linkStyle 0,3,7,8 stroke:#000,stroke-width:2px;
    linkStyle 1,2,4,5,6 stroke:#007bff,stroke-width:2px;
```

### 4. Tailored Security Considerations and Mitigation Strategies

Based on the component analysis and data flow, here are specific and tailored security considerations and actionable mitigation strategies for the Bogus application:

**4.1 Frontend Component (UI) - Security Considerations & Mitigations:**

* **XSS Vulnerabilities:**
    * **Mitigation:**
        * **Output Encoding:**  Implement robust output encoding for all user-provided data displayed in the UI. Use templating engines (like React JSX, Vue templates, or Angular templates) that provide automatic XSS protection by default. For dynamic content insertion, use browser APIs that prevent script execution (e.g., `textContent` instead of `innerHTML` where appropriate).
        * **Content Security Policy (CSP):** Implement a strict CSP to control the sources from which the browser is allowed to load resources. This significantly reduces the impact of XSS vulnerabilities. Start with a restrictive policy and gradually relax it as needed, ensuring each relaxation is carefully considered.
* **Client-Side Input Validation Bypass:**
    * **Mitigation:**
        * **Server-Side Validation (Crucial):**  **Never rely on client-side validation for security.** Implement comprehensive server-side input validation and sanitization in the Backend API (as detailed below). Client-side validation is only for user experience, not security.
* **Man-in-the-Middle (MitM) Attacks:**
    * **Mitigation:**
        * **HTTPS Enforcement:**  **Enforce HTTPS for all communication between the Frontend and Backend API.** Configure the web server and load balancer to redirect HTTP requests to HTTPS. Implement `Strict-Transport-Security` (HSTS) header to instruct browsers to always use HTTPS.
* **Dependency Vulnerabilities:**
    * **Mitigation:**
        * **Dependency Management:** Use a dependency management tool (npm/yarn) to track and manage frontend dependencies.
        * **Regular Updates:** Regularly update frontend JavaScript libraries and frameworks to the latest versions to patch known security vulnerabilities. Automate dependency vulnerability scanning as part of the CI/CD pipeline.
* **CSP Misconfiguration:**
    * **Mitigation:**
        * **CSP Review and Testing:** Carefully review and test the CSP configuration to ensure it effectively mitigates XSS risks without breaking application functionality. Use online CSP validators and browser developer tools to test the policy.

**4.2 Backend API Component (Flask) - Security Considerations & Mitigations:**

* **Injection Attacks (Schema Validation is Key):**
    * **Mitigation:**
        * **Robust Schema Validation & Sanitization (Critical):** Implement **strict server-side schema validation** before passing schemas to the Data Generation Engine. Use a schema validation library (like `jsonschema` for JSON schemas) to enforce data types, formats, ranges, and constraints. Sanitize input to remove or escape potentially malicious characters.
        * **Parameterized Queries/ORM (If Database is Used):** If database interaction is implemented, use parameterized queries or an ORM to prevent SQL injection.
        * **Input Sanitization for Command Execution (If Applicable):** If the engine or API interacts with the operating system based on schema parameters (less likely but consider future features), sanitize input to prevent command injection. Avoid executing system commands based on user input if possible.
* **API Abuse (Denial of Service):**
    * **Mitigation:**
        * **Rate Limiting & Throttling:** Implement rate limiting and throttling mechanisms at the API gateway or within the Flask application to limit the number of requests from a single IP address or user within a given time frame. This will protect against brute-force attacks and denial-of-service attempts.
* **Information Disclosure:**
    * **Mitigation:**
        * **Secure Error Handling:** Implement proper error handling that provides informative error responses to the Frontend but **avoids exposing sensitive information** (internal paths, database details, stack traces) to users or attackers. Log detailed error information securely on the server-side for debugging.
        * **Secure Logging:** Implement comprehensive logging for security-related events (authentication attempts, authorization failures, input validation errors, exceptions). **Ensure logs do not contain sensitive data** and are stored securely with restricted access.
* **CORS Misconfiguration:**
    * **Mitigation:**
        * **Restrictive CORS Policy:** Configure CORS policies carefully to only allow cross-origin requests from trusted origins (e.g., the Frontend's domain if served from a different origin). Avoid using wildcard (`*`) for `Access-Control-Allow-Origin` in production.
* **Dependency Vulnerabilities:**
    * **Mitigation:**
        * **Dependency Management (pip):** Use `pip` and `requirements.txt` to manage Python dependencies.
        * **Regular Updates:** Regularly update Flask and Python libraries to patch known security vulnerabilities. Use vulnerability scanning tools for Python dependencies and automate checks in the CI/CD pipeline.
* **Security Headers:**
    * **Mitigation:**
        * **Implement Security Headers:** Configure the web server (Nginx) or Flask application to send security headers such as:
            * `Strict-Transport-Security` (HSTS)
            * `X-Content-Type-Options: nosniff`
            * `X-Frame-Options: DENY` or `SAMEORIGIN`
            * `X-XSS-Protection: 1; mode=block`
            * `Referrer-Policy: no-referrer` or `strict-origin-when-cross-origin`

**4.3 Data Generation Engine (Python, using `bogus` library) - Security Considerations & Mitigations:**

* **Resource Exhaustion (Schema Complexity):**
    * **Mitigation:**
        * **Schema Complexity Limits:** Implement limits on schema complexity (e.g., maximum depth, number of fields, recursion limits) during schema validation in the Backend API. Reject schemas that exceed these limits.
        * **Resource Limits (Engine Level):**  Implement resource limits (memory, CPU, time) for data generation processes within the engine. Use process isolation or containerization to limit resource consumption.
        * **Asynchronous Processing:** Consider asynchronous processing for data generation to prevent blocking the API and improve responsiveness, which can also help mitigate some DoS risks.
* **`bogus` Library Vulnerabilities:**
    * **Mitigation:**
        * **Library Version Pinning:** Pin the specific version of the `bogus` library (and other data generation libraries) in `requirements.txt` to ensure consistent deployments.
        * **Regular Updates & Vulnerability Monitoring:** Regularly check for security updates and vulnerabilities in the `bogus` library and other dependencies. Subscribe to security mailing lists or use vulnerability scanning tools to monitor for updates. Update libraries promptly when security patches are released.
* **Data Provider Security (If External Data Sources are Used - Future Consideration):**
    * **Mitigation (If Implemented):**
        * **Secure Data Source Access:** If external data sources are used, ensure secure access (HTTPS, API keys managed securely, etc.).
        * **Data Validation from External Sources:** Validate and sanitize data retrieved from external sources before using it in data generation to prevent injection or data integrity issues.
        * **Data Privacy & Compliance:** Be mindful of data privacy and compliance regulations if using external data sources, especially if they contain personal or sensitive information.

**4.4 Data Storage (Optional - Caching/Configuration) - Security Considerations & Mitigations:**

* **Unauthorized Access:**
    * **Mitigation:**
        * **Access Control:** Implement strict access control to the data storage component. Only the Backend API should have access. Use database authentication and authorization mechanisms to restrict access. For file-based storage, use file system permissions.
        * **Network Segmentation:** Ensure the data storage component resides in the internal network, isolated from direct internet access.
* **Data Breach:**
    * **Mitigation:**
        * **Data Encryption at Rest:** If sensitive data (user schemas, API keys, potentially cached data) is stored, consider encrypting the data at rest using database encryption features or file system encryption.
        * **Data Encryption in Transit:** Ensure data in transit between the Backend API and data storage is encrypted (e.g., using TLS/SSL for database connections).
* **Data Integrity Issues & Indirect Injection:**
    * **Mitigation:**
        * **Data Validation on Retrieval:** When retrieving data from storage (schemas, cached data), re-validate and sanitize the data before using it in the application to prevent data integrity issues or injection attacks.
        * **Input Sanitization Before Storage:** Sanitize user input before storing it in the data storage to prevent stored XSS or other injection vulnerabilities if the stored data is later displayed or processed without proper encoding.

### 5. Actionable and Tailored Mitigation Strategies Summary

| Component          | Threat                                  | Mitigation Strategy                                                                                                                                                                                                                                                           | Actionable Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   