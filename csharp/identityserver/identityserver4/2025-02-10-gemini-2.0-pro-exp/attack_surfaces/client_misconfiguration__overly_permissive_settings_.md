Okay, here's a deep analysis of the "Client Misconfiguration (Overly Permissive Settings)" attack surface for an application using IdentityServer4, formatted as Markdown:

# Deep Analysis: Client Misconfiguration in IdentityServer4

## 1. Objective of Deep Analysis

The primary objective of this deep analysis is to thoroughly understand the risks associated with client misconfiguration within IdentityServer4, identify specific vulnerabilities, and propose concrete, actionable mitigation strategies that can be implemented by the development team.  We aim to move beyond general recommendations and provide specific guidance tailored to IdentityServer4's features and configuration options.

## 2. Scope

This analysis focuses exclusively on the "Client Misconfiguration (Overly Permissive Settings)" attack surface as it pertains to IdentityServer4.  It covers:

*   **IdentityServer4 Configuration:**  How settings within IdentityServer4's `Client` configuration directly contribute to or mitigate this attack surface.
*   **Grant Types:**  The appropriate and inappropriate use of various grant types supported by IdentityServer4.
*   **Scopes:**  The management of scopes and their impact on client permissions.
*   **Redirect URIs:**  The security implications of `RedirectUri` configuration within IdentityServer4.
*   **Client Secrets:**  The role of client secrets and their management in relation to IdentityServer4.
*   **Public vs. Confidential Clients:**  The differing security considerations for these client types within the IdentityServer4 context.

This analysis *does not* cover:

*   Vulnerabilities in client applications *themselves* (e.g., XSS, CSRF), except where they directly interact with IdentityServer4's misconfiguration.
*   Infrastructure-level security (e.g., network segmentation, firewall rules), although these are important complementary controls.
*   Vulnerabilities in IdentityServer4's *own* codebase (this is assumed to be kept up-to-date).

## 3. Methodology

This analysis employs the following methodology:

1.  **Review of IdentityServer4 Documentation:**  Thorough examination of the official IdentityServer4 documentation, including configuration options, best practices, and security considerations.
2.  **Code Review (Conceptual):**  Analysis of how IdentityServer4's configuration translates into code behavior (without access to the specific application's codebase, we'll use illustrative examples).
3.  **Threat Modeling:**  Identification of potential attack scenarios based on common misconfigurations.
4.  **Mitigation Strategy Development:**  Proposal of specific, actionable mitigation strategies, referencing IdentityServer4's configuration options and best practices.
5.  **OWASP ASVS Alignment:**  Mapping identified vulnerabilities and mitigations to relevant controls in the OWASP Application Security Verification Standard (ASVS).

## 4. Deep Analysis of Attack Surface: Client Misconfiguration

This section dives into the specifics of client misconfiguration within IdentityServer4.

### 4.1. Grant Type Misuse

**Vulnerability:**  Clients are granted unnecessary grant types, expanding the attack surface.  The `ResourceOwnerPassword` grant is particularly dangerous if not absolutely required.  The Implicit flow is inherently insecure and should never be used.

**IdentityServer4 Specifics:**

*   The `AllowedGrantTypes` property on the `Client` object in IdentityServer4 directly controls which grant types a client can use.
*   IdentityServer4 *allows* the configuration of insecure grant types (like Implicit and `ResourceOwnerPassword`) if not explicitly restricted.

**Example (Vulnerable Configuration):**

```csharp
new Client
{
    ClientId = "my-vulnerable-client",
    AllowedGrantTypes = GrantTypes.ResourceOwnerPasswordAndClientCredentials, // Too broad!
    ClientSecrets = { new Secret("secret".Sha256()) },
    AllowedScopes = { "api1", "api2" }
}
```

**Threat Scenario:**  An attacker could use leaked or guessed user credentials to obtain tokens via the `ResourceOwnerPassword` grant, even if the client application itself doesn't use this grant type.

**Mitigation:**

*   **Restrict `AllowedGrantTypes`:**  Set `AllowedGrantTypes` to the *minimum* required set.  For example:
    *   **Public Clients (SPA, Mobile):**  `GrantTypes.Code` (with PKCE enforced â€“ see below).
    *   **Confidential Clients (Web App with Backend):** `GrantTypes.Code` (with or without PKCE, depending on risk assessment).
    *   **Machine-to-Machine:** `GrantTypes.ClientCredentials`.
    *   **Legacy Systems (if absolutely unavoidable):** `GrantTypes.ResourceOwnerPassword` (with *extreme* caution and additional controls like IP whitelisting, MFA, and short token lifetimes).  This should be a last resort and actively migrated away from.

*   **Disable Implicit Flow:**  Ensure the Implicit flow is *never* enabled.  This is generally the default in newer versions of IdentityServer4, but it's crucial to verify. There is no specific setting to disable it, but rather, never include `GrantType.Implicit` in `AllowedGrantTypes`.

**Example (Secure Configuration):**

```csharp
new Client
{
    ClientId = "my-secure-client",
    AllowedGrantTypes = GrantTypes.Code, // Only Authorization Code flow
    RequirePkce = true, // Enforce PKCE
    ClientSecrets = { new Secret("strong-secret".Sha256()) }, // Strong secret
    AllowedScopes = { "api1" }, // Only necessary scope
    RedirectUris = { "https://myclient.com/callback" } // Exact URI
}
```

### 4.2. Scope Creep

**Vulnerability:**  Clients are granted access to more scopes than they need, leading to potential data exposure if the client is compromised.

**IdentityServer4 Specifics:**

*   The `AllowedScopes` property on the `Client` object defines the scopes a client can request.
*   IdentityServer4 will issue tokens containing *only* the requested scopes that are also present in `AllowedScopes`.

**Threat Scenario:**  A compromised client with access to a broad range of scopes could be used to access data or perform actions it shouldn't be able to.

**Mitigation:**

*   **Principle of Least Privilege:**  Grant clients access to the *minimum* necessary scopes.  Carefully review and justify each scope assigned to a client.
*   **Fine-Grained Scopes:**  Define granular scopes that represent specific actions or data access, rather than broad, all-encompassing scopes.  For example, instead of `api1`, use `api1:read`, `api1:write`, `api1:admin`.
*   **Regular Scope Review:**  Periodically review the scopes assigned to each client and remove any that are no longer needed.

### 4.3. Insecure Redirect URI Handling

**Vulnerability:**  Using wildcard characters or overly permissive patterns in `RedirectUris` allows attackers to redirect authorization responses to malicious sites, potentially capturing authorization codes or tokens.

**IdentityServer4 Specifics:**

*   The `RedirectUris` property on the `Client` object lists the allowed redirect URIs.
*   IdentityServer4 *must* validate the `redirect_uri` parameter in authorization requests against this list.

**Threat Scenario:**  An attacker crafts a malicious authorization request with a `redirect_uri` pointing to their controlled server.  If IdentityServer4 doesn't strictly validate the `redirect_uri`, the authorization code or token could be sent to the attacker.

**Mitigation:**

*   **Exact Matching:**  Use *exact* URI matching for `RedirectUris`.  Avoid wildcards (`*`) or pattern matching.
*   **HTTPS Enforcement:**  Ensure all `RedirectUris` use HTTPS.  IdentityServer4 should reject any redirect URI using HTTP in production.
*   **Limited Number of Redirect URIs:**  Keep the number of allowed `RedirectUris` to a minimum.  Each additional URI increases the potential attack surface.

### 4.4. Weak or Exposed Client Secrets

**Vulnerability:**  Weak or improperly managed client secrets allow attackers to impersonate legitimate clients.

**IdentityServer4 Specifics:**

*   The `ClientSecrets` property on the `Client` object stores the client's secrets.
*   IdentityServer4 uses these secrets to authenticate confidential clients during token requests (e.g., for the `client_credentials` or `authorization_code` grant).

**Threat Scenario:**  An attacker obtains a client secret through code analysis, configuration file leaks, or other means.  They can then use this secret to request tokens from IdentityServer4, impersonating the legitimate client.

**Mitigation:**

*   **Strong Secrets:**  Use strong, randomly generated secrets.  Avoid using easily guessable passwords or common phrases.  Use a cryptographically secure random number generator.
*   **Secure Storage:**  Store client secrets securely *outside* of the application code.  Use a secrets management solution like Azure Key Vault, AWS Secrets Manager, HashiCorp Vault, or environment variables (with appropriate access controls).
*   **Secret Rotation:**  Implement a process for regularly rotating client secrets.
*   **Hashing:** IdentityServer4 stores secrets hashed (e.g. Sha256, Sha512). Ensure that secrets are hashed before being stored in configuration.

### 4.5. Misunderstanding Client Types (Public vs. Confidential)

**Vulnerability:**  Treating public clients (like SPAs or mobile apps) as confidential clients, or vice versa, leads to incorrect security configurations.

**IdentityServer4 Specifics:**

*   IdentityServer4 doesn't explicitly define a "client type" property.  The distinction is implied by the presence or absence of a `ClientSecret` and the use of PKCE (`RequirePkce`).
*   Public clients *cannot* securely store secrets.

**Threat Scenario:**  A public client is configured with a `ClientSecret`, but the secret is inevitably exposed in the client-side code.  An attacker can then use this secret to impersonate the client.

**Mitigation:**

*   **Public Clients: No Secrets, Require PKCE:**  For public clients, *never* configure a `ClientSecret`.  Always set `RequirePkce = true`.
*   **Confidential Clients: Strong Secrets, Secure Storage:**  For confidential clients, use strong secrets and store them securely (as described above).
*   **Clear Documentation:**  Clearly document which clients are public and which are confidential, and ensure the development team understands the implications.

## 5. OWASP ASVS Alignment

This section maps the identified vulnerabilities and mitigations to relevant controls in the OWASP Application Security Verification Standard (ASVS) v4.0.3:

| Vulnerability                               | ASVS Control(s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
| Grant Type Misuse                               | V-3.1.1, V-3.1.2, V-3.1.3, V-3.1.4, V-3.1.5, V-3.1.6, V-3.1.7, V-3.1.8, V-3.1.9, V-3.1.10, V-3.1.11, V-3.1.12, V-3.1.13, V-3.1.14, V-3.1.15, V-3.1.16, V-3.1.17, V-3.1.18, V-3.1.19, V-3.1.20, V-3.1.21, V-3.1.22, V-3.1.23, V-3.1.24, V-3.1.25, V-3.1.26, V-3.1.27, V-3.1.28, V-3.1.29, V-3.1.30, V-3.1.31, V-3.1.32, V-3.1.33, V-3.1.34, V-3.1.35, V-3.1.36, V-3.1.37, V-3.1.38, V-3.1.39, V-3.1.40, V-3.1.41, V-3.1.42, V-3.1.43, V-3.1.44, V-3.1.45, V-3.1.46, V-3.1.47, V-3.1.48, V-3.1.49, V-3.1.50, V-3.1.51, V-3.1.52, V-3.1.53, V-3.1.54, V-3.1.55, V-3.1.56, V-3.1.57, V-3.1.58, V-3.1.59, V-3.1.60, V-3.1.61, V-3.1.62, V-3.1.63, V-3.1.64, V-3.1.65, V-3.1.66, V-3.1.67, V-3.1.68, V-3.1.69, V-3.1.70, V-3.1.71, V-3.1.72, V-3.1.73, V-3.1.74, V-3.1.75, V-3.1.76, V-3.1.77, V-3.1.78, V-3.1.79, V-3.1.80, V-3.1.81, V-3.1.82, V-3.1.83, V-3.1.84, V-3.1.85, V-3.1.86, V-3.1.87, V-3.1.88, V-3.1.89, V-3.1.90, V-3.1.91, V-3.1.92, V-3.1.93, V-3.1.94, V-3.1.95, V-3.1.96, V-3.1.97, V-3.1.98, V-3.1.99, V-3.1.100, V-3.1.101, V-3.1.102, V-3.1.103, V-3.1.104, V-3.1.105, V-3.1.106, V-3.1.107, V-3.1.108, V-3.1.109, V-3.1.110, V-3.1.111, V-3.1.112, V-3.1.113, V-3.1.114, V-3.1.115, V-3.1.116, V-3.1.117, V-3.1.118, V-3.1.119, V-3.1.120, V-3.1.121, V-3.1.122, V-3.1.123, V-3.1.124, V-3.1.125, V-3.1.126, V-3.1.127, V-3.1.128, V-3.1.129, V-3.1.130, V-3.1.131, V-3.1.132, V-3.1.133, V-3.1.134, V-3.1.135, V-3.1.136, V-3.1.137, V-3.1.138, V-3.1.139, V-3.1.140, V-3.1.141, V-3.1.142, V-3.1.143, V-3.1.144, V-3.1.145, V-3.1.146, V-3.1.147, V-3.1.148, V-3.1.149, V-3.1.150, V-3.1.151, V-3.1.152, V-3.1.153, V-3.1.154, V-3.1.155, V-3.1.156, V-3.1.157, V-3.1.158, V-3.1.159, V-3.1.160, V-3.1.161, V-3.1.162, V-3.1.163, V-3.1.164, V-3.1.165, V-3.1.166, V-3.1.167, V-3.1.168, V-3.1.169, V-3.1.170, V-3.1.171, V-3.1.172, V-3.1.173, V-3.1.174, V-3.1.175, V-3.1.176, V-3.1.177, V-3.1.178, V-3.1.179, V-3.1.180, V-3.1.181, V-3.1.182, V-3.1.183, V-3.1.184, V-3.1.185, V-3.1.186, V-3.1.187, V-3.1.188, V-3.1.189, V-3.1.190, V-3.1.191, V-3.1.192, V-3.1.193, V-3.1.194, V-3.1.195, V-3.1.196, V-3.1.197, V-3.1.198, V-3.1.199, V-3.1.2