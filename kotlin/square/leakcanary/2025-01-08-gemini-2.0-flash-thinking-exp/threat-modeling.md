# Threat Model Analysis for square/leakcanary

## Threat: [Exposure of Sensitive Data in Leak Dumps](./threats/exposure_of_sensitive_data_in_leak_dumps.md)

* **Threat:** Exposure of Sensitive Data in Leak Dumps
    * **Description:** An attacker gains access to the device's storage (e.g., through malware or physical access) and retrieves the heap dump files *generated by LeakCanary*. They then analyze these dumps to extract sensitive information that was present in the application's memory at the time of the leak. This could include user credentials, API keys, personal data, or other confidential information.
    * **Impact:**  Compromise of user accounts, unauthorized access to services, identity theft, financial loss, violation of privacy regulations.
    * **Affected Component:** `HeapDump`, `DefaultOnHeapAnalyzedListener` (responsible for triggering dump creation), storage mechanisms used by LeakCanary.
    * **Risk Severity:** High
    * **Mitigation Strategies:**
        * Ensure LeakCanary is disabled in release builds using build variants.
        * Utilize secure, app-specific storage for LeakCanary files.
        * Consider encrypting the leak dump files if persistent storage is unavoidable in debug builds.
        * Educate developers about the potential for sensitive data in memory.

## Threat: [Accidentally Shipping LeakCanary in Production Builds](./threats/accidentally_shipping_leakcanary_in_production_builds.md)

* **Threat:** Accidentally Shipping LeakCanary in Production Builds
    * **Description:** Developers might mistakenly include the *LeakCanary library* in production builds. This exposes the application to the risks mentioned above, particularly the potential for sensitive data exposure through leak dumps in a production environment where security is paramount.
    * **Impact:** Significant risk of sensitive data disclosure, performance overhead in production, potential for reverse engineering.
    * **Affected Component:** Entire LeakCanary library.
    * **Risk Severity:** High
    * **Mitigation Strategies:**
        * Utilize build variants in Android Studio to manage dependencies for debug and release builds separately.
        * Implement checks in the application's initialization code to ensure LeakCanary is not active in release builds.
        * Use ProGuard/R8 to strip out LeakCanary code from release builds.

## Threat: [Dependency Vulnerabilities in LeakCanary](./threats/dependency_vulnerabilities_in_leakcanary.md)

* **Threat:** Dependency Vulnerabilities in LeakCanary
    * **Description:** *LeakCanary*, like any software, relies on other libraries (dependencies). If these dependencies have known security vulnerabilities, an attacker could potentially exploit these vulnerabilities through the application that includes *LeakCanary*.
    * **Impact:** Range of impacts depending on the vulnerability in the dependency, potentially including remote code execution, data breaches, or denial of service.
    * **Affected Component:** LeakCanary's dependency management, potentially affecting various modules depending on the vulnerable dependency.
    * **Risk Severity:** Can be Critical to High depending on the vulnerability.
    * **Mitigation Strategies:**
        * Regularly update LeakCanary to the latest stable version, which includes updated dependencies.
        * Utilize dependency scanning tools to identify and address vulnerabilities in LeakCanary's dependencies.

