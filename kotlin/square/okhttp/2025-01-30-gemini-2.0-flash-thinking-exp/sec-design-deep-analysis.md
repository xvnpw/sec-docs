## Deep Security Analysis of OkHttp Library

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to provide a thorough evaluation of the security posture of the OkHttp library, focusing on its key components, architecture, and potential vulnerabilities. The objective is to identify security implications arising from the design and implementation of OkHttp, and to recommend actionable mitigation strategies to enhance its security and protect applications that rely on it. This analysis will be tailored to the specific context of the OkHttp library as an open-source HTTP client for Java and Android.

**Scope:**

The scope of this analysis encompasses the following:

*   **Key Components of OkHttp:**  Analysis will cover core components of OkHttp as inferred from the provided Security Design Review and publicly available documentation and source code (though direct source code review is not explicitly requested, inferences will be drawn from its documented features and design). This includes but is not limited to:
    *   Connection Management (Connection Pooling, Connection Establishment)
    *   Request and Response Handling (Interceptors, Call Execution)
    *   TLS/SSL Implementation (Handshake, Certificate Validation, Cipher Suites)
    *   Protocol Support (HTTP/1.1, HTTP/2, potentially HTTP/3)
    *   Input Validation (Header and Body Processing)
    *   Authentication Handling
*   **Architecture and Data Flow:**  Analysis will be based on the provided C4 diagrams (Context, Container, Deployment, Build) and descriptions to understand the architecture, component interactions, and data flow within OkHttp and its surrounding ecosystem.
*   **Security Requirements and Controls:**  Evaluation will consider the security requirements and controls outlined in the Security Design Review, assessing their adequacy and implementation within OkHttp.
*   **Identified Risks:**  Analysis will address the business and security risks highlighted in the Security Design Review, providing specific mitigation strategies.

**Methodology:**

This analysis will employ the following methodology:

1.  **Document Review:**  Thorough review of the provided Security Design Review document, including business posture, security posture, design diagrams, risk assessment, and questions/assumptions.
2.  **Architecture Inference:**  Inferring the internal architecture and component interactions of OkHttp based on the provided C4 diagrams, descriptions, and publicly available OkHttp documentation and conceptual understanding of HTTP client libraries.
3.  **Security Implication Analysis:**  For each key component and architectural aspect, analyze potential security implications, considering common HTTP client vulnerabilities and the specific context of OkHttp.
4.  **Threat Modeling (Implicit):**  While not explicitly requested, the analysis will implicitly perform threat modeling by considering potential attack vectors and vulnerabilities relevant to each component and function of OkHttp.
5.  **Mitigation Strategy Development:**  Based on the identified security implications, develop actionable and tailored mitigation strategies specific to OkHttp, focusing on practical recommendations for the development team and application developers using OkHttp.
6.  **Tailored Recommendations:** Ensure all recommendations are specific to OkHttp and avoid generic security advice. Recommendations will be actionable and directly applicable to the OkHttp project.

### 2. Security Implications of Key Components

Based on the Security Design Review and understanding of HTTP client libraries, the key components of OkHttp and their security implications are analyzed below:

**2.1. Connection Management (Connection Pooling & Establishment):**

*   **Component Description:** OkHttp employs connection pooling to reuse established connections for multiple requests to the same server, improving performance and reducing latency. Connection establishment involves socket creation, TLS handshake (for HTTPS), and connection setup.
*   **Security Implications:**
    *   **Connection Hijacking/Replay Attacks (Mitigation already in place via TLS):** If not properly secured, reused connections could potentially be hijacked or replayed. However, TLS encryption, a core feature of OkHttp, mitigates this risk by encrypting the communication channel.
    *   **Resource Exhaustion (DoS):**  Improperly managed connection pools could lead to resource exhaustion on either the client or server side if an attacker can manipulate connection creation or reuse.
    *   **Information Leakage through Connection Reuse:** If connections are not properly isolated between different application contexts or users (less relevant for a library, more for application usage), there's a theoretical risk of information leakage through reused connections, though highly unlikely in typical OkHttp usage scenarios.
*   **Specific Security Considerations for OkHttp:**
    *   **Robustness of Connection Pooling Logic:** Ensure the connection pooling logic is robust against malicious servers attempting to manipulate connection state or cause resource exhaustion.
    *   **Secure Socket Factory Configuration:**  The `SSLSocketFactory` used for connection establishment must be configured securely to enforce strong cipher suites and protocols.

**2.2. Request and Response Handling (Interceptors & Call Execution):**

*   **Component Description:** OkHttp uses interceptors to modify requests and responses, allowing for cross-cutting concerns like logging, caching, and authentication. Call execution is the core process of sending a request and receiving a response.
*   **Security Implications:**
    *   **Interceptor Vulnerabilities:**  If interceptors are not carefully designed and implemented, they could introduce vulnerabilities. For example, a poorly written interceptor could expose sensitive data in logs or modify requests in unintended ways.
    *   **Request Smuggling/Splitting:**  Vulnerabilities in request parsing or handling could potentially lead to request smuggling or splitting attacks if OkHttp incorrectly interprets HTTP requests, although OkHttp is designed to prevent this.
    *   **Response Header/Body Injection:**  If response headers or bodies are not properly validated and handled, vulnerabilities like header injection or body injection could arise, especially if applications directly process raw response data without using OkHttp's parsing capabilities.
    *   **Denial of Service through Malformed Responses:**  Malformed or excessively large responses from malicious servers could lead to parsing errors, resource exhaustion, or denial-of-service if OkHttp's response handling is not robust.
*   **Specific Security Considerations for OkHttp:**
    *   **Security of Default Interceptors:** Ensure any default interceptors provided by OkHttp are secure and do not introduce vulnerabilities.
    *   **Guidance for Developers on Secure Interceptor Implementation:** Provide clear guidance to application developers on how to write secure interceptors and avoid common pitfalls.
    *   **Robust Response Parsing and Validation:**  Implement robust parsing and validation of HTTP response headers and bodies to prevent injection attacks and DoS.

**2.3. TLS/SSL Implementation (Handshake, Certificate Validation, Cipher Suites):**

*   **Component Description:** OkHttp relies on the underlying Java/Android platform's TLS/SSL implementation for encrypted communication. It provides APIs to configure TLS settings, including cipher suites, protocols, and certificate validation.
*   **Security Implications:**
    *   **Weak TLS Configuration:**  Misconfiguration of TLS settings, such as using weak cipher suites or disabling certificate validation, can severely weaken security and expose communication to eavesdropping or man-in-the-middle attacks.
    *   **Vulnerabilities in Underlying TLS Implementation:**  OkHttp is dependent on the security of the underlying Java/Android TLS implementation. Vulnerabilities in these platform libraries could indirectly affect OkHttp's security.
    *   **Certificate Pinning Misconfiguration:**  While certificate pinning enhances security, incorrect implementation or misconfiguration can lead to application failures or bypass security checks.
    *   **Protocol Downgrade Attacks:**  If not properly configured, OkHttp might be susceptible to protocol downgrade attacks, where an attacker forces the use of older, less secure TLS protocols.
*   **Specific Security Considerations for OkHttp:**
    *   **Secure Defaults for TLS Configuration:**  Provide secure default TLS configurations that prioritize strong cipher suites and protocols.
    *   **Clear Documentation and Guidance on TLS Configuration:**  Provide comprehensive documentation and guidance to developers on how to securely configure TLS settings in OkHttp, including certificate pinning.
    *   **Regularly Update TLS Dependencies:**  Ensure OkHttp is compatible with and benefits from updates to the underlying Java/Android TLS implementations to address known vulnerabilities.

**2.4. Protocol Support (HTTP/1.1, HTTP/2, potentially HTTP/3):**

*   **Component Description:** OkHttp supports modern HTTP protocols like HTTP/2, offering performance improvements and new features compared to HTTP/1.1. Future support for HTTP/3 is likely.
*   **Security Implications:**
    *   **Protocol-Specific Vulnerabilities:**  Each HTTP protocol version may have its own set of vulnerabilities. For example, HTTP/2 has known vulnerabilities related to stream multiplexing and header compression (though mitigations exist).
    *   **Downgrade Attacks (Protocol Downgrade):**  Attackers might attempt to force a downgrade to older, potentially less secure HTTP protocols if not properly handled.
    *   **Complexity and Attack Surface:**  Supporting multiple protocols increases the complexity of the codebase and potentially expands the attack surface if vulnerabilities are introduced in protocol-specific handling logic.
*   **Specific Security Considerations for OkHttp:**
    *   **Security Analysis of Protocol Implementations:**  Conduct thorough security analysis of the implementation of each supported HTTP protocol to identify and mitigate protocol-specific vulnerabilities.
    *   **Robust Protocol Negotiation:**  Implement robust protocol negotiation mechanisms to prevent downgrade attacks and ensure the use of the most secure protocol supported by both client and server.
    *   **Stay Updated on Protocol Security Best Practices:**  Continuously monitor and adapt to evolving security best practices for each supported HTTP protocol.

**2.5. Input Validation (Header and Body Processing):**

*   **Component Description:** OkHttp performs input validation on HTTP response headers and bodies to prevent common vulnerabilities. This includes parsing and sanitizing data received from web servers.
*   **Security Implications:**
    *   **Insufficient Input Validation:**  If input validation is insufficient or incomplete, vulnerabilities like header injection, body injection, or cross-site scripting (if responses are rendered in a web context, less relevant for OkHttp itself but for applications using it) could arise.
    *   **Parsing Vulnerabilities:**  Vulnerabilities in the parsing logic for headers or body content could lead to denial-of-service or other unexpected behavior when processing malformed or malicious responses.
    *   **Bypass of Validation:**  Attackers might attempt to bypass input validation mechanisms if they are not robust or if there are logical flaws in the validation process.
*   **Specific Security Considerations for OkHttp:**
    *   **Comprehensive Input Validation Rules:**  Implement comprehensive input validation rules for all relevant parts of HTTP responses, including headers and body content.
    *   **Secure Parsing Libraries:**  Use secure and well-vetted parsing libraries for HTTP data.
    *   **Regularly Review and Update Validation Logic:**  Regularly review and update input validation logic to address new attack vectors and vulnerabilities.

**2.6. Authentication Handling:**

*   **Component Description:** OkHttp supports standard HTTP authentication schemes (Basic, Digest, Bearer Token) and allows applications to integrate custom authentication mechanisms.
*   **Security Implications:**
    *   **Insecure Credential Handling:**  If authentication credentials are not handled securely within OkHttp or by applications using it, they could be exposed or compromised.  OkHttp itself should not store credentials in plaintext.
    *   **Authentication Bypass:**  Vulnerabilities in authentication handling logic could potentially allow attackers to bypass authentication mechanisms.
    *   **Man-in-the-Middle Attacks on Authentication:**  If authentication is not performed over HTTPS, credentials could be intercepted in transit. OkHttp's TLS support mitigates this when used correctly.
    *   **Session Hijacking (related to authentication):**  If session management (though not directly OkHttp's responsibility) is not secure in applications using OkHttp, session hijacking could occur.
*   **Specific Security Considerations for OkHttp:**
    *   **Secure Credential Passing:** Ensure OkHttp provides mechanisms for securely passing authentication credentials without storing them in plaintext within the library.
    *   **Guidance on Secure Authentication Integration:**  Provide clear guidance to developers on how to securely integrate authentication mechanisms with OkHttp, emphasizing the importance of HTTPS and secure credential management in applications.
    *   **Support for Modern Authentication Methods:**  Consider supporting modern and more secure authentication methods as they emerge.

### 3. Architecture, Components, and Data Flow (Inferred from Design Review)

Based on the C4 diagrams and descriptions, the architecture and data flow can be summarized as follows:

*   **Architecture:** OkHttp is designed as a Java/Kotlin library that acts as an HTTP client. It is integrated into application code and interacts with the network interface of the operating system to communicate with web servers/APIs. The architecture is layered, with clear separation between application code, OkHttp library, and the underlying network infrastructure. The build process involves standard CI/CD practices, ensuring code integrity and artifact distribution.
*   **Components (as per C4 diagrams):**
    *   **OkHttp Library:** The core component, responsible for HTTP client functionality.
    *   **Application Code:**  Uses OkHttp API to make HTTP requests.
    *   **Network Interface:** OS-level interface for network communication.
    *   **Web Server / API:** External systems OkHttp communicates with.
    *   **Developer IDE, Build Server, Application Runtime, Operating System, Source Code Repository, CI/CD System, Artifact Repository:**  Supporting infrastructure for development, build, deployment, and execution of applications using OkHttp.
*   **Data Flow:**
    1.  **Request Initiation:** Application Code uses OkHttp API to create and initiate an HTTP request.
    2.  **Request Processing (OkHttp):** OkHttp processes the request, potentially applying interceptors, handling connection pooling, and preparing the request for network transmission.
    3.  **Network Transmission:** OkHttp uses the Network Interface to send the HTTP request over the network to the Web Server/API.
    4.  **Response Reception:** OkHttp receives the HTTP response from the Web Server/API through the Network Interface.
    5.  **Response Processing (OkHttp):** OkHttp processes the response, performing input validation, applying interceptors, and parsing the response data.
    6.  **Response Delivery:** OkHttp delivers the processed HTTP response back to the Application Code.

### 4. Tailored Security Considerations and Recommendations for OkHttp

Based on the analysis, here are tailored security considerations and recommendations for the OkHttp project:

**4.1. Enhance Automated Security Testing:**

*   **Recommendation:** Integrate **DAST (Dynamic Application Security Testing)** into the CI/CD pipeline in addition to SAST. DAST can help identify runtime vulnerabilities that SAST might miss, especially in areas like protocol handling and response processing. Consider using tools that can fuzz HTTP endpoints and analyze OkHttp's behavior under various malicious inputs.
*   **Actionable Mitigation:** Implement a DAST step in the CI/CD pipeline that automatically tests OkHttp's resilience against a range of HTTP attacks (e.g., header injection, request smuggling, malformed responses).

**4.2. Strengthen Input Validation and Error Handling:**

*   **Recommendation:**  Conduct a **focused security code review** specifically on the input validation and error handling logic within OkHttp, particularly in response header and body parsing. Ensure validation is comprehensive and error handling is robust to prevent DoS and information leakage.
*   **Actionable Mitigation:**
    *   Develop and maintain a comprehensive suite of **negative test cases** that specifically target input validation vulnerabilities (e.g., oversized headers, malformed bodies, invalid characters in headers).
    *   Implement **rate limiting or resource quotas** for processing HTTP responses to mitigate potential DoS attacks from excessively large or malformed responses.

**4.3. Improve Guidance on Secure Configuration and Usage for Developers:**

*   **Recommendation:**  Create a dedicated **"Security Best Practices" section in the OkHttp documentation** that provides clear and actionable guidance for application developers on how to use OkHttp securely. This should include:
    *   Best practices for TLS configuration (cipher suites, protocols, certificate validation, certificate pinning).
    *   Guidance on writing secure interceptors and avoiding common pitfalls.
    *   Recommendations for secure handling of authentication credentials when using OkHttp.
    *   Examples of common security misconfigurations to avoid.
*   **Actionable Mitigation:**
    *   Develop **example code snippets and configuration templates** demonstrating secure OkHttp usage for common scenarios (e.g., TLS configuration with certificate pinning, secure authentication).
    *   Consider providing a **"security hardening" guide** specifically for OkHttp, outlining steps developers can take to maximize the security of their OkHttp configurations.

**4.4. Enhance Dependency Management and Vulnerability Monitoring:**

*   **Recommendation:**  Implement **automated dependency scanning** in the CI/CD pipeline to continuously monitor OkHttp's dependencies for known vulnerabilities.  Go beyond just updating dependencies regularly; proactively monitor security advisories and assess the impact of vulnerabilities in dependencies on OkHttp.
*   **Actionable Mitigation:**
    *   Integrate a dependency scanning tool (e.g., OWASP Dependency-Check, Snyk) into the CI/CD pipeline to automatically identify vulnerable dependencies.
    *   Establish a process for **promptly addressing and patching** any identified vulnerabilities in OkHttp's dependencies.

**4.5. Formalize Security Review Process:**

*   **Recommendation:**  Establish a **formal security review process** for all significant code changes in OkHttp. This should involve experienced security engineers reviewing code for potential security flaws before it is merged into the main branch.
*   **Actionable Mitigation:**
    *   Define clear **security review guidelines and checklists** for code reviewers.
    *   Ensure that security reviews are **documented and tracked** as part of the development process.
    *   Consider engaging **external security experts** for periodic security audits and penetration testing of OkHttp.

**4.6. Public Vulnerability Disclosure Policy and Process:**

*   **Recommendation:**  Clearly define and **publicly document a vulnerability disclosure policy and process** for OkHttp. This should outline how security researchers and users can report vulnerabilities, expected response times, and the process for disclosing and patching vulnerabilities.
*   **Actionable Mitigation:**
    *   Create a dedicated **security policy page** on the OkHttp project website or repository.
    *   Establish a **secure communication channel** (e.g., security@okhttp.org or a dedicated security issue tracker) for reporting vulnerabilities.
    *   Define a **timeline for responding to and addressing** reported vulnerabilities.

### 5. Actionable and Tailored Mitigation Strategies Applicable to Identified Threats

The following table summarizes actionable and tailored mitigation strategies for identified threats, focusing on OkHttp:

| Threat Category                     | Specific Threat                                     | Actionable Mitigation Strategy for OkHttp                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          