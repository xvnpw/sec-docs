## Deep Security Analysis of Mavericks Android Framework

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to thoroughly evaluate the security posture of the Mavericks Android framework, developed by Airbnb, by examining its design, architecture, and development lifecycle. The primary objective is to identify potential security vulnerabilities and risks inherent in the framework itself and in applications built using Mavericks. This analysis will focus on understanding the framework's key components, their interactions, and the potential attack vectors introduced or mitigated by Mavericks.  Ultimately, this analysis will provide actionable, framework-specific security recommendations and mitigation strategies to enhance the overall security of Mavericks and applications leveraging it.

**Scope:**

This analysis encompasses the following aspects of the Mavericks framework, based on the provided Security Design Review:

* **Architecture and Components:** Analyzing the C4 Context, Container, Deployment, and Build diagrams to understand the framework's architecture, key components (Mavericks Core Library, UI Components), and their interactions within the Android application ecosystem.
* **Data Flow (Inferred):**  Tracing the flow of code, dependencies, build artifacts, and application data within the Mavericks framework and applications built upon it, focusing on potential security implications at each stage.
* **Security Posture and Controls:** Evaluating the existing and recommended security controls outlined in the Security Design Review, assessing their effectiveness and identifying gaps.
* **Security Requirements:** Examining the defined security requirements (Input Validation, Cryptography) and their relevance to the Mavericks framework.
* **Risk Assessment:** Considering the identified business and security risks associated with Mavericks, and how the framework design might contribute to or mitigate these risks.
* **Build and Deployment Processes:** Analyzing the assumed GitHub Actions based build process and the deployment pipeline to Google Play Store for potential security vulnerabilities.

This analysis will **not** cover:

* **In-depth code review of the Mavericks codebase.** This analysis is based on the design review document and inferred architecture.
* **Security analysis of specific Airbnb Android applications built with Mavericks.** The focus is on the framework itself.
* **General Android security best practices.** The recommendations will be tailored to Mavericks framework.
* **Performance analysis or non-security related aspects of Mavericks.**

**Methodology:**

This analysis will employ the following methodology:

1. **Document Review:**  Thorough review of the provided Security Design Review document, including business posture, security posture, design diagrams (C4 Context, Container, Deployment, Build), risk assessment, questions, and assumptions.
2. **Architecture and Component Inference:** Based on the C4 diagrams and descriptions, infer the architecture, key components, and data flow of the Mavericks framework.
3. **Threat Modeling (Lightweight):**  Identify potential threats and vulnerabilities associated with each key component and data flow, considering common Android security risks and framework-specific concerns.
4. **Security Control Mapping:** Map the existing and recommended security controls to the identified threats and components to assess their coverage and effectiveness.
5. **Gap Analysis:** Identify security gaps and areas for improvement based on the threat modeling and security control mapping.
6. **Tailored Recommendation Generation:** Develop specific, actionable, and Mavericks-focused security recommendations and mitigation strategies to address the identified threats and gaps.
7. **Documentation and Reporting:**  Document the analysis process, findings, recommendations, and mitigation strategies in a structured report.

### 2. Security Implications of Key Components

Based on the Security Design Review and inferred architecture, the key components of Mavericks and their security implications are analyzed below:

**a) Mavericks Core Library:**

* **Component Description:** The heart of the framework, providing reactive primitives, state management, and UI component building blocks. It abstracts away Android framework complexities and manages the reactive data flow.
* **Security Implications:**
    * **Framework Vulnerabilities:**  Bugs or vulnerabilities within the Core Library could be inherited by all applications using Mavericks. This is a high-impact risk as a single vulnerability could affect many applications. Examples include:
        * **State Management Flaws:** Incorrect state management logic could lead to data leaks, unauthorized access, or denial of service if an attacker can manipulate the application state.
        * **Reactive Primitives Vulnerabilities:**  If the reactive primitives (e.g., streams, observables) are not implemented securely, they could be susceptible to injection attacks or resource exhaustion.
        * **Logic Errors:**  Flaws in the core logic of the framework could lead to unexpected behavior and potential security vulnerabilities in applications.
    * **Dependency Vulnerabilities:** The Core Library relies on external libraries. Vulnerabilities in these dependencies could be exploited if not properly managed and updated.
    * **Complexity and Maintainability:**  A complex Core Library might be harder to audit and maintain, potentially leading to overlooked vulnerabilities over time.

**b) UI Components:**

* **Component Description:** Reusable UI elements built using Mavericks, forming the user interface of Android applications. They handle UI rendering, user interactions, and data display.
* **Security Implications:**
    * **Input Handling Vulnerabilities:** UI Components are often the entry point for user input. Improper input validation within these components could lead to vulnerabilities like:
        * **Injection Attacks (though less common in typical Android UI):**  While SQL injection is less direct in UI components, vulnerabilities could arise if UI components directly construct queries or commands based on user input without proper sanitization (e.g., in custom data binding logic).
        * **Cross-Site Scripting (XSS) in WebViews (if used within UI Components):** If UI Components render web content using WebViews, vulnerabilities to XSS attacks are possible if user-controlled data is not properly sanitized before being displayed in the WebView.
        * **Denial of Service:**  Maliciously crafted input could crash the application or consume excessive resources if UI components are not robust in handling unexpected or large inputs.
    * **Data Binding Vulnerabilities:** If Mavericks uses data binding, vulnerabilities could arise if data binding expressions are not carefully constructed and sanitized, potentially leading to information disclosure or unintended code execution.
    * **UI Rendering Logic Flaws:**  Bugs in the UI rendering logic could lead to information leaks (e.g., displaying sensitive data in logs or UI elements unintentionally) or UI-based denial of service.

**c) Build Process (GitHub Actions):**

* **Component Description:** Automated build process using GitHub Actions to compile, test, and package the Mavericks framework.
* **Security Implications:**
    * **Supply Chain Vulnerabilities:** Compromise of the build environment or dependencies used in the build process could lead to malicious code injection into the Mavericks framework itself.
    * **Insecure Dependency Management:**  If dependency resolution is not secure, or if vulnerable dependencies are not identified and updated, the built framework could contain known vulnerabilities.
    * **Build Environment Compromise:**  If the GitHub Actions environment is compromised, attackers could modify the build process to inject malicious code or steal secrets.
    * **Insecure Artifact Storage:**  If build artifacts (JAR/AAR files) are not stored securely, they could be tampered with before distribution.
    * **Lack of Build Integrity Checks:**  Absence of integrity checks on build artifacts could allow for undetected tampering.

**d) Deployment Process (Google Play Store):**

* **Component Description:** Deployment of applications built with Mavericks through the Google Play Store.
* **Security Implications (Indirectly related to Mavericks framework itself, but important for applications using it):**
    * **Distribution Channel Compromise (Google Play Store is generally secure, but still a consideration):**  Although unlikely, a compromise of the Google Play Store distribution channel could lead to the distribution of tampered applications.
    * **Application Tampering Post-Deployment:**  While Google Play Store provides integrity checks, vulnerabilities in the application itself could potentially be exploited to tamper with the application after installation on a device. This is less directly related to Mavericks framework, but framework vulnerabilities could contribute to application-level vulnerabilities.

**e) Applications Built with Mavericks:**

* **Component Description:** Android applications developed by Airbnb and potentially external developers using the Mavericks framework.
* **Security Implications:**
    * **Inherited Framework Vulnerabilities:** Applications built with Mavericks are directly impacted by any vulnerabilities present in the Mavericks Core Library or UI Components.
    * **Misuse of Framework Features:** Developers might misuse Mavericks features in a way that introduces security vulnerabilities in their applications. For example, improper state management in application-specific code built on Mavericks could lead to security issues.
    * **Lack of Security Awareness:** Developers unfamiliar with Mavericks or reactive programming principles might unintentionally introduce vulnerabilities while using the framework.

### 3. Tailored Recommendations

Based on the identified security implications, here are tailored security recommendations for the Mavericks framework:

1. ** 강화된 Static Analysis Security Testing (SAST) with Framework-Specific Rules:**
    * **Recommendation:** Implement and regularly run SAST tools configured with rules specifically tailored to identify common vulnerabilities in reactive frameworks and Android development, focusing on state management, data binding, and reactive primitives.
    * **Rationale:** Generic SAST rules might miss framework-specific vulnerabilities. Tailored rules will improve detection accuracy and reduce false positives.
    * **Example:**  Rules to detect insecure data binding expressions, state management inconsistencies, or improper handling of reactive streams.

2. **Dynamic Analysis Security Testing (DAST) Focused on State and Reactive Flows:**
    * **Recommendation:** Implement DAST specifically designed to test the runtime behavior of applications built with Mavericks, focusing on state transitions, reactive data flows, and potential race conditions or timing vulnerabilities in reactive components.
    * **Rationale:** DAST can uncover vulnerabilities that are not apparent in static code analysis, especially those related to runtime state and interactions.
    * **Example:** DAST scenarios to test for state corruption, unauthorized state transitions, or vulnerabilities arising from asynchronous operations in reactive components.

3. **Framework-Specific Security Training for Developers:**
    * **Recommendation:** Develop and provide security training specifically for developers using Mavericks. This training should cover secure coding practices within the Mavericks framework, common pitfalls when using reactive programming in Android, and how to leverage Mavericks features securely.
    * **Rationale:**  General security training might not be sufficient for developers using a specific framework like Mavericks. Framework-specific training will equip developers with the knowledge to use Mavericks securely.
    * **Training Topics:** Secure state management in Mavericks, input validation in UI Components, secure data binding practices, common reactive programming security pitfalls in Android.

4. **Regular Security Audits by Experts with Reactive Framework Experience:**
    * **Recommendation:** Conduct periodic security audits of the Mavericks framework by internal or external security experts who have expertise in reactive frameworks and Android security.
    * **Rationale:**  Specialized expertise is needed to effectively audit the security of a complex framework like Mavericks. Experts with reactive framework experience can identify subtle vulnerabilities that general security auditors might miss.
    * **Audit Focus Areas:** Core Library logic, state management mechanisms, reactive primitives implementation, UI Component security, build process security.

5. **Automated Dependency Vulnerability Scanning and Management with Focus on Transitive Dependencies:**
    * **Recommendation:** Implement automated tools to continuously scan Mavericks' dependencies, including transitive dependencies, for known vulnerabilities. Establish a process for promptly updating vulnerable dependencies and verifying fixes.
    * **Rationale:** Dependency vulnerabilities are a significant risk. Automated scanning and proactive management are crucial for mitigating this risk. Transitive dependencies are often overlooked but can introduce vulnerabilities.
    * **Tool Integration:** Integrate dependency scanning into the build pipeline to prevent vulnerable dependencies from being included in releases.

6. **Input Validation Enforcement and Guidance within Mavericks:**
    * **Recommendation:**  Provide clear guidance and potentially framework-level mechanisms to encourage or enforce input validation within applications built using Mavericks, especially within UI Components and state management logic.
    * **Rationale:** Input validation is a fundamental security control. Mavericks can play a role in promoting and simplifying secure input handling for developers using the framework.
    * **Example Mechanisms:**  Provide utility functions or patterns within Mavericks to easily validate data within reactive components or UI Components. Document best practices for input validation in Mavericks applications.

7. **Vulnerability Disclosure Program and Clear Security Response Process:**
    * **Recommendation:** Establish a formal vulnerability disclosure program for Mavericks to allow security researchers and the community to report vulnerabilities responsibly. Define a clear process for triaging, patching, and communicating security vulnerabilities and updates.
    * **Rationale:** A vulnerability disclosure program facilitates responsible vulnerability reporting and allows for timely patching. A clear security response process ensures efficient handling of reported vulnerabilities.
    * **Program Elements:** Publicly accessible reporting mechanism, security contact point, defined SLA for response and patching, public communication of security advisories.

8. **Secure Build Pipeline Hardening and Integrity Checks:**
    * **Recommendation:** Harden the GitHub Actions build pipeline for Mavericks by applying security best practices for CI/CD pipelines. Implement integrity checks for build artifacts to ensure they have not been tampered with after build.
    * **Rationale:** A secure build pipeline is crucial for preventing supply chain attacks. Integrity checks ensure the trustworthiness of the built framework.
    * **Hardening Measures:** Principle of least privilege for build environment access, secure secret management, build environment isolation, audit logging of build activities.
    * **Integrity Checks:** Code signing of build artifacts, checksum generation and verification.

### 4. Actionable Mitigation Strategies

Here are actionable mitigation strategies applicable to the identified threats, tailored to Mavericks:

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             * **Framework Vulnerabilities in Core Library** | **Actionable Mitigation:**
    * **Implement Fuzz Testing:** Integrate fuzz testing into the CI/CD pipeline to automatically discover potential crashes and vulnerabilities in the Core Library's code, especially in state management and reactive primitives. Focus fuzzing efforts on edge cases and boundary conditions in state transitions and data handling.
    * **Establish Secure Coding Guidelines:** Create and enforce secure coding guidelines specifically for Mavericks development, focusing on reactive programming patterns, state management security, and common Android security best practices. Regularly update these guidelines based on new vulnerabilities and security research.

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         