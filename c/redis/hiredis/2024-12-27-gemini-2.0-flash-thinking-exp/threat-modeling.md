
## High and Critical Threats Directly Involving hiredis

| Threat | Description (Attacker Action & Method) | Impact | Affected hiredis Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Redis Command Injection** | An attacker manipulates user input or other data sources that are directly incorporated into Redis commands without proper sanitization. They might inject arbitrary commands to modify data, execute administrative tasks, or cause denial of service. | Data loss, data corruption, unauthorized access, potential for remote code execution on the Redis server (depending on Redis configuration). | `redisCommand`, `redisCommandArgv`, `redisvFormatCommand`, and related functions used for sending commands. | **Critical** | - **Use parameterized commands:** Utilize `redisCommand` with format specifiers (e.g., `redisCommand(c, "SET %s %s", key, value)`) to prevent injection. <br> - **Strict input validation and sanitization:** Validate and sanitize all user-provided input before including it in Redis commands. <br> - **Principle of least privilege:** Ensure the Redis user the application connects with has only the necessary permissions. Avoid granting access to dangerous commands like `FLUSHALL` or `CONFIG` unless absolutely necessary. |
| **Eavesdropping on Unencrypted Communication** | An attacker on the network intercepts the communication between the application and the Redis server when TLS is not used. They can read sensitive data being exchanged, including commands and data. | Exposure of sensitive data stored in Redis, including user credentials, application secrets, or business-critical information. | The underlying socket connection handled by `hiredis` (e.g., `redisConnect`, `redisConnectWithTimeout`). The lack of using `redisConnectTLS` or `redisConnectTLSWithTimeout` is the vulnerability in the `hiredis` usage. | **High** | - **Enable TLS encryption:** Configure both the Redis server and the `hiredis` client to use TLS for secure communication. This involves using `redisConnectTLS` or `redisConnectTLSWithTimeout`. <br> - **Secure network infrastructure:** Ensure the network between the application and Redis is properly secured. |
| **Exploiting `hiredis` Parsing Vulnerabilities** | An attacker sends specially crafted Redis responses that exploit vulnerabilities in `hiredis`'s parsing logic, potentially leading to crashes, memory corruption, or other unexpected behavior within the application. | Application crashes, denial of service, potential for memory corruption and further exploitation. | `redisReaderFeed`, `redisReaderGetReply`, and the internal parsing logic within `hiredis` that handles different response types. | **High** (if exploitable for code execution) to **Critical** (for severe memory corruption or RCE). | - **Keep `hiredis` updated:** Regularly update to the latest version of `hiredis` to benefit from bug fixes and security patches. <br> - **Consider using a more robust parsing library (if feasible and necessary for extreme security):** While `hiredis` is generally well-regarded, explore alternative Redis clients with different parsing implementations if facing high-risk scenarios. |
| **Abuse of Redis Administrative Commands** | An attacker gains control of the application and uses its `hiredis` connection to execute powerful Redis administrative commands (e.g., `CONFIG`, `SAVE`, `SHUTDOWN`) without proper authorization checks. | Complete compromise of the Redis server, data loss, service disruption. | `redisCommand`, `redisCommandArgv`, `redisvFormatCommand`, and related functions used for sending commands, specifically when used to send administrative commands. | **Critical** | - **Principle of least privilege:** The Redis user the application connects with should have minimal necessary permissions. Avoid granting access to administrative commands unless absolutely required. <br> - **Application-level authorization:** Implement robust authorization checks within the application to control which users or roles can trigger Redis commands, especially administrative ones. |
| **Exploitation of Known `hiredis` Vulnerabilities** | An attacker exploits known vulnerabilities in a specific version of the `hiredis` library being used by the application. | Remote code execution, denial of service, information disclosure, depending on the specific vulnerability. | The specific module or function within `hiredis` affected by the vulnerability. | **Critical** to **High** (depending on the vulnerability). | - **Keep `hiredis` updated:** Regularly update to the latest stable version of `hiredis`. <br> - **Monitor security advisories:** Subscribe to security mailing lists and monitor for announcements regarding `hiredis` vulnerabilities. |