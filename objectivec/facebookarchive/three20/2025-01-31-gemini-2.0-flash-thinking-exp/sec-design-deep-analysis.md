## Deep Security Analysis of Three20 Library

### 1. Objective, Scope, and Methodology

**Objective:**

The objective of this deep security analysis is to thoroughly evaluate the security posture of the archived Three20 iOS library. This analysis aims to identify potential security vulnerabilities and risks inherent in its design, components, and historical context, particularly considering its current archived and unmaintained status. The focus is on providing actionable insights for development teams who may still maintain applications built using Three20, or for those assessing the historical security impact of its usage.

**Scope:**

This analysis encompasses the following aspects of the Three20 library, as outlined in the provided security design review:

*   **Architecture and Components:**  Inference of the library's architecture, key components (UI elements, utilities), and data flow based on the provided C4 diagrams and descriptions, and general knowledge of iOS UI frameworks.
*   **Security Controls (Historical and Current):** Evaluation of existing and recommended security controls mentioned in the review, assessing their effectiveness and relevance, especially in the context of an archived project.
*   **Security Requirements:** Analysis of the defined security requirements (Input Validation, Cryptography) and their applicability to a UI framework like Three20, and how applications using it should address these.
*   **Risk Assessment:**  Consideration of business risks associated with using Three20, particularly focusing on the implications of its archived status and potential vulnerabilities.
*   **Build and Deployment Processes:**  Review of the build and deployment diagrams to identify potential security considerations within these processes.

This analysis is limited to the information provided in the security design review document and publicly available information about Three20. It does not include a direct code audit, penetration testing, or dynamic analysis of the Three20 library.

**Methodology:**

The methodology employed for this deep analysis is as follows:

1.  **Document Review:**  Thorough review of the provided security design review document, including business posture, security posture, design (C4 diagrams), risk assessment, and questions/assumptions.
2.  **Architecture and Component Inference:** Based on the C4 diagrams, descriptions, and general knowledge of iOS UI frameworks, infer the likely architecture, key components, and data flow within Three20.
3.  **Threat Modeling (Implicit):**  Identify potential security threats relevant to each inferred component and data flow, considering common vulnerabilities in UI frameworks and mobile applications.
4.  **Security Control Evaluation:** Assess the effectiveness of the listed existing and recommended security controls, and their current relevance given the archived status of Three20.
5.  **Tailored Recommendation Generation:** Develop specific and actionable security recommendations and mitigation strategies tailored to the Three20 library and its users, focusing on practical steps that can be taken in the context of an archived project.
6.  **Contextualization:** Frame the analysis and recommendations within the historical context of Three20's development and its current archived state, emphasizing the implications for applications still relying on it.

### 2. Security Implications of Key Components

Based on the provided documentation and general understanding of UI frameworks, we can infer the following key components and their potential security implications within Three20:

**a) UI Components (Buttons, Labels, Table Views, Image Views, etc.):**

*   **Security Implications:**
    *   **Input Validation Vulnerabilities:** UI components that accept user input (e.g., text fields within custom views) could be susceptible to injection attacks (like XSS if rendering web content within a component, or format string vulnerabilities if improperly handling string formatting). If Three20 provides custom input components, lack of proper input validation within these components could be a vulnerability.
    *   **Data Binding and Display Issues:** If UI components dynamically display data fetched from external sources, improper handling of this data could lead to vulnerabilities. For example, if data is not properly encoded before being displayed in a label, it could lead to XSS if the data source is compromised or malicious.
    *   **State Management Issues:**  Improper state management within complex UI components could lead to unexpected behavior or vulnerabilities if not handled securely.
    *   **Memory Management Issues:**  Historically, Objective-C required manual memory management. Bugs in UI components related to memory management could lead to crashes or, in more severe cases, exploitable memory corruption vulnerabilities.

**b) Networking Utilities (If Present):**

*   **Security Implications:**
    *   **Insecure Network Communication:** If Three20 provides networking utilities (e.g., for image loading, data fetching), they might not enforce secure communication protocols (HTTPS) by default, leading to data-in-transit vulnerabilities (Man-in-the-Middle attacks).
    *   **Vulnerabilities in Network Libraries:** If Three20 relies on third-party networking libraries, vulnerabilities in those libraries could be inherited.
    *   **Improper Certificate Validation:** If handling HTTPS, vulnerabilities related to improper SSL/TLS certificate validation could expose applications to MITM attacks.

**c) Caching Mechanisms (If Present):**

*   **Security Implications:**
    *   **Insecure Data Storage:** If Three20 provides caching mechanisms for data or images, sensitive data might be stored insecurely on the device (e.g., unencrypted in local files or databases).
    *   **Cache Poisoning:** If caching mechanisms are not properly implemented, they could be susceptible to cache poisoning attacks, where malicious data is injected into the cache and served to the application.
    *   **Insufficient Cache Control:** Lack of proper cache control mechanisms could lead to sensitive data being cached for longer than necessary, increasing the risk of exposure.

**d) Image Handling and Processing:**

*   **Security Implications:**
    *   **Image Processing Vulnerabilities:** Vulnerabilities in image decoding or processing libraries (if used by Three20) could lead to crashes, denial of service, or even remote code execution if malicious images are processed.
    *   **Denial of Service through Large Images:**  Improper handling of large images could lead to excessive resource consumption and denial of service.

**e) Data Models and Utilities (If Present):**

*   **Security Implications:**
    *   **Data Integrity Issues:** If Three20 provides utilities for data manipulation or storage, vulnerabilities in these utilities could lead to data integrity issues or data corruption.
    *   **Information Disclosure:** Improper handling of data within utility classes could unintentionally expose sensitive information.

### 3. Architecture, Components, and Data Flow Inference

Based on the C4 diagrams and descriptions, we can infer the following about Three20's architecture, components, and data flow:

**Architecture:**

*   **Client-Side UI Framework:** Three20 is designed as a client-side library intended to be integrated directly into iOS applications. It operates within the application's process and relies on the iOS SDK APIs.
*   **Modular Design:**  Likely composed of modules for different functionalities (UI components, utilities, etc.), allowing developers to use specific parts of the library as needed.
*   **No Backend Dependency:**  Three20 itself does not have a backend component. It is purely a front-end library. Any backend interaction is the responsibility of the application using Three20.

**Components (Inferred):**

*   **UI Components:** A comprehensive set of reusable UI elements like buttons, labels, text fields, table views, image views, navigation bars, etc., designed to simplify iOS UI development.
*   **Layout and Styling System:** Mechanisms for defining UI layouts, themes, and styles for consistent application appearance.
*   **Networking Utilities:** Potentially includes utilities for making network requests (e.g., HTTP clients) and handling network responses, especially for fetching data and images.
*   **Image Loading and Caching:** Components for efficient image loading, display, and caching, likely including mechanisms for asynchronous loading and memory/disk caching.
*   **Data Management Utilities:**  Potentially includes utilities for data modeling, parsing, and handling, to facilitate data display in UI components.
*   **Helper Classes and Utilities:**  General-purpose utility classes and helper functions to simplify common iOS development tasks.

**Data Flow (Inferred):**

1.  **Application Code Initialization:** The application code initializes and configures Three20 components.
2.  **Data Input to Components:** Application code provides data to Three20 UI components, either directly (e.g., setting text on a label) or through data binding mechanisms. This data can originate from user input, local storage, or remote servers.
3.  **UI Rendering:** Three20 components render the UI based on the provided data and configurations, utilizing iOS UI framework APIs.
4.  **User Interaction Handling:**  Three20 components handle user interactions (taps, gestures, etc.) and may trigger events or callbacks that are handled by the application code.
5.  **Data Output from Components (Potentially):** In some cases, UI components might provide data back to the application code (e.g., text entered in a text field).
6.  **Networking (If Used):** If networking utilities are used, data may flow from remote servers to the application via Three20's networking components, and then be displayed in UI components.
7.  **Caching (If Used):** Data and images fetched from the network might be cached locally using Three20's caching mechanisms for performance optimization.

### 4. Tailored Security Recommendations for Three20 Users

Given that Three20 is archived and no longer maintained, the security recommendations are primarily focused on applications that are *still using* Three20:

**a) Prioritize Migration Away from Three20:**

*   **Recommendation:** The most critical long-term security recommendation is to **plan and execute a migration away from Three20 to a currently maintained and actively supported UI framework or component library.**  Using an archived library introduces significant and increasing security risks over time.
*   **Actionable Mitigation:**
    *   **Assess the scope of Three20 usage** within the application to understand the effort required for migration.
    *   **Evaluate alternative UI frameworks or component libraries** that provide similar functionalities and are actively maintained (e.g., UIKit directly, SwiftUI, other modern component libraries).
    *   **Develop a migration plan** with phased replacement of Three20 components, starting with the most critical and potentially vulnerable parts.
    *   **Allocate resources and budget** for the migration project.

**b) Conduct Thorough Security Audits of Applications Using Three20:**

*   **Recommendation:**  Perform comprehensive security audits of applications that rely on Three20 to identify potential vulnerabilities introduced by the library or its integration.
*   **Actionable Mitigation:**
    *   **Static Application Security Testing (SAST):** Use SAST tools to scan the application codebase for potential vulnerabilities, focusing on code sections that interact with Three20 components.
    *   **Dynamic Application Security Testing (DAST):** Perform DAST to test the running application for vulnerabilities, including those that might be exposed through Three20 components.
    *   **Manual Code Review:** Conduct manual code reviews, specifically focusing on the integration points between the application code and Three20, looking for insecure usage patterns or potential vulnerabilities.
    *   **Penetration Testing:** Engage security experts to perform penetration testing to simulate real-world attacks and identify exploitable vulnerabilities in the application, including those related to Three20.

**c) Implement Robust Input Validation and Output Encoding:**

*   **Recommendation:**  Since Three20 is no longer updated, applications must take responsibility for robust input validation and output encoding at the application level, especially for data that interacts with Three20 components.
*   **Actionable Mitigation:**
    *   **Input Validation:** Implement strict input validation for all user inputs and data received from external sources *before* passing them to Three20 components. Validate data type, format, length, and range.
    *   **Output Encoding:**  Ensure proper output encoding (e.g., HTML encoding, URL encoding) when displaying data retrieved from external sources or user inputs within UI components, especially if Three20 components handle any form of web content rendering.

**d) Isolate and Sandbox Three20 Components (If Feasible):**

*   **Recommendation:**  If complete migration is not immediately feasible, consider isolating Three20 components as much as possible within the application architecture to limit the potential impact of any vulnerabilities found in Three20.
*   **Actionable Mitigation:**
    *   **Minimize direct interaction:** Reduce the surface area of interaction between application code and Three20 components.
    *   **Encapsulation:** Wrap Three20 components within application-specific modules or classes to control data flow and limit dependencies.
    *   **Sandbox (Conceptual):** While iOS provides application sandboxing, think about logical sandboxing within the application architecture to contain potential issues within Three20.

**e) Monitor for Security Vulnerabilities and Exploits:**

*   **Recommendation:**  Actively monitor for any publicly disclosed security vulnerabilities related to Three20, even though it is archived. Also, monitor application logs and runtime behavior for any anomalies that might indicate exploitation of vulnerabilities.
*   **Actionable Mitigation:**
    *   **Security News and Databases:** Subscribe to security news feeds and monitor vulnerability databases for any mentions of Three20 or related vulnerabilities in similar UI frameworks.
    *   **Application Monitoring:** Implement robust application logging and monitoring to detect unusual behavior, crashes, or error patterns that could be indicative of security exploits.
    *   **Incident Response Plan:** Have an incident response plan in place to quickly react and mitigate any security incidents related to Three20 vulnerabilities.

**f) Dependency Scanning (Application Level):**

*   **Recommendation:**  While dependency scanning might not directly identify vulnerabilities *within* Three20 (as it's not actively maintained and scanned), use dependency scanning tools on the *application* level to identify vulnerabilities in other third-party libraries used by the application, which could be indirectly related to or exacerbated by the use of Three20.
*   **Actionable Mitigation:**
    *   Integrate dependency scanning tools into the application's CI/CD pipeline to regularly scan for known vulnerabilities in all dependencies, including Three20 (if the tool can recognize it as a dependency, even if archived).

### 5. Actionable and Tailored Mitigation Strategies

The following table summarizes actionable and tailored mitigation strategies for the identified threats, applicable to applications using Three20:

| Threat Category                     | Specific Threat                                     | Actionable Mitigation Strategy                                                                 | Tailored to Three20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - Input Validation Vulnerabilities | Injection attacks (XSS, Format String) | Implement robust input validation for all user inputs handled by UI components. Sanitize and validate data before processing and displaying it in UI components. | Focus on UI components that handle user input or display external data. Specifically relevant to custom UI components within Three20.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              