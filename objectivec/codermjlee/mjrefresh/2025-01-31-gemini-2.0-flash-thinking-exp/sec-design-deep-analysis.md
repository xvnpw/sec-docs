Okay, let's perform a deep security analysis of the `mjrefresh` library based on the provided security design review.

## Deep Security Analysis of mjrefresh Library

### 1. Objective, Scope, and Methodology

**Objective:**

The primary objective of this deep security analysis is to thoroughly evaluate the security posture of the `mjrefresh` library. This analysis aims to identify potential security vulnerabilities and weaknesses within the library's design, implementation, and deployment processes.  The focus is on ensuring that the library does not introduce security risks into applications that integrate it, thereby maintaining user trust and application stability.

**Scope:**

This analysis encompasses the following aspects of the `mjrefresh` library, as outlined in the security design review:

*   **Codebase Analysis (Inferred):**  While direct code access isn't provided in the review, we will infer potential security implications based on the described functionality of a pull-to-refresh library and common iOS development practices. We will consider aspects like input handling for customization, memory management within the library, and potential interactions with UIKit components.
*   **Design Review Documents:**  Analysis of the provided C4 Context, Container, Deployment, and Build diagrams to understand the architecture, components, and data flow.
*   **Security Controls:** Evaluation of existing and recommended security controls, including their effectiveness and completeness.
*   **Risk Assessment:** Review of identified business and security risks associated with the library.
*   **Deployment and Build Processes:** Analysis of the described deployment options and build pipeline for potential security vulnerabilities.

**Methodology:**

This deep security analysis will employ the following methodology:

1.  **Document Review:**  Thorough review of the provided security design review document, including business posture, security posture, design diagrams, deployment details, build process, risk assessment, and questions/assumptions.
2.  **Component-Based Analysis:**  Break down the `mjrefresh` ecosystem into its key components as identified in the C4 diagrams (Mobile Application User, mjrefresh Library, iOS Application Developer, GitHub, Mobile Application, CocoaPods, Build Pipeline elements).
3.  **Threat Modeling (Implicit):**  Based on the understanding of each component and its interactions, we will implicitly model potential threats relevant to a UI library. This will focus on areas like input validation, memory safety, dependency vulnerabilities (though less likely), and build pipeline integrity.
4.  **Security Control Evaluation:**  Assess the effectiveness of existing and recommended security controls in mitigating the identified threats.
5.  **Actionable Mitigation Strategy Development:**  For each identified security implication, we will develop specific, actionable, and tailored mitigation strategies applicable to the `mjrefresh` library project. These strategies will be practical and consider the open-source nature of the project.

### 2. Security Implications of Key Components

Based on the security design review and understanding of a pull-to-refresh library, we can break down the security implications of key components:

**2.1. mjrefresh Library (Codebase):**

*   **Security Implication 1: Input Validation Vulnerabilities:**
    *   **Description:**  The `mjrefresh` library likely exposes customization options to developers, such as setting colors, fonts, animation styles, and potentially custom views. If these configuration parameters are not properly validated, malicious or unexpected input from the integrating application could lead to:
        *   **Unexpected Behavior/Crashes:**  Invalid input could cause the library to behave erratically or crash the application, leading to a denial-of-service within the application.
        *   **Resource Exhaustion:**  Maliciously crafted input could cause excessive resource consumption (e.g., memory leaks, CPU spikes) within the library, impacting application performance or leading to crashes.
        *   **Logic Flaws:**  Improper handling of edge cases due to invalid input could expose logic flaws in the library, potentially leading to unexpected UI behavior or even exploitable conditions (though less likely in a UI library, it's still a possibility).
    *   **Specific Example (Inferred):** Imagine a configuration option to set the refresh header height. If the library doesn't validate that this height is a positive number, a negative or extremely large value could cause layout issues, crashes, or even memory corruption if used improperly in memory allocation.

*   **Security Implication 2: Memory Safety Issues:**
    *   **Description:**  iOS development, especially with Objective-C (which `mjrefresh` might be based on, given its GitHub presence and project age), requires careful memory management.  If the `mjrefresh` library has memory management vulnerabilities (e.g., dangling pointers, double frees, memory leaks), it could lead to:
        *   **Crashes:** Memory corruption can directly lead to application crashes, impacting user experience and potentially application stability.
        *   **Exploitable Vulnerabilities (Less Likely but Possible):** In some scenarios, memory safety issues can be exploited by attackers to gain control of the application or leak sensitive information. While less probable in a UI library, it's a general security concern in native code.
    *   **Specific Example (Inferred):**  If the library dynamically allocates memory for UI elements during the refresh animation and fails to properly deallocate it when the refresh control is removed or deinitialized, it could lead to memory leaks over time, eventually degrading application performance or causing crashes.

*   **Security Implication 3: Denial of Service through Resource Exhaustion:**
    *   **Description:**  Even without malicious intent, bugs in the library's animation logic or resource management could lead to unintentional resource exhaustion. For example:
        *   **Infinite Loops/Recursive Calls:**  Bugs in the refresh logic could lead to infinite loops or recursive function calls, consuming CPU and potentially freezing the application.
        *   **Excessive UI Updates:**  Inefficient UI rendering or excessive updates triggered by the refresh control could strain the device's resources, leading to a sluggish user experience or application unresponsiveness.
    *   **Specific Example (Inferred):**  If the animation logic for the refresh indicator has a flaw that causes it to continuously redraw or recalculate its position unnecessarily, it could lead to high CPU usage and battery drain, effectively causing a denial of service for the user.

**2.2. Integration with Mobile Application:**

*   **Security Implication 4: Misuse by Integrating Application Developers:**
    *   **Description:**  Even if the `mjrefresh` library itself is secure, developers integrating it into their applications might misuse it in ways that introduce security vulnerabilities. This could include:
        *   **Incorrect Configuration:**  Developers might misconfigure the library, unintentionally disabling security features (if any exist, though unlikely in this type of library) or introducing unexpected behavior.
        *   **Improper Handling of Refresh Events:**  If the library provides callbacks or events when a refresh is triggered, developers might not handle these events securely. For example, if a refresh triggers a network request, developers need to ensure secure communication and proper error handling.
        *   **Data Exposure through Custom Views:** If developers can inject custom views into the refresh header/footer, they could unintentionally or maliciously introduce code that logs or exposes sensitive data.
    *   **Specific Example:**  If the `mjrefresh` library allows developers to customize the refresh action (e.g., a block of code executed on refresh), a developer might inadvertently include insecure code in this block, such as logging sensitive user data or making insecure network requests.

**2.3. GitHub Repository:**

*   **Security Implication 5: Compromised Source Code or Build Artifacts:**
    *   **Description:**  Although GitHub provides security controls, the repository itself could be targeted.
        *   **Account Compromise:**  If maintainer accounts are compromised, malicious code could be injected into the repository.
        *   **Supply Chain Attack:**  If the build process is not secure, attackers could potentially inject malicious code into the distributed library artifacts (though less likely for direct source code integration, more relevant for pre-compiled binaries if distributed).
    *   **Mitigation (Existing):** GitHub's version control and transparency features help in detecting unauthorized changes. Open-source nature allows community review.
    *   **Mitigation (Recommended):**  Implementing SAST and dependency scanning in the CI/CD pipeline, as recommended, will further strengthen the security of the codebase and build process.

**2.4. CocoaPods (Dependency Management):**

*   **Security Implication 6: Dependency Confusion/Compromised PodSpec (Lower Risk for this Library Type):**
    *   **Description:**  While less likely for a UI library, there's a theoretical risk of dependency confusion attacks or compromised PodSpecs. An attacker could try to publish a malicious library with the same name or a similar name to `mjrefresh` on a public or private CocoaPods repository. Developers could then mistakenly download and integrate the malicious library.
    *   **Mitigation (Existing):**  Relying on the official CocoaPods repository and verifying the library's source (GitHub link) reduces this risk.
    *   **Mitigation (Recommended):**  Dependency scanning can help detect if the resolved dependency is unexpectedly changed or comes from an untrusted source (though less effective for dependency confusion if the name is identical).

### 3. Architecture, Components, and Data Flow (Inferred)

Based on the description and C4 diagrams, we can infer the following architecture, components, and data flow:

*   **Architecture:** Client-side UI library for iOS applications. It's designed to be integrated directly into mobile applications and runs within the application's process on the user's device.
*   **Components (Inferred from Functionality):**
    *   **Refresh Control Class:**  The core component, likely a subclass of `UIControl` or `UIView`, responsible for rendering the pull-to-refresh UI and handling user gestures.
    *   **Animation Engine:**  Handles the animations for the refresh indicator (e.g., spinning, progress bar).
    *   **Configuration Manager:**  Manages customizable settings like colors, fonts, animation styles, and potentially custom views.
    *   **Event Handling Mechanism:**  Provides a way for the integrating application to be notified when a refresh is triggered and when it completes.
*   **Data Flow (Inferred):**
    1.  **Configuration Input:** The integrating application provides configuration parameters to the `mjrefresh` library during initialization or setup. This is the primary input point.
    2.  **User Interaction:** The user interacts with the UI by performing a pull-to-refresh gesture.
    3.  **Gesture Recognition:** The `mjrefresh` library detects the pull-to-refresh gesture.
    4.  **Animation Trigger:** The library triggers the refresh animation to provide visual feedback to the user.
    5.  **Refresh Event Notification:** The library notifies the integrating application that a refresh has been triggered (likely through a delegate, closure, or notification).
    6.  **Application Refresh Logic:** The integrating application executes its refresh logic (e.g., fetching new data from a server).
    7.  **Refresh Completion Signal:** The integrating application signals to the `mjrefresh` library when the refresh operation is complete.
    8.  **Animation Completion:** The library completes the refresh animation and returns to the normal state.

**Data Sensitivity:**  The `mjrefresh` library itself does not directly handle sensitive user data. However, it indirectly interacts with data through the integrating application. The library's security is crucial to prevent it from becoming a vector for vulnerabilities in applications that *do* handle sensitive data.

### 4. Specific Security Considerations and Tailored Recommendations for mjrefresh

Based on the identified security implications, here are specific and tailored security considerations and recommendations for the `mjrefresh` library:

**4.1. Input Validation:**

*   **Consideration:**  Configuration parameters provided by the integrating application are a potential attack surface.
*   **Recommendation 1: Implement Robust Input Validation:**
    *   **Action:**  Thoroughly validate all configuration parameters accepted by the `mjrefresh` library. This includes:
        *   **Data Type Validation:** Ensure parameters are of the expected data type (e.g., numbers, strings, enums).
        *   **Range Validation:**  Validate numerical parameters are within acceptable ranges (e.g., positive values for sizes, valid color ranges).
        *   **Format Validation:**  Validate string parameters against expected formats (e.g., if accepting string representations of colors, validate the format).
        *   **Sanitization (If Applicable):** If accepting string inputs that might be used in UI rendering (e.g., text labels), consider basic sanitization to prevent potential injection issues (though less likely in this context, it's good practice).
    *   **Example:** For a configuration option to set the refresh header height, validate that the input is a positive `CGFloat` value. Reject negative or non-numeric inputs and provide clear error handling (e.g., log an error or use a default value).

**4.2. Memory Safety:**

*   **Consideration:** Memory management issues can lead to crashes and potentially exploitable vulnerabilities.
*   **Recommendation 2: Employ Memory Safety Best Practices and Static Analysis:**
    *   **Action:**
        *   **Adopt Modern Swift Features (If Applicable/Migrating):** If the library is being developed or updated in Swift, leverage Swift's memory safety features like ARC (Automatic Reference Counting) and value types to minimize manual memory management errors.
        *   **Rigorous Memory Management in Objective-C (If Applicable):** If using Objective-C, strictly adhere to memory management best practices (ARC or manual retain/release) to prevent leaks, dangling pointers, and double frees.
        *   **Integrate Memory Safety Static Analysis:** Utilize static analysis tools (part of SAST) that specifically focus on memory safety issues in Objective-C or Swift code. Tools like Clang Static Analyzer (often integrated into Xcode) can help identify potential memory leaks and other memory-related bugs.
    *   **Example:**  Use Xcode's static analyzer regularly during development and as part of the CI/CD pipeline to detect potential memory leaks or other memory management issues in the `mjrefresh` codebase.

**4.3. Denial of Service Prevention:**

*   **Consideration:** Bugs in animation logic or resource management could lead to resource exhaustion and denial of service.
*   **Recommendation 3: Optimize Animations and Resource Usage:**
    *   **Action:**
        *   **Efficient Animation Implementation:** Ensure animations are implemented efficiently, avoiding unnecessary redraws or complex calculations in each frame. Use performant animation techniques provided by UIKit.
        *   **Resource Management:**  Carefully manage resources used by the library, especially during animations. Avoid creating unnecessary objects or performing expensive operations repeatedly.
        *   **Thorough Testing:**  Conduct performance testing and profiling to identify potential resource bottlenecks or inefficient code paths that could lead to resource exhaustion. Test under various conditions, including rapid pull-to-refresh gestures and different device capabilities.
    *   **Example:** Profile the library's performance during refresh animations to identify any CPU or memory intensive operations. Optimize animation code to minimize resource consumption and ensure smooth performance even on lower-end devices.

**4.4. Secure Build Pipeline and Dependency Management:**

*   **Consideration:**  Compromised build pipeline or dependencies could lead to distribution of a malicious library.
*   **Recommendation 4: Implement Recommended Security Controls in Build Pipeline:**
    *   **Action:**  Actively implement the recommended security controls from the design review:
        *   **Automated SAST in CI/CD:** Integrate a SAST tool into the GitHub Actions CI/CD pipeline to automatically scan the code for vulnerabilities on each commit or pull request.
        *   **Dependency Scanning:** Implement dependency scanning to identify and manage known vulnerabilities in any third-party libraries used during development or build (though less likely for a UI library, still good practice).
        *   **Secure Publishing Process:** Ensure the process for packaging and publishing the library to CocoaPods is secure and uses strong authentication and authorization.
    *   **Example:** Configure GitHub Actions to run a SAST tool (e.g., SonarQube, CodeQL) on every pull request to automatically detect potential code vulnerabilities before merging changes.

**4.5. Vulnerability Reporting and Handling:**

*   **Consideration:**  A clear process for reporting and handling security vulnerabilities is crucial for maintaining the library's security.
*   **Recommendation 5: Establish a Security Policy and Vulnerability Reporting Process:**
    *   **Action:**
        *   **Create a SECURITY.md file:** Add a `SECURITY.md` file to the GitHub repository outlining the project's security policy and providing instructions for reporting security vulnerabilities.
        *   **Dedicated Security Contact:**  Provide a dedicated email address or communication channel for security vulnerability reports (e.g., `security@mjrefresh.org` or a private GitHub security advisory).
        *   **Vulnerability Response Plan:**  Define a process for triaging, investigating, and patching reported vulnerabilities in a timely manner. Communicate with reporters and users about the status of vulnerabilities and released patches.
    *   **Example:** Create a `SECURITY.md` file in the repository root with clear instructions on how to report security vulnerabilities, including a dedicated email address and expected response times.

**4.6. Code Reviews:**

*   **Consideration:** Code reviews are essential for catching security vulnerabilities and improving code quality.
*   **Recommendation 6: Conduct Regular Security-Focused Code Reviews:**
    *   **Action:**
        *   **Mandatory Code Reviews:**  Make code reviews mandatory for all code changes, especially for critical components and contributions from external developers.
        *   **Security Checklist:**  Develop a security checklist to guide code reviewers in identifying potential security vulnerabilities during reviews. Focus on input validation, memory safety, and potential logic flaws.
        *   **Security Training for Developers:**  Provide security awareness training to developers contributing to the project to improve their understanding of secure coding practices.
    *   **Example:** Before merging any pull request, ensure it is reviewed by at least one other developer, specifically focusing on security aspects using a defined security code review checklist.

### 5. Actionable and Tailored Mitigation Strategies

The recommendations above are already actionable and tailored. To summarize and further emphasize actionability, here's a table of mitigation strategies with concrete actions:

| Threat                                  | Mitigation Strategy                                     | Actionable Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               