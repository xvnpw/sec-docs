Certainly! Let's perform a deep security analysis of the `uitableview-fdtemplatelayoutcell` library based on the provided security design review.

## Deep Security Analysis of `UITableView+FDTemplateLayoutCell`

### 1. Objective, Scope, and Methodology

**Objective:**

The primary objective of this deep security analysis is to identify, assess, and provide actionable mitigation strategies for potential security vulnerabilities associated with the `UITableView+FDTemplateLayoutCell` open-source iOS library. This analysis will focus on understanding the library's architecture, components, and data flow to pinpoint areas where security risks might arise, despite its nature as a UI utility.  The goal is to provide specific, tailored recommendations to enhance the security posture of applications utilizing this library and to guide the library's maintainers in improving its inherent security.

**Scope:**

This analysis encompasses the following:

*   **Codebase Analysis (Indirect):**  While a full source code audit is beyond this review, we will infer potential security implications by analyzing the library's purpose, documented functionality, and common patterns in iOS UI libraries.
*   **Dependency Analysis:**  We will consider potential security risks arising from the library's dependencies (though none are explicitly listed in the provided review, we will consider general iOS library dependencies).
*   **Build and Distribution Process:**  We will examine the security aspects of the library's build process, distribution via GitHub, and integration into iOS applications.
*   **Operational Environment:**  We will analyze the security context of iOS applications using this library, focusing on how the library's functionality might interact with application-level security.
*   **Security Design Review Document:** We will use the provided document as the foundation for our analysis, addressing the identified risks, controls, and recommendations.

**Methodology:**

This deep analysis will employ the following methodology:

1.  **Document Review:**  Thorough review of the provided Security Design Review document to understand the business and security posture, design elements (C4 diagrams), risk assessment, and identified security controls and recommendations.
2.  **Architecture and Component Inference:** Based on the library's description and the design review, we will infer the likely architecture and key components of the library. This will involve understanding how it interacts with `UITableView`, `UITableViewCell`, and Auto Layout.
3.  **Threat Modeling:** We will perform threat modeling to identify potential security threats relevant to each component and data flow. This will be tailored to the context of a UI library and its integration into iOS applications. We will consider threats from different perspectives, including supply chain, code vulnerabilities, and misuse.
4.  **Security Implication Analysis:** For each identified threat, we will analyze the potential security implications, considering confidentiality, integrity, and availability. We will focus on how these threats could manifest in applications using the library.
5.  **Mitigation Strategy Development:**  We will develop specific, actionable, and tailored mitigation strategies for each identified threat. These strategies will be practical and applicable to the `UITableView+FDTemplateLayoutCell` library and its ecosystem.
6.  **Recommendation Prioritization:**  We will prioritize mitigation strategies based on their potential impact and feasibility of implementation.

### 2. Security Implications of Key Components

Based on the design review and understanding of iOS UI libraries, let's break down the security implications of key components:

**a) UITableView+FDTemplateLayoutCell Library Code:**

*   **Inferred Component:**  Core logic for calculating cell heights, likely involving:
    *   Caching mechanisms for layout calculations to improve performance.
    *   Logic to measure cell content based on Auto Layout constraints.
    *   Integration with `UITableView` and `UITableViewCell` APIs.

*   **Security Implications:**
    *   **Logic Flaws in Height Calculation:**  While not directly a "security vulnerability" in the traditional sense, flaws in height calculation logic could lead to UI rendering issues. In specific scenarios, if cell content is sensitive and layout is broken, it *could* indirectly lead to information disclosure (e.g., overlapping cells revealing hidden data). This is a low-probability, high-impact scenario depending on the application's data sensitivity.
    *   **Resource Exhaustion (DoS):**  If the height calculation logic is inefficient or vulnerable to certain inputs (e.g., extremely complex layouts, very large content), it could lead to excessive CPU or memory usage, potentially causing a denial-of-service (DoS) condition within the application. This is more of a performance/stability issue but can have security implications if it impacts critical application functionality.
    *   **Unintended Side Effects from Caching:**  If the caching mechanism is not implemented correctly, it could potentially lead to incorrect cell layouts being displayed, especially if cell content changes dynamically. While primarily a functional issue, in specific edge cases, incorrect data display could have indirect security implications.
    *   **Code Vulnerabilities (Buffer Overflows, etc.):** Although less likely in modern Swift/Objective-C with ARC, there's always a theoretical risk of memory safety vulnerabilities in the library code itself, especially if it interacts with lower-level APIs or external C/C++ code (unlikely in this UI library context, but worth noting).

**b) GitHub Repository:**

*   **Inferred Component:**  Source code hosting, version control, issue tracking, pull request management.

*   **Security Implications:**
    *   **Supply Chain Vulnerability (Compromised Repository):**  If the GitHub repository were compromised (e.g., attacker gains maintainer access), malicious code could be injected into the library. This is a significant supply chain risk, as developers downloading the library would unknowingly integrate compromised code into their applications.
    *   **Exposure of Vulnerabilities through Public Code:**  While open source allows for community review, it also means vulnerabilities in the code are publicly visible once discovered. This can be a double-edged sword.
    *   **Lack of Formal Security Review Process:**  As highlighted in the design review, there's no formal security audit process. Reliance on community review is valuable but might not be as thorough as dedicated security testing.

**c) Build Process (Inferred - GitHub Actions or similar):**

*   **Inferred Component:**  Automated build system to compile the library, run tests, and potentially create distribution packages.

*   **Security Implications:**
    *   **Compromised Build Pipeline:**  If the CI/CD pipeline (e.g., GitHub Actions workflows) is compromised, attackers could inject malicious code during the build process, leading to the distribution of a backdoored library.
    *   **Dependency Vulnerabilities in Build Tools:**  The build process might rely on external tools or dependencies (e.g., specific Xcode versions, build scripts). Vulnerabilities in these tools could be exploited to compromise the build process.
    *   **Lack of Build Artifact Integrity Verification:**  Without proper signing and verification mechanisms, it's harder to ensure the integrity of the distributed library artifacts.

**d) Distribution Channels (GitHub Releases, CocoaPods, Carthage):**

*   **Inferred Component:**  Mechanisms for developers to download and integrate the library into their projects.

*   **Security Implications:**
    *   **Supply Chain Vulnerability (Distribution Channel Compromise):**  If distribution channels like CocoaPods or Carthage were compromised (less likely but theoretically possible), malicious versions of the library could be distributed.
    *   **Man-in-the-Middle Attacks (during download):**  If developers download the library over insecure HTTP connections (less common now with HTTPS prevalence but still a consideration), there's a theoretical risk of MITM attacks to inject malicious code.
    *   **Lack of Authenticity and Integrity Verification:**  Developers need to trust the source and integrity of the library they download. Without strong signing and verification, it's harder to ensure they are using the genuine, untampered library.

**e) Integration into iOS Applications:**

*   **Inferred Component:**  iOS developers using the library in their applications.

*   **Security Implications:**
    *   **Incorrect Usage by Developers:**  Developers might misuse the library's API or integrate it incorrectly, potentially leading to application vulnerabilities or unexpected behavior. While not a vulnerability in the library itself, it's a security concern arising from its use.
    *   **Application-Level Data Handling:**  Applications using the library will display data in table view cells. If the library contributes to UI issues that indirectly expose sensitive data (as mentioned in point 'a'), this becomes a security concern at the application level.
    *   **Dependency Conflicts:**  In rare cases, the library might have dependency conflicts with other libraries used in the application, potentially leading to instability or unexpected behavior that could have security implications.

### 3. Architecture, Components, and Data Flow (Inferred)

Based on the library's name and description, we can infer the following:

**Architecture:**

*   **Client-Side Library:**  `UITableView+FDTemplateLayoutCell` is purely a client-side iOS library. It operates within the iOS application's process and does not involve any server-side components or network communication.
*   **Category on `UITableView`:** The `UITableView+` naming convention suggests it's implemented as a category (extension in Swift terms) on the `UITableView` class, adding new methods to simplify dynamic cell height calculation.
*   **Integration with Auto Layout:**  The library leverages iOS Auto Layout to calculate cell heights based on constraints defined within the `UITableViewCell`'s content view.

**Components (Inferred):**

1.  **Template Cell Creation & Configuration:**
    *   Mechanism to create "template" `UITableViewCell` instances for each cell type.
    *   Logic to configure these template cells with data to simulate layout.

2.  **Layout Calculation Engine:**
    *   Core algorithm to trigger Auto Layout on the template cell.
    *   Methods to measure the height of the template cell's content view after layout.
    *   Potentially involves caching of layout calculations for performance.

3.  **`UITableView` Category Methods:**
    *   New methods added to `UITableView` (via category) that developers use to calculate cell heights using the template layout approach.
    *   These methods likely internally use the layout calculation engine and template cells.

**Data Flow (Simplified):**

1.  **Application Data:** The iOS application provides data to be displayed in `UITableViewCell`s.
2.  **Cell Configuration:** For each cell, the application configures the `UITableViewCell` (or a subclass) with the relevant data.
3.  **Template Cell Layout (Library):** When the application needs to calculate a cell's height, the library:
    *   Retrieves or creates a template cell for the cell type.
    *   Configures the template cell with representative data (or sometimes no data, depending on the library's approach).
    *   Triggers Auto Layout on the template cell.
    *   Measures the calculated height of the template cell's content view.
4.  **Height Return (Library):** The library returns the calculated height to the `UITableView`.
5.  **Table View Layout:** `UITableView` uses the calculated heights to layout and display the cells.

**Security-Relevant Data Flow Points:**

*   **Data Input to Template Cells:**  While the library itself doesn't directly handle sensitive user input, the *data* used to configure template cells for height calculation is provided by the application. If this data is sensitive, any UI issues caused by the library (e.g., layout flaws leading to information disclosure) could indirectly expose this data.
*   **Caching of Layout Calculations:** If caching is implemented, the cached data (likely cell heights and potentially related layout information) needs to be handled securely within the application's memory space. However, for a UI library, this is less of a direct security concern and more about application stability and correctness.

### 4. Specific Security Recommendations for `UITableView+FDTemplateLayoutCell`

Given the nature of `UITableView+FDTemplateLayoutCell` as an open-source iOS UI library, here are specific security recommendations:

1.  **Implement Automated Dependency Scanning in CI:**
    *   **Action:** Integrate a dependency scanning tool (e.g., GitHub Dependency Check, Snyk, or similar) into the library's CI pipeline (GitHub Actions).
    *   **Rationale:**  Proactively identify known vulnerabilities in any dependencies the library might have (even if currently minimal). This addresses the "supply chain vulnerabilities" accepted risk.
    *   **Specificity:** Configure the scanner to run on every commit and pull request to the `main` branch. Fail the build if high-severity vulnerabilities are detected.

2.  **Establish a Clear Vulnerability Reporting and Response Process:**
    *   **Action:** Create a SECURITY.md file in the GitHub repository outlining how to report security vulnerabilities responsibly. Define a process for the maintainers to acknowledge, investigate, and address reported vulnerabilities in a timely manner.
    *   **Rationale:**  Facilitate responsible disclosure and ensure that security issues are handled effectively. This addresses the "community security audits and vulnerability reporting" recommended control.
    *   **Specificity:**  Specify a dedicated email address or a private reporting mechanism (e.g., GitHub Security Advisories) for security reports. Commit to providing an initial response within a defined timeframe (e.g., 72 hours).

3.  **Encourage and Facilitate Community Security Audits:**
    *   **Action:**  Actively encourage security researchers and the community to review the library's code for potential vulnerabilities. Consider participating in open-source security initiatives or bug bounty programs (if resources allow).
    *   **Rationale:** Leverage the open-source model for security benefit. Community audits can uncover vulnerabilities that might be missed by individual developers.
    *   **Specificity:**  Publicly invite security audits in the README and SECURITY.md.  Acknowledge and credit security researchers who responsibly report vulnerabilities.

4.  **Implement Basic Static Analysis Security Testing (SAST):**
    *   **Action:** Integrate a SAST tool (e.g., SwiftLint with security rules, or a more dedicated SAST tool for Swift/Objective-C) into the CI pipeline.
    *   **Rationale:**  Automatically detect common code-level security weaknesses (e.g., potential memory safety issues, insecure coding patterns) early in the development lifecycle.
    *   **Specificity:**  Start with basic SAST rules and gradually expand coverage. Focus on rules relevant to iOS development and potential UI library vulnerabilities.

5.  **Enhance Code Documentation with Security Considerations for Developers:**
    *   **Action:**  In the library's documentation, include a section on "Security Considerations for Application Developers Using `UITableView+FDTemplateLayoutCell`."
    *   **Rationale:**  Educate developers on how to use the library securely and highlight potential indirect security risks (e.g., related to data display and layout issues).
    *   **Specificity:**  Advise developers to:
        *   Thoroughly test their table view layouts with the library, especially with sensitive data.
        *   Be mindful of potential UI rendering issues that could indirectly expose information.
        *   Keep the library updated to the latest version to benefit from any security patches.

6.  **Consider Signing Build Artifacts (Optional, for Distribution Integrity):**
    *   **Action:**  Explore signing the build artifacts (e.g., the static library or distribution packages) to provide integrity verification.
    *   **Rationale:**  While less critical for a static library than for executable applications, signing can provide a stronger guarantee of authenticity and integrity, especially if distributed through channels beyond GitHub Releases.
    *   **Specificity:**  Investigate code signing options for iOS libraries and consider if it adds significant value for this project's distribution model.

7.  **Regularly Review and Update Dependencies (If Any are Added in Future):**
    *   **Action:**  Establish a process for periodically reviewing and updating any dependencies the library might introduce in the future.
    *   **Rationale:**  Ensure that dependencies are kept up-to-date with security patches and reduce the risk of using vulnerable components.
    *   **Specificity:**  Schedule dependency review and update cycles (e.g., quarterly or when security advisories are released for dependencies).

### 5. Actionable and Tailored Mitigation Strategies

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      