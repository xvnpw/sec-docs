## Deep Security Analysis of Vue.js Framework (vue-next)

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to provide a thorough evaluation of the security posture of the Vue.js framework (vue-next), focusing on its design, development, build, and distribution processes. The objective is to identify potential security vulnerabilities and risks inherent in the framework itself and its ecosystem, and to recommend specific, actionable mitigation strategies to enhance its overall security. This analysis will contribute to ensuring Vue.js remains a secure and trustworthy framework for web developers globally.

**Scope:**

The scope of this analysis encompasses the following key components and processes of the Vue.js framework, as outlined in the provided Security Design Review:

* **Vue.js Core:** The runtime library responsible for reactivity, component rendering, and core functionalities.
* **Vue.js CLI:** The command-line interface for project scaffolding, development, and building.
* **Vue.js Ecosystem Libraries:** Official and community libraries extending Vue.js functionality (e.g., Vue Router, Pinia).
* **Build Process:** From code commit to package distribution via npm, including CI/CD pipelines and security checks.
* **Deployment (Client-Side):**  Focus on the browser environment where Vue.js applications execute.
* **Dependencies:** Third-party libraries and tools used in the development and build process.
* **Security Controls:** Existing and recommended security controls as documented in the Security Design Review.

The analysis will primarily focus on the security of the Vue.js framework itself and its development lifecycle, rather than the security of applications built using Vue.js. However, the analysis will consider how the framework's design and features impact the security of applications built upon it.

**Methodology:**

This deep security analysis will employ the following methodology:

1. **Document Review:**  Thorough review of the provided Security Design Review document, including business and security posture, C4 diagrams, deployment and build process descriptions, risk assessment, questions, and assumptions.
2. **Codebase Inference (Limited):** Based on the documentation and general knowledge of Vue.js and modern JavaScript frameworks, infer the high-level architecture, component interactions, and data flow within Vue.js Core, CLI, and Ecosystem Libraries. Direct codebase review is outside the scope, but inferences will be drawn from documented responsibilities and common framework patterns.
3. **Threat Modeling (Implicit):**  Based on the identified components and data flow, implicitly identify potential threats relevant to each component and the overall system. This will be guided by common web framework vulnerabilities (XSS, injection, supply chain attacks, etc.) and the specific context of Vue.js as an open-source framework.
4. **Security Control Analysis:** Evaluate the effectiveness of existing and recommended security controls in mitigating the identified threats.
5. **Mitigation Strategy Development:**  For each identified threat and gap in security controls, develop specific, actionable, and tailored mitigation strategies applicable to the Vue.js project. These strategies will be practical and consider the open-source nature and community-driven development of Vue.js.
6. **Recommendation Prioritization:**  Prioritize recommendations based on their potential impact on security and feasibility of implementation.

### 2. Security Implications of Key Components

Based on the Security Design Review and understanding of Vue.js, we can break down the security implications of key components:

**2.1. Vue.js Core:**

* **Architecture & Data Flow Inference:** Vue.js Core is a JavaScript library that operates primarily within the user's browser. It manages the Virtual DOM, reactivity system, and component rendering. Data flow involves:
    * **Template Compilation:** Templates (HTML-like syntax) are compiled into render functions.
    * **Data Binding:** Data properties are bound to the DOM, and changes trigger updates.
    * **Component Lifecycle:** Components go through lifecycle hooks (created, mounted, updated, etc.).
    * **User Input Handling:** Event listeners handle user interactions (clicks, input, etc.).
    * **DOM Manipulation:** Vue.js directly manipulates the DOM to reflect data changes.

* **Security Implications:**
    * **Cross-Site Scripting (XSS):**  The primary security concern for Vue.js Core is XSS. If user-controlled data is not properly escaped during template rendering or DOM manipulation, it can lead to malicious script injection.
        * **Positive Control:** The Security Design Review mentions "Input escaping in template rendering to prevent XSS" as a security control. This is a crucial default behavior.
        * **Potential Risk:** Developers might bypass default escaping mechanisms intentionally or unintentionally, leading to vulnerabilities. `v-html` directive is a prime example if used carelessly with user-provided content.
    * **Prototype Pollution:** JavaScript prototype pollution vulnerabilities could potentially affect Vue.js Core if the framework itself or its dependencies are susceptible. This could lead to unexpected behavior or even security breaches.
    * **Reactivity System Vulnerabilities:**  While less common, vulnerabilities in the reactivity system could potentially be exploited to cause Denial of Service (DoS) or unexpected application behavior if not carefully designed and tested.
    * **Server-Side Rendering (SSR) Vulnerabilities:** If SSR is used, vulnerabilities in the server-side rendering process could expose server-side code or data if not handled securely.

**2.2. Vue.js CLI:**

* **Architecture & Data Flow Inference:** Vue.js CLI is a command-line tool used by developers during development. It interacts with:
    * **Package Managers (npm, yarn):** To install dependencies.
    * **Build Tools (Vite, Webpack):** To bundle and optimize applications.
    * **Development Server:** To serve applications during development with hot-reloading.
    * **Project Templates:** To scaffold new Vue.js projects.

* **Security Implications:**
    * **Dependency Vulnerabilities:** Vue.js CLI relies on numerous dependencies (build tools, loaders, plugins). Vulnerabilities in these dependencies can be inherited by projects created with the CLI.
        * **Positive Control:** Recommended control: "Implement automated Dependency Vulnerability Scanning".
        * **Potential Risk:**  Delayed updates of CLI dependencies or vulnerabilities in transitive dependencies.
    * **Project Template Vulnerabilities:** If project templates bundled with the CLI contain vulnerabilities (e.g., insecure default configurations, vulnerable dependencies), new projects will inherit these issues.
    * **Build Process Security:**  Insecure configurations of build tools (Vite, Webpack) or plugins used by the CLI could introduce vulnerabilities or weaken application security.
    * **Development Server Exposure:**  If the development server is misconfigured or exposed to the public network, it could become a target for attacks, although primarily a development-time risk.
    * **Supply Chain Attacks (CLI Tooling):**  Compromise of the Vue.js CLI package itself on npm could lead to malicious code being injected into developer environments during project setup or dependency installation.

**2.3. Vue.js Ecosystem Libraries (e.g., Vue Router, Pinia):**

* **Architecture & Data Flow Inference:** Ecosystem libraries extend Vue.js functionality.
    * **Vue Router:** Manages client-side routing and navigation within Vue.js applications.
    * **Pinia (or Vuex):** Provides state management capabilities for complex applications.
    * **Community Libraries:**  A vast array of components and utilities from the community.

* **Security Implications:**
    * **Vulnerabilities in Libraries:** Ecosystem libraries, especially community-contributed ones, may contain security vulnerabilities.
        * **Accepted Risk:** "Potential for vulnerabilities in third-party dependencies used by Vue.js." extends to ecosystem libraries.
        * **Potential Risk:**  Varied security practices across different library authors and maintainers.
    * **Integration Vulnerabilities:**  Improper integration of ecosystem libraries into Vue.js applications can introduce vulnerabilities. For example, misuse of Vue Router's navigation guards or insecure state management practices in Pinia/Vuex.
    * **Community Library Supply Chain:**  Community libraries distributed via npm are also susceptible to supply chain attacks. Compromised libraries could be unknowingly integrated into Vue.js applications.
    * **Lack of Consistent Security Review:** Security review and auditing of community libraries may be less consistent compared to Vue.js Core and official libraries.

### 3. Specific Recommendations for Vue.js Framework Security

Based on the identified security implications and the Security Design Review, here are specific recommendations tailored to the Vue.js framework:

1. ** 강화된 SAST and DAST Integration:**
    * **Recommendation:**  Beyond basic SAST, implement more advanced static analysis tools capable of detecting framework-specific vulnerabilities, such as improper usage of `v-html`, potential reactivity system issues, and SSR-related vulnerabilities. Integrate Dynamic Application Security Testing (DAST) in CI to test built applications for runtime vulnerabilities.
    * **Rationale:**  Proactive identification of vulnerabilities early in the development lifecycle, going beyond basic code scanning. DAST can catch issues missed by SAST and validate security controls in a running application context.

2. **Comprehensive Dependency Security Management:**
    * **Recommendation:** Implement a robust dependency management strategy that includes:
        * **Automated Dependency Vulnerability Scanning:**  Continuously scan direct and transitive dependencies in Vue.js Core, CLI, and official ecosystem libraries.
        * **Dependency Pinning and Reproducible Builds:**  Use dependency pinning (e.g., `package-lock.json`, `yarn.lock`) to ensure consistent builds and reduce the risk of supply chain attacks through dependency updates.
        * **Regular Dependency Audits:**  Conduct periodic manual audits of dependencies, especially for critical components, to assess their security posture and update status.
        * **SBOM (Software Bill of Materials) Generation:** Generate SBOMs for Vue.js releases to provide transparency about dependencies and facilitate vulnerability tracking for users.
    * **Rationale:**  Mitigate the risk of dependency vulnerabilities, a significant concern for modern JavaScript projects. SBOMs enhance transparency and allow downstream users to assess their risk.

3. **Enhanced Security Review Process for Core and Ecosystem Libraries:**
    * **Recommendation:**  Strengthen the security review process for Vue.js Core and official ecosystem libraries:
        * **Dedicated Security Reviewers:**  Involve security experts in code reviews, especially for critical components and security-sensitive areas.
        * **Security-Focused Testing:**  Include specific security test cases in unit and integration tests, covering XSS prevention, input validation, and other relevant security aspects.
        * **Regular Security Audits by External Experts:**  As recommended, conduct periodic security audits and penetration testing by reputable external security firms to identify vulnerabilities that internal reviews might miss. Extend this to official ecosystem libraries as well.
    * **Rationale:**  Proactive security reviews by experts and dedicated security testing can significantly reduce the likelihood of vulnerabilities in core components and official libraries.

4. **Secure Project Template Hardening in Vue CLI:**
    * **Recommendation:**  Harden the default project templates provided by Vue CLI:
        * **CSP Header by Default:**  Include a secure Content Security Policy (CSP) header in the default `index.html` of new projects, demonstrating best practices and encouraging developers to use CSP.
        * **Security Linters and Analyzers in Templates:**  Integrate security-focused linters and static analysis tools (e.g., ESLint plugins for security) into the default project setup to guide developers towards secure coding practices from the start.
        * **Dependency Security in Templates:**  Ensure that the initial dependencies in project templates are up-to-date and free from known vulnerabilities.
    * **Rationale:**  Promote secure defaults and guide developers towards building secure applications from the outset by incorporating security best practices into the project scaffolding provided by Vue CLI.

5. **Formal Vulnerability Disclosure and Response Process:**
    * **Recommendation:**  Formalize and publicize a clear vulnerability disclosure and response process:
        * **Dedicated Security Contact/Channel:**  Establish a dedicated email address or security channel for reporting vulnerabilities.
        * **Public Security Policy:**  Publish a clear security policy outlining the vulnerability reporting process, expected response times, and disclosure timeline.
        * **Security Advisories:**  Issue security advisories for disclosed vulnerabilities, providing details, impact assessment, and mitigation guidance.
        * **Patch Management and Backporting:**  Establish a clear patch management process, including backporting security fixes to older supported versions where feasible.
    * **Rationale:**  Build trust and transparency by having a well-defined process for handling security vulnerabilities. Clear communication and timely responses are crucial for maintaining user confidence.

6. **Community Security Engagement and Education:**
    * **Recommendation:**  Actively engage the Vue.js community in security efforts:
        * **Security Documentation and Best Practices:**  Create comprehensive security documentation and best practices guides for Vue.js developers, covering topics like XSS prevention, secure component development, and dependency management.
        * **Security Workshops and Training:**  Conduct security workshops and training sessions for the community to raise awareness and promote secure coding practices.
        * **Bug Bounty Program (Consideration):**  Explore the feasibility of implementing a bug bounty program to incentivize security researchers to find and report vulnerabilities in Vue.js.
    * **Rationale:**  Leverage the power of the open-source community to enhance security. Education and engagement are key to fostering a security-conscious community around Vue.js.

7. **Release Integrity and Signing:**
    * **Recommendation:** Implement signing of Vue.js releases and artifacts (npm packages):
        * **Package Signing:**  Sign npm packages using tools like `npm sign` or `cosign` to ensure package integrity and authenticity.
        * **Release Verification Documentation:**  Provide clear instructions and documentation on how users can verify the integrity and authenticity of Vue.js releases.
    * **Rationale:**  Protect against supply chain attacks by ensuring the integrity and authenticity of Vue.js packages. Signing provides a mechanism for developers to verify that they are using genuine Vue.js releases.

### 4. Actionable and Tailored Mitigation Strategies

Here are actionable and tailored mitigation strategies applicable to the identified threats, focusing on Vue.js framework development and distribution:

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  * **XSS Vulnerabilities in Vue.js Core:** | **Mitigation:** **Enhanced SAST and DAST Integration (Recommendation 1):** Implement advanced SAST tools to detect potential XSS vulnerabilities in Vue.js Core code itself. Focus SAST rules on areas related to template compilation, DOM manipulation, and reactivity system. Utilize DAST to test rendered applications for XSS vulnerabilities by injecting payloads and observing behavior. **Input Escaping Reinforcement:**  While default escaping is in place, reinforce documentation and developer education on the importance of proper escaping, especially when using directives like `v-html` or rendering user-provided content dynamically. Add automated tests specifically for XSS scenarios in Vue.js Core's test suite.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       