# Deep Analysis: Rigorous Plugin Vetting and Management (oclif-Specific)

## 1. Define Objective, Scope, and Methodology

**Objective:** To thoroughly analyze the "Rigorous Plugin Vetting and Management" mitigation strategy for oclif-based applications, identify potential weaknesses, and propose concrete improvements to enhance its effectiveness.  The goal is to minimize the risk of security vulnerabilities introduced through the oclif plugin system.

**Scope:** This analysis focuses exclusively on the "Rigorous Plugin Vetting and Management" strategy as described.  It covers all aspects of the strategy, including:

*   Examination of the `package.json` manifest (specifically `oclif.commands`, `oclif.hooks`, and dependencies).
*   Risks associated with `oclif plugins link`.
*   The potential for a custom plugin loader.
*   Threats mitigated and their impact.
*   Current and missing implementations.

This analysis *does not* cover other potential mitigation strategies for oclif applications. It also assumes a basic understanding of the oclif framework and Node.js package management.

**Methodology:**

1.  **Review and Decomposition:**  Carefully review the provided description of the mitigation strategy, breaking it down into its constituent parts.
2.  **Threat Modeling:**  For each component of the strategy, identify specific attack vectors and scenarios that could bypass or weaken the mitigation.
3.  **Gap Analysis:**  Compare the described strategy and its current implementation against best practices and identify any gaps or weaknesses.
4.  **Recommendation Generation:**  Propose specific, actionable recommendations to address the identified gaps and improve the overall effectiveness of the strategy.  These recommendations will be prioritized based on their impact and feasibility.
5.  **Code Examples (where applicable):** Provide concrete code examples or configuration snippets to illustrate how to implement the recommendations.

## 2. Deep Analysis

### 2.1. Leverage oclif's Plugin Manifest (`package.json`)

**2.1.1. `oclif.commands` Review**

*   **Threats:**
    *   **Command Injection:**  A plugin could define a command with a name that, when combined with user input, allows for unintended command execution.  For example, a command named `delete --file` could be vulnerable if the `--file` argument is not properly sanitized.
    *   **Command Shadowing:** A plugin command could have the same name as a built-in command or a command from another plugin, leading to unpredictable behavior.  This could be accidental or malicious.
    *   **Overly Broad Permissions:** A command might perform actions that require excessive privileges, increasing the attack surface.

*   **Gap Analysis:** The current implementation lacks a formal review process for `oclif.commands`.  There's no mechanism to ensure command names are safe, don't conflict, and have appropriate permissions.

*   **Recommendations:**
    1.  **Mandatory Code Review:** Implement a mandatory code review step for all new plugins and plugin updates.  This review must specifically examine the `oclif.commands` section of the `package.json`.
    2.  **Command Naming Conventions:** Establish and enforce strict naming conventions for plugin commands.  This could include prefixes or suffixes to prevent collisions and clearly identify the plugin responsible for the command (e.g., `myplugin:delete`).
    3.  **Least Privilege Principle:**  Ensure that commands only request the minimum necessary permissions.  If a command needs to access the file system, restrict it to specific directories or files whenever possible.
    4.  **Automated Scanning:**  Develop a script (or integrate an existing tool) that automatically scans the `package.json` files of all installed plugins and flags potential issues, such as:
        *   Duplicate command names.
        *   Commands with potentially dangerous names (e.g., those containing shell metacharacters).
        *   Commands that don't adhere to the naming conventions.

**2.1.2. `oclif.hooks` Review**

*   **Threats:**
    *   **Hook Hijacking:** A malicious plugin could use a hook to execute arbitrary code at a specific point in the oclif lifecycle, potentially gaining control of the application.
    *   **Data Modification:** A hook could modify data in unexpected ways, leading to data corruption or security vulnerabilities.
    *   **Denial of Service:** A poorly written hook could consume excessive resources or cause the application to crash.

*   **Gap Analysis:**  Similar to `oclif.commands`, there's no formal review process for `oclif.hooks`.  The potential impact of hooks is not systematically assessed.

*   **Recommendations:**
    1.  **Mandatory Code Review:**  Include a thorough review of all hook implementations in the mandatory code review process.  Pay close attention to the code executed within the hook and its potential side effects.
    2.  **Hook Auditing:**  Implement a logging mechanism that records when hooks are executed and by which plugin.  This can help with debugging and identifying malicious hook activity.
    3.  **Hook Sandboxing (Ideal, but Complex):** Explore the possibility of running hooks in a sandboxed environment to limit their access to system resources.  This is a complex undertaking but could significantly improve security.  Consider using technologies like:
        *   **Node.js `vm` module:** Provides a basic level of sandboxing, but it's not considered completely secure.
        *   **WebAssembly (Wasm):**  Offers a more secure sandboxed environment for running code.
        *   **Containers (e.g., Docker):**  Provides the highest level of isolation but adds significant overhead.
    4. **Hook Allowlist/Denylist (If Custom Loader is Implemented):** If a custom plugin loader is implemented (see section 2.3), create an allowlist or denylist to control which plugins are allowed to use specific hooks.

**2.1.3. Dependencies Analysis**

*   **Threats:**
    *   **Supply Chain Attacks:**  A compromised dependency could introduce malicious code into the plugin.
    *   **Vulnerable Dependencies:**  A dependency with known vulnerabilities could be exploited by an attacker.

*   **Gap Analysis:**  While `npm audit` is used during CI/CD, this might not be sufficient.  It doesn't prevent the installation of vulnerable packages, and it relies on the vulnerability database being up-to-date.  Dependency pinning is mentioned but not enforced.

*   **Recommendations:**
    1.  **Enforce Dependency Pinning:**  Use a lockfile (`package-lock.json` or `yarn.lock`) to ensure that the exact same versions of dependencies are installed every time.  This prevents unexpected updates that could introduce vulnerabilities.
    2.  **Regular Dependency Updates:**  Establish a process for regularly updating dependencies to their latest secure versions.  This should be done in a controlled manner, with thorough testing after each update.
    3.  **Vulnerability Scanning Tools:**  Consider using more advanced vulnerability scanning tools that go beyond `npm audit`, such as:
        *   **Snyk:**  A commercial tool that provides comprehensive vulnerability scanning and remediation.
        *   **OWASP Dependency-Check:**  An open-source tool that identifies project dependencies and checks if there are any known, publicly disclosed, vulnerabilities.
    4.  **Software Bill of Materials (SBOM):** Generate and maintain an SBOM for each plugin.  This provides a complete list of all dependencies, making it easier to track and manage vulnerabilities.
    5. **Dependency Allowlist/Denylist:** Maintain a list of approved or blocked dependencies.

### 2.2. oclif Plugin Linking (Development Only)

*   **Threats:**
    *   **Bypassed Security Checks:** Linked plugins bypass standard installation checks, making it easier to introduce malicious or vulnerable code.

*   **Gap Analysis:**  The current implementation lacks specific precautions for `oclif plugins link`.

*   **Recommendations:**
    1.  **Explicit Warnings:**  Display a prominent warning message whenever `oclif plugins link` is used, reminding developers of the security risks.
    2.  **Limited Use:**  Restrict the use of `oclif plugins link` to trusted developers and controlled environments.
    3.  **Manual Review:**  Before linking a plugin, manually review its source code and `package.json` to ensure it's safe.
    4.  **Documentation:** Clearly document the risks of using `oclif plugins link` and the recommended precautions.

### 2.3. Consider a Custom Plugin Loader (Advanced)

*   **Threats:**  This addresses the fundamental limitations of relying solely on oclif's built-in plugin management.

*   **Gap Analysis:**  No custom plugin loader is currently implemented.

*   **Recommendations:**
    1.  **Feasibility Study:**  Conduct a feasibility study to determine the effort required to implement a custom plugin loader and the potential benefits.
    2.  **Design Considerations:**  If a custom loader is deemed feasible, carefully design its architecture, considering:
        *   **Security Checks:**  Implement additional security checks, such as signature verification, code signing, and runtime permission checks.
        *   **Sandboxing:**  Integrate sandboxing mechanisms (as discussed in section 2.1.2) to isolate plugin execution.
        *   **Plugin Metadata:**  Define a custom plugin metadata format that includes additional security-relevant information, such as required permissions and allowed hooks.
        *   **API Control:**  Provide granular control over the oclif APIs that plugins can access.
    3.  **Phased Implementation:**  Implement the custom loader in phases, starting with the most critical security features.
    4. **Example (Conceptual):**

```javascript
// custom-plugin-loader.js (Conceptual Example)

const oclif = require('@oclif/core');
const fs = require('fs');
const crypto = require('crypto');

// Load plugin metadata from a custom file (e.g., plugin.security.json)
function loadPluginMetadata(pluginPath) {
  const metadataPath = path.join(pluginPath, 'plugin.security.json');
  try {
    return JSON.parse(fs.readFileSync(metadataPath, 'utf8'));
  } catch (error) {
    console.error(`Error loading plugin metadata for ${pluginPath}:`, error);
    return null;
  }
}

// Verify plugin signature (example)
function verifyPluginSignature(pluginPath, metadata) {
  // ... (Implementation to verify signature using crypto module) ...
  if (!metadata.signature) return false;

  const signature = metadata.signature;
  const publicKey = fs.readFileSync('./public.pem', 'utf-8'); // Load public key

  const verifier = crypto.createVerify('SHA256');
  verifier.update(fs.readFileSync(path.join(pluginPath, 'package.json'))); // Sign package.json
  const isVerified = verifier.verify(publicKey, signature, 'base64');

  return isVerified;
}

// Custom plugin loading logic
async function loadPlugin(pluginPath) {
  const metadata = loadPluginMetadata(pluginPath);
  if (!metadata) {
    throw new Error(`Plugin ${pluginPath} is missing security metadata.`);
  }

  if (!verifyPluginSignature(pluginPath, metadata)) {
    throw new Error(`Plugin ${pluginPath} signature verification failed.`);
  }

  // Check allowed hooks
  if (metadata.allowedHooks) {
      // Enforce hook restrictions
  }

  // Check required permissions
  if (metadata.requiredPermissions) {
      // Enforce permission restrictions
  }

  // Load the plugin using oclif's default loader
  return oclif.load({root: pluginPath});
}

module.exports = { loadPlugin };

```

This conceptual example demonstrates how a custom loader could:

*   Load additional metadata from a `plugin.security.json` file.
*   Verify a digital signature of the plugin.
*   Enforce restrictions on allowed hooks and required permissions.

This is a *highly simplified* example and would require significant development effort to implement fully.

## 3. Summary of Recommendations

| Recommendation                                      | Priority | Feasibility | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                
#include " "main.                                                              
                                                                #include "main.h