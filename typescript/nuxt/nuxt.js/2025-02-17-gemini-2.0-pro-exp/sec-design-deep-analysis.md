Okay, let's perform a deep security analysis of Nuxt.js based on the provided design review.

**1. Objective, Scope, and Methodology**

*   **Objective:** To conduct a thorough security analysis of key components of the Nuxt.js framework and applications built upon it, identifying potential vulnerabilities and providing actionable mitigation strategies.  This analysis focuses on the framework's inherent characteristics and how they impact application security, *not* general web application security best practices (though those are still relevant).  We aim to identify Nuxt.js *specific* security concerns.

*   **Scope:**
    *   Nuxt.js core framework (version 3.x, as it's the current stable version).
    *   Server-Side Rendering (SSR) and Static Site Generation (SSG) modes.
    *   Common Nuxt.js modules and their interaction with the core.
    *   Data flow between client, server, and external services (APIs, databases).
    *   Deployment scenarios outlined in the design document (AWS EC2 with SSR).
    *   Build process using GitHub Actions.

*   **Methodology:**
    1.  **Component Breakdown:** Analyze the security implications of key Nuxt.js components identified in the design review and inferred from the framework's architecture.
    2.  **Threat Modeling:** Identify potential threats specific to each component and its interactions.
    3.  **Code Review (Conceptual):**  Since we don't have direct access to a specific application's codebase, we'll conceptually review common Nuxt.js patterns and practices based on the official documentation and community resources. This is a *high-level* code review approach.
    4.  **Mitigation Strategies:**  Propose specific, actionable mitigation strategies tailored to Nuxt.js and the identified threats.
    5.  **Focus on Nuxt.js Specifics:**  Prioritize vulnerabilities and mitigations that are unique to or exacerbated by Nuxt.js's architecture and features.

**2. Security Implications of Key Components**

Let's break down the key components and their security implications:

*   **2.1 Nuxt.js Server (Node.js) - `C["Nuxt.js Server (Node.js)"]` in Container Diagram:**

    *   **Architecture:** This is the core of the SSR functionality.  It's a Node.js server that handles incoming requests, renders Vue.js components on the server, and sends the resulting HTML to the client.  It also manages API calls, data fetching, and routing.
    *   **Threats:**
        *   **XSS (Cross-Site Scripting):**  The *most critical* threat in SSR.  If user-supplied data is not properly escaped before being rendered into the HTML on the server, an attacker can inject malicious JavaScript that will be executed in the user's browser.  This is *more* dangerous in SSR than in a traditional SPA because the initial HTML is rendered on the server, bypassing some browser-based XSS protections.
        *   **CSRF (Cross-Site Request Forgery):**  If the Nuxt server handles state-changing operations (e.g., form submissions), it needs to be protected against CSRF.  An attacker could trick a user into submitting a malicious request to the server.
        *   **Injection Attacks (SQL, NoSQL, Command):** If the server interacts with databases or external systems, it's vulnerable to injection attacks if user input is not properly sanitized.
        *   **Denial of Service (DoS):**  The Node.js server can be overwhelmed by malicious requests, making the application unavailable.
        *   **Sensitive Data Exposure:**  Improper error handling or logging could expose sensitive data (API keys, database credentials, internal server errors) to attackers.
        *   **Unvalidated Redirects and Forwards:**  If the server uses user input to determine redirect URLs, attackers could redirect users to malicious sites.
        *   **Node.js Specific Vulnerabilities:**  Vulnerabilities in the Node.js runtime or installed npm packages can be exploited.

    *   **Mitigation Strategies:**
        *   **Output Encoding (Crucial for XSS):**  Use Nuxt's built-in escaping mechanisms (which leverage Vue.js's capabilities) *religiously*.  Understand the context (HTML, attribute, JavaScript, CSS) and use the appropriate escaping function.  `v-html` should be avoided unless absolutely necessary and only with thoroughly sanitized data.  Prefer template interpolation (`{{ }}`) which automatically escapes HTML.
        *   **Content Security Policy (CSP):**  Implement a strict CSP to limit the sources from which the browser can load resources (scripts, styles, images, etc.).  This is a *critical* defense-in-depth measure against XSS.  Use the `nuxt.config.js` file to configure HTTP headers, including CSP.
        *   **CSRF Protection:**  Use a CSRF protection library like `csurf` or a similar module.  Ensure that all state-changing requests (POST, PUT, DELETE) require a valid CSRF token.  Nuxt 3, being built on Nitro, may require specific integration with Nitro's request handling.
        *   **Input Validation and Sanitization:**  Validate *all* user input on the server-side, using a robust validation library (e.g., `joi`, `express-validator`).  Use a whitelist approach whenever possible.  Sanitize data to remove potentially harmful characters.
        *   **Parameterized Queries:**  When interacting with databases, *always* use parameterized queries (prepared statements) to prevent SQL injection.  Never concatenate user input directly into SQL queries.
        *   **Rate Limiting:**  Implement rate limiting to mitigate DoS attacks.  Use a middleware or module to limit the number of requests from a single IP address or user.
        *   **Secure Error Handling:**  Avoid exposing sensitive information in error messages.  Log errors securely, using a dedicated logging library.
        *   **Validated Redirects:**  If using redirects, ensure the target URL is validated against a whitelist of allowed URLs.
        *   **Dependency Management:**  Regularly update npm packages to patch vulnerabilities.  Use `npm audit` or `yarn audit` to identify known vulnerabilities.  Consider using tools like Snyk to automate dependency vulnerability scanning.
        *   **HTTP Security Headers:** Set appropriate HTTP security headers (e.g., `Strict-Transport-Security`, `X-Frame-Options`, `X-Content-Type-Options`, `X-XSS-Protection`) in `nuxt.config.js`.
        * **Nuxt Security Module:** Utilize the official `@nuxtjs/security` module. This module provides easy configuration for many of the above mitigations, including CSP, CSRF protection (via integration with other modules), and setting various security headers.

*   **2.2 Vue.js - `H["Vue.js"]` in Container Diagram:**

    *   **Architecture:** Vue.js is the client-side framework used by Nuxt.js.  While Vue.js itself has good built-in XSS protection, Nuxt's SSR capabilities introduce additional considerations.
    *   **Threats:**
        *   **Client-Side XSS:**  Even with SSR, client-side XSS is still possible if data is mishandled on the client.  For example, if data fetched from an API is rendered directly into the DOM without proper escaping.
        *   **DOM Manipulation Vulnerabilities:**  Improper use of Vue.js directives like `v-html` can lead to XSS.
        *   **Third-Party Vue.js Components:**  Vulnerabilities in third-party Vue.js components can be exploited.

    *   **Mitigation Strategies:**
        *   **Consistent Escaping:**  Maintain consistent escaping practices on both the server and the client.  Use Vue.js's built-in escaping mechanisms (template interpolation, `v-bind` for attributes).
        *   **Avoid `v-html`:**  Minimize the use of `v-html`.  If it's necessary, ensure the data is thoroughly sanitized.
        *   **Vet Third-Party Components:**  Carefully vet any third-party Vue.js components before using them.  Check for known vulnerabilities and ensure they are actively maintained.
        *   **Keep Vue.js Updated:**  Regularly update Vue.js to the latest version to benefit from security patches.

*   **2.3 Nuxt.js Modules - `I["Nuxt.js Modules"]` in Container Diagram:**

    *   **Architecture:** Nuxt.js has a rich ecosystem of modules that extend its functionality.  These modules can interact with the server, the client, or both.
    *   **Threats:**
        *   **Vulnerabilities in Modules:**  Modules themselves can contain vulnerabilities, just like any other software.
        *   **Supply Chain Attacks:**  An attacker could compromise a module's repository and inject malicious code.
        *   **Improper Module Configuration:**  Misconfiguring a module can lead to security vulnerabilities.

    *   **Mitigation Strategies:**
        *   **Use Official Modules:**  Prefer official Nuxt.js modules whenever possible, as they are more likely to be well-maintained and secure.
        *   **Vet Community Modules:**  Carefully vet any community modules before using them.  Check for known vulnerabilities, the number of downloads, the last update date, and the responsiveness of the maintainers.
        *   **Regularly Update Modules:**  Keep all modules updated to the latest versions.
        *   **Review Module Source Code (if possible):**  For critical modules, consider reviewing the source code to identify potential security issues.
        *   **Use a Software Composition Analysis (SCA) Tool:**  Tools like Snyk can scan your project's dependencies (including Nuxt.js modules) for known vulnerabilities.

*   **2.4 API Client - `D["API Client"]` in Container Diagram:**

    *   **Architecture:** This component handles communication with external APIs.  It could be a library like `axios` or the built-in `$fetch` utility in Nuxt 3.
    *   **Threats:**
        *   **Man-in-the-Middle (MitM) Attacks:**  If API requests are not made over HTTPS, an attacker could intercept and modify the data.
        *   **API Key Exposure:**  If API keys are hardcoded in the client-side code, they can be easily exposed.
        *   **Data Leakage:**  Sensitive data sent to or received from APIs could be leaked if not handled securely.

    *   **Mitigation Strategies:**
        *   **Always Use HTTPS:**  Ensure that all API requests are made over HTTPS.
        *   **Secure API Key Management:**  Never hardcode API keys in the client-side code.  Use environment variables on the server and access them securely within your Nuxt.js application.  Consider using a secrets management service (e.g., AWS Secrets Manager, HashiCorp Vault).
        *   **Validate API Responses:**  Validate the data received from APIs to ensure it conforms to the expected format and doesn't contain any malicious content.
        *   **Use Nuxt's `$fetch` (with caution):** Nuxt 3's `$fetch` is a powerful utility, but be mindful of its automatic key generation and serialization. Ensure you understand how it handles data to prevent unintended exposure.

*   **2.5 Database Client - `F["Database Client"]` in Container Diagram:**

    *   **Architecture:** This component handles communication with the database.
    *   **Threats:**
        *   **SQL Injection:**  The primary threat if user input is not properly sanitized before being used in database queries.
        *   **NoSQL Injection:**  Similar to SQL injection, but applies to NoSQL databases.
        *   **Unauthorized Access:**  If database credentials are compromised, an attacker could gain unauthorized access to the database.

    *   **Mitigation Strategies:**
        *   **Parameterized Queries (Prepared Statements):**  *Always* use parameterized queries to prevent SQL injection.
        *   **ORM (Object-Relational Mapper):**  Consider using an ORM (e.g., Sequelize, TypeORM) to abstract away database interactions and reduce the risk of SQL injection.  However, ensure the ORM itself is configured securely and kept up-to-date.
        *   **Input Validation and Sanitization:**  Validate and sanitize all user input before using it in database queries, even when using an ORM.
        *   **Secure Database Credentials:**  Store database credentials securely, using environment variables or a secrets management service.  Never hardcode them in the application code.
        *   **Least Privilege:**  Grant the database user only the necessary permissions to access and modify the required data.

* **2.6 Static Site Generation (SSG):**

    * **Architecture:** Nuxt.js generates static HTML files at build time. These files are then served directly to the user, without requiring a Node.js server to render them on demand.
    * **Threats:**
        * **Stale Data:** If the data used to generate the static site changes, the site will serve outdated information until it's rebuilt.
        * **Limited Dynamic Functionality:** SSG is not suitable for applications that require highly dynamic content or user-specific data.
        * **Build-Time Vulnerabilities:** Vulnerabilities in the build process or dependencies could be exploited to inject malicious code into the generated static files.
        * **Exposure of Sensitive Data in Build Output:** If sensitive data is accidentally included in the build output, it will be publicly accessible.

    * **Mitigation Strategies:**
        * **Incremental Static Regeneration (ISR):** Use Nuxt's ISR capabilities to regenerate pages at a specified interval or on demand, keeping the content fresh.
        * **Hybrid Approach:** Combine SSG with SSR or client-side rendering for dynamic parts of the application.
        * **Secure Build Process:** Implement security controls in the build process (see the "Build" section in the design review).
        * **Review Build Output:** Carefully review the generated static files to ensure they don't contain any sensitive data.
        * **Use Environment Variables:** Store sensitive data in environment variables and access them during the build process. Do *not* embed them directly in the code.

* **2.7 Deployment (AWS EC2 with SSR):**

    * **Architecture:** The Nuxt.js application runs on a Node.js server hosted on an AWS EC2 instance.
    * **Threats:**
        * **Server Vulnerabilities:** Vulnerabilities in the operating system, Node.js runtime, or other software running on the EC2 instance can be exploited.
        * **Network Attacks:** The EC2 instance is exposed to network attacks, such as DDoS attacks.
        * **Unauthorized Access:** If the EC2 instance is not properly secured, an attacker could gain unauthorized access.

    * **Mitigation Strategies:**
        * **Regularly Patch the OS and Software:** Keep the operating system, Node.js runtime, and all other software on the EC2 instance up-to-date with the latest security patches.
        * **Use a Firewall:** Configure a security group to restrict network access to the EC2 instance. Only allow necessary inbound and outbound traffic.
        * **Use a WAF (Web Application Firewall):** Deploy a WAF (e.g., AWS WAF) in front of the Application Load Balancer to protect against common web attacks.
        * **Implement Intrusion Detection and Prevention Systems (IDPS):** Use IDPS tools to monitor for and respond to malicious activity.
        * **Secure SSH Access:** Use SSH keys instead of passwords for SSH access to the EC2 instance. Disable root login.
        * **IAM Roles:** Use IAM roles to grant the EC2 instance the necessary permissions to access other AWS services. Avoid using access keys and secret keys directly on the instance.
        * **Monitoring and Logging:** Monitor the EC2 instance for suspicious activity and log all relevant events.

* **2.8 Build Process (GitHub Actions):**

    * **Architecture:** GitHub Actions is used to automate the build, test, and deployment process.
    * **Threats:**
        * **Compromised CI/CD Pipeline:** An attacker could gain access to the GitHub Actions workflow and inject malicious code.
        * **Vulnerable Dependencies:** The build process itself might use vulnerable dependencies.
        * **Exposure of Secrets:** Secrets (e.g., API keys, deployment credentials) stored in the CI/CD environment could be exposed.

    * **Mitigation Strategies:**
        * **Secure GitHub Repository Access:** Use strong passwords and enable two-factor authentication for all GitHub accounts. Restrict access to the repository using appropriate permissions.
        * **Review GitHub Actions Workflow:** Carefully review the GitHub Actions workflow file to ensure it's secure and doesn't contain any vulnerabilities.
        * **Use a Secure Build Environment:** Use a dedicated build environment that is isolated from other systems.
        * **Scan Dependencies:** Use a dependency analysis tool (e.g., Snyk) to scan for vulnerabilities in the build process dependencies.
        * **Securely Store Secrets:** Use GitHub Actions secrets to store sensitive data. Never hardcode secrets in the workflow file.
        * **Regularly Audit the CI/CD Pipeline:** Regularly audit the CI/CD pipeline for security vulnerabilities.
        * **Least Privilege for Actions:** Grant only the minimum necessary permissions to GitHub Actions.

**3. Actionable Mitigation Strategies (Summary and Nuxt.js Specifics)**

This table summarizes the key mitigation strategies, highlighting those that are particularly important or unique to Nuxt.js:

| Threat Category        | Mitigation Strategy                                                                                                                                                                                                                                                                                          | Nuxt.js Specific Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     