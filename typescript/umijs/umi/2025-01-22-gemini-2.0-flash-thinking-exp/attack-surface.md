# Attack Surface Analysis for umijs/umi

## Attack Surface: [Exposed Umi Dev Server](./attack_surfaces/exposed_umi_dev_server.md)

*   **Description:** The Umi development server, intended for local development, is unintentionally accessible from public networks due to default configuration or misconfiguration.
    *   **Umi Contribution:** `umi dev` command initiates the server, and its default behavior or configuration options can lead to public exposure if not explicitly restricted to `localhost`. Umi's ease of use might lead to overlooking security configurations in development environments.
    *   **Example:** Running `umi dev` without specifying `--host localhost` on a machine connected to a public network makes the development server accessible to anyone on that network.
    *   **Impact:**  **Critical**. Remote attackers can access development-specific endpoints, potentially revealing sensitive source code, configuration, and potentially achieving remote code execution if vulnerabilities exist in the dev server tooling or plugins.
    *   **Risk Severity:** Critical
    *   **Mitigation Strategies:**
        *   **Explicitly Bind to `localhost`:** Always start the dev server with `umi dev --host localhost` or configure `devServer.host: 'localhost'` within Umi configuration files (`.umirc.ts` or `config/config.ts`).
        *   **Network Isolation:** Ensure development machines are behind a firewall and not directly exposed to public networks. Use VPNs for remote development access.
        *   **Regular Security Audits of Dev Environment:** Treat the development environment with security considerations, regularly reviewing network configurations and exposed services.

## Attack Surface: [Source Map Exposure in Production](./attack_surfaces/source_map_exposure_in_production.md)

*   **Description:** Source map files (`.map`), generated by Umi's build process by default in development, are unintentionally deployed to production environments and are publicly accessible.
    *   **Umi Contribution:** Umi's default build process in development includes source map generation. Developers must explicitly configure production builds to disable source maps, and ensure deployment pipelines exclude these files.
    *   **Example:** After `umi build`, the `dist` folder containing `.js.map` files is deployed to a production web server. Attackers can access these files via predictable URLs (e.g., `https://example.com/static/js/main.js.map`).
    *   **Impact:** **High**. Information disclosure of the complete application source code. This significantly aids attackers in reverse engineering, understanding application logic, and identifying potential vulnerabilities much more easily.
    *   **Risk Severity:** High
    *   **Mitigation Strategies:**
        *   **Disable Source Maps in Production Build Configuration:**  Within Umi configuration (`.umirc.ts` or `config/config.ts`), explicitly set `devtool: false` for production environments.
        *   **Production Build Verification:**  After building for production (`umi build`), verify that the output `dist` folder does not contain `.map` files before deployment.
        *   **Web Server Configuration to Block Access:** Configure the production web server (e.g., Nginx, Apache) to explicitly deny access to `.map` files using file extension blocking or access control rules.

## Attack Surface: [Vulnerable Umi Plugins (Direct & Transitive)](./attack_surfaces/vulnerable_umi_plugins__direct_&_transitive_.md)

*   **Description:**  Umi plugins, either directly used or their dependencies (transitive dependencies), contain security vulnerabilities that can be exploited in the application.
    *   **Umi Contribution:** Umi's plugin ecosystem is a core feature, encouraging extensibility. However, reliance on third-party plugins introduces supply chain risks. Umi's plugin system executes plugin code during build and runtime, making vulnerabilities impactful.
    *   **Example:** A popular Umi plugin for SEO or analytics has a known XSS vulnerability in its client-side code. Applications using this plugin become vulnerable to XSS attacks through the plugin's code.
    *   **Impact:** **High to Critical**. Depending on the vulnerability and the plugin's functionality, impacts can range from XSS and client-side attacks to more severe issues like code injection, data exfiltration, or even server-side vulnerabilities if plugins interact with backend services.
    *   **Risk Severity:** High to Critical
    *   **Mitigation Strategies:**
        *   **Thorough Plugin Vetting:**  Before adopting any Umi plugin, rigorously vet it for security. Check plugin maintainership, update frequency, community reputation, and known vulnerability databases.
        *   **Dependency Scanning for Plugins:** Use dependency scanning tools (e.g., `npm audit`, `yarn audit`, Snyk) to identify vulnerabilities in both direct and transitive dependencies of Umi plugins.
        *   **Principle of Least Privilege for Plugins:**  Only use plugins that are absolutely necessary. Avoid plugins with excessive permissions or broad functionality that is not required.
        *   **Regular Plugin Updates & Monitoring:** Keep Umi plugins updated to the latest versions to patch known vulnerabilities. Monitor security advisories related to Umi plugins and their dependencies.

## Attack Surface: [Misconfigured Security Headers due to Umi Configuration Overrides](./attack_surfaces/misconfigured_security_headers_due_to_umi_configuration_overrides.md)

*   **Description:**  Developers, through Umi's configuration system, inadvertently weaken or remove default security headers that Umi or best practices would recommend, leading to a reduced client-side security posture.
    *   **Umi Contribution:** Umi provides a flexible configuration system that allows developers to customize or override default behaviors, including security headers.  Misunderstanding or incorrect configuration can weaken security.
    *   **Example:** A developer, aiming for easier development or perceived compatibility, removes or weakens the `Content-Security-Policy` header in `.umirc.ts` or server configuration, making the application more susceptible to XSS attacks.
    *   **Impact:** **High**. Increased vulnerability to a range of client-side attacks, most notably Cross-Site Scripting (XSS), but also clickjacking, MIME-sniffing attacks, and others, depending on the specific header misconfiguration.
    *   **Risk Severity:** High
    *   **Mitigation Strategies:**
        *   **Understand Umi's Default Security Headers:** Be aware of any default security headers Umi sets and the security benefits they provide.
        *   **Cautious Header Customization:** When customizing security headers via Umi configuration or server settings, thoroughly understand the implications of each header and ensure changes strengthen, not weaken, security.
        *   **Security Header Validation & Testing:** Use online security header analyzers to validate the deployed application's headers and identify any missing or misconfigured headers. Regularly test header configurations after changes.
        *   **Adopt Strong Security Header Policies:** Implement robust security headers based on best practices, including a properly configured `Content-Security-Policy`, `Strict-Transport-Security`, `X-Frame-Options`, `X-Content-Type-Options`, and `Referrer-Policy`.

## Attack Surface: [Public Folder Information Disclosure of Sensitive Data](./attack_surfaces/public_folder_information_disclosure_of_sensitive_data.md)

*   **Description:** Sensitive files, not intended for public access, are mistakenly placed within Umi's `public` folder and become directly accessible to anyone visiting the application.
    *   **Umi Contribution:** Umi's design designates the `public` folder for serving static assets directly. This clear separation, while convenient, can lead to accidental placement of sensitive files if developers misunderstand its purpose or lack vigilance.
    *   **Example:** Developers inadvertently place backup database files, internal API documentation, or configuration files containing API keys within the `public` folder. These files become accessible via URLs like `https://example.com/database.sql.backup`.
    *   **Impact:** **Critical**. Information disclosure of highly sensitive data, including database backups, API keys, internal documentation, or configuration details. This can lead to direct compromise of backend systems, data breaches, and further attacks.
    *   **Risk Severity:** Critical
    *   **Mitigation Strategies:**
        *   **Strictly Control `public` Folder Content & Purpose:** Clearly define and communicate the purpose of the `public` folder solely for publicly accessible static assets. Educate developers on what *should not* be placed there.
        *   **Regular Audits of `public` Folder:** Implement regular audits of the `public` folder content to identify and remove any unintended or sensitive files. Automate this process if possible.
        *   **`.gitignore` for Sensitive Files in `public`:**  Utilize `.gitignore` to explicitly prevent accidental committing of sensitive file types (e.g., `.sql`, `.backup`, `.env`, `.key`, `.pem`) within the `public` folder to version control.
        *   **Separate Storage for Non-Public Assets:** Store sensitive or non-public assets outside of the `public` folder and serve them through controlled server-side logic with proper authentication and authorization mechanisms if needed.

## Attack Surface: [Outdated Umi Core Framework Leading to Exploitable Vulnerabilities](./attack_surfaces/outdated_umi_core_framework_leading_to_exploitable_vulnerabilities.md)

*   **Description:**  Failure to regularly update the Umi core framework packages leaves the application running on versions with known security vulnerabilities that have been patched in newer releases.
    *   **Umi Contribution:**  As a framework, Umi's core packages are the foundation of the application.  Staying updated with Umi releases is crucial for receiving security patches and bug fixes. Neglecting updates directly exposes the application to known Umi-specific vulnerabilities.
    *   **Example:** A critical security vulnerability is discovered and patched in a specific version range of Umi core. Applications running within that vulnerable range, without updating, remain susceptible to exploitation.
    *   **Impact:** **High to Critical**. Exploitation of known vulnerabilities within the Umi framework itself can lead to a wide range of severe impacts, including remote code execution, server-side vulnerabilities, bypass of security controls, and data breaches, depending on the nature of the vulnerability.
    *   **Risk Severity:** High to Critical
    *   **Mitigation Strategies:**
        *   **Establish a Regular Umi Update Cycle:** Implement a process for regularly updating Umi core packages and related dependencies. Schedule updates proactively, not just reactively to security alerts.
        *   **Monitor Umi Security Advisories & Release Notes:** Actively monitor Umi's official channels (release notes, security advisories, GitHub repository) for announcements of security patches and updates.
        *   **Automated Dependency Updates & Testing:** Consider using automated dependency update tools and integrate automated testing into the update process to ensure updates are applied smoothly and without regressions.
        *   **Stay within Supported Umi Versions:**  Ensure the application is running on a currently supported version of Umi that receives security updates. Avoid using outdated or end-of-life Umi versions.

