# Attack Surface Analysis for filosottile/mkcert

## Attack Surface: [Compromised Root CA Private Key](./attack_surfaces/compromised_root_ca_private_key.md)

**Description:** Unauthorized access to the private key of the root Certificate Authority (CA) generated by `mkcert`.

**How mkcert Contributes:** `mkcert` generates and stores this root CA key, making its security a direct responsibility of the user.

**Example:** A developer's machine is compromised, and the attacker gains access to the `rootCA.key` file. They can then generate valid-looking certificates for any domain.

**Impact:** An attacker can perform man-in-the-middle attacks against developers or testers, intercepting sensitive data or injecting malicious content. They can also impersonate internal services.

**Risk Severity:** Critical

**Mitigation Strategies:**
* Securely store the root CA private key with restricted access permissions (e.g., only the user account running `mkcert` should have read access).
* Avoid committing the root CA private key to version control systems.
* Consider using hardware security modules (HSMs) for storing the root CA key in highly sensitive environments (though less common for local development).
* Regularly review and restrict access to the directory containing the root CA key and certificates.

## Attack Surface: [Persistence of Trust](./attack_surfaces/persistence_of_trust.md)

**Description:** Once the `mkcert` root CA is installed into the system's trust store, it remains trusted until explicitly removed.

**How mkcert Contributes:** `mkcert` automates the process of adding its root CA to the system's trusted certificate authorities.

**Example:** A developer installs the `mkcert` root CA. Later, their machine is compromised. The attacker can leverage the already trusted root CA to generate malicious certificates that the system will inherently trust.

**Impact:** Increases the window of opportunity for attackers. Even if `mkcert` is no longer actively used, the trust remains.

**Risk Severity:** High

**Mitigation Strategies:**
* Educate developers on the implications of installing the root CA and the importance of system security.
* Consider using temporary or isolated environments for development where the root CA is installed, and remove it when no longer needed.
* Implement robust security measures on developer machines to prevent compromise.
* Regularly review the system's trusted certificate authorities and remove any unnecessary or outdated entries.

## Attack Surface: [Accidental Distribution of Generated Certificates' Private Keys](./attack_surfaces/accidental_distribution_of_generated_certificates'_private_keys.md)

**Description:** Unintentional sharing or distribution of the private keys for certificates generated by `mkcert` for specific domains.

**How mkcert Contributes:** `mkcert` generates these key pairs, and developers need to manage their storage.

**Example:** A developer accidentally commits a certificate's private key file (`_wildcard.example.com+*.pem`) to a public Git repository. Anyone with access to the repository can now impersonate `example.com`.

**Impact:** Allows unauthorized individuals to impersonate services, potentially leading to data breaches or unauthorized actions.

**Risk Severity:** High

**Mitigation Strategies:**
* Strictly avoid committing private key files to version control systems. Use `.gitignore` to exclude these files.
* Store private keys securely with appropriate file permissions.
* Implement secure key management practices.

