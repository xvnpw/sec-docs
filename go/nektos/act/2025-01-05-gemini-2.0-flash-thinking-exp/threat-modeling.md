# Threat Model Analysis for nektos/act

## Threat: [Malicious Workflow Execution leading to Local System Compromise](./threats/malicious_workflow_execution_leading_to_local_system_compromise.md)

**Threat:** Malicious Workflow Execution leading to Local System Compromise

**Description:** An attacker, either an insider or someone who has gained access to the codebase, crafts a malicious workflow file. When a developer executes this workflow locally using `act`, **`act`'s Job/Step Executor** executes the embedded commands within the Docker container, potentially escaping the container or directly impacting the host system. This could involve installing malware, deleting files, or gaining unauthorized access to local resources.

**Impact:** Complete compromise of the developer's local machine, including data loss, malware infection, and potential lateral movement to other systems if the compromised machine has network access.

**Affected Component:**
* `act`'s Workflow Parser
* `act`'s Job/Step Executor

**Risk Severity:** Critical

**Mitigation Strategies:**
* Code Review for Workflows
* Principle of Least Privilege in Workflows
* Use of Static Analysis Tools
* Isolated Testing Environment
* Regular Security Training

## Threat: [Exposure of Secrets in Local `act` Execution](./threats/exposure_of_secrets_in_local__act__execution.md)

**Threat:** Exposure of Secrets in Local `act` Execution

**Description:** Developers might inadvertently log or expose sensitive secrets (API keys, passwords, etc.) when running workflows locally using `act`. This can happen through printing secrets to the console by **`act`'s Logging Mechanism**, storing them in local logs generated by `act`, or through actions that unintentionally expose these secrets during execution by **`act`'s Action Executor**. An attacker gaining access to the developer's machine or these logs could retrieve the secrets.

**Impact:** Unauthorized access to sensitive resources or services protected by the exposed secrets. This could lead to data breaches, financial loss, or reputational damage.

**Affected Component:**
* `act`'s Environment Variable Handling
* `act`'s Logging Mechanism
* `act`'s Action Executor

**Risk Severity:** High

**Mitigation Strategies:**
* Avoid Using Production Secrets Locally
* Secret Masking in Logs
* Secure Storage of Local Secrets
* Regularly Review `act` Logs
* Educate Developers on Secure Secret Handling

## Threat: [Dependency on Malicious or Vulnerable Docker Images](./threats/dependency_on_malicious_or_vulnerable_docker_images.md)

**Threat:** Dependency on Malicious or Vulnerable Docker Images

**Description:** Workflows executed by `act` rely on Docker images specified in the `runs-on` directive or within action definitions. If a workflow uses a malicious or vulnerable Docker image, **`act`'s Docker Image Puller** will download it, and **`act`'s Container Runtime Interface** will run containers based on it, potentially introducing vulnerabilities or malware into the developer's environment.

**Impact:** Introduction of malware or vulnerabilities into the developer's local system, potentially leading to data breaches, system instability, or further attacks.

**Affected Component:**
* `act`'s Docker Image Puller
* `act`'s Container Runtime Interface

**Risk Severity:** High

**Mitigation Strategies:**
* Use Trusted Docker Registries
* Verify Image Hashes
* Regularly Scan Docker Images for Vulnerabilities
* Pin Docker Image Versions
* Implement a Private Docker Registry

## Threat: [Execution of Compromised or Malicious Actions](./threats/execution_of_compromised_or_malicious_actions.md)

**Threat:** Execution of Compromised or Malicious Actions

**Description:** Workflows often utilize reusable actions from the GitHub Marketplace or custom actions. If a workflow uses a compromised or malicious action, **`act`'s Action Downloader** will retrieve the code, and **`act`'s Action Executor** will run it locally, potentially executing harmful code on the developer's machine.

**Impact:** Similar to malicious workflow execution, this could lead to local system compromise, data loss, or malware infection.

**Affected Component:**
* `act`'s Action Downloader
* `act`s Action Executor

**Risk Severity:** High

**Mitigation Strategies:**
* Carefully Review Action Source Code
* Pin Action Versions
* Monitor Action Updates
* Use Actions from Verified Publishers
* Consider Self-Hosting Actions

## Threat: [Access to Sensitive Host Files via Volume Mounts](./threats/access_to_sensitive_host_files_via_volume_mounts.md)

**Threat:** Access to Sensitive Host Files via Volume Mounts

**Description:** Workflows executed by `act` might mount volumes from the host machine into the container. If these mounts are not carefully configured, a malicious workflow, when executed by **`act`'s Volume Mount Handling**, could gain unauthorized access to sensitive files or directories on the developer's system.

**Impact:** Exposure or modification of sensitive data on the developer's local machine.

**Affected Component:**
* `act`'s Volume Mount Handling

**Risk Severity:** High

**Mitigation Strategies:**
* Minimize Volume Mounts
* Use Specific Paths for Mounts
* Read-Only Mounts
* Regularly Review Volume Mount Configurations

