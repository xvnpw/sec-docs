
## High and Critical FRP Threats

| Threat | Description (Attacker Action & Method) | Impact | Affected FRP Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **FRP Server Authentication Bypass** | Attacker exploits a vulnerability in the FRP server (`frps`) authentication mechanism to connect without valid credentials. This could involve exploiting flaws in token generation, validation, or default configurations. | Full control over the FRP server, ability to create or modify tunnels, potentially gaining access to internal network services. | `frps` process, authentication module | **Critical** | - **Strong Authentication:** Enforce strong authentication mechanisms like tokens or TLS client certificates. Avoid default or weak secrets. <br> - **Regular Updates:** Keep the FRP server software updated to patch known vulnerabilities. <br> - **Secure Configuration:** Review and harden the FRP server configuration, disabling unnecessary features. |
| **FRP Server Resource Exhaustion (DoS)** | Attacker floods the FRP server (`frps`) with connection requests or malicious traffic, overwhelming its resources (CPU, memory, network). This can prevent legitimate clients from connecting and accessing internal services. | Denial of service, preventing access to internal applications exposed through FRP. | `frps` process, network handling | **High** | - **Rate Limiting:** Implement rate limiting on connection attempts and traffic volume. <br> - **Resource Limits:** Configure appropriate resource limits for the FRP server process. <br> - **Network Security:** Utilize firewalls and intrusion prevention systems to filter malicious traffic. |
| **FRP Server Configuration Tampering** | Attacker gains unauthorized access to the FRP server's configuration file (e.g., `frps.ini`) and modifies it. This could involve changing listener ports, authentication settings, or allowed clients. | Redirection of traffic, exposure of unintended services, unauthorized access, or denial of service. | `frps` configuration file | **High** | - **Secure File Permissions:** Restrict access to the FRP server configuration file to authorized users only. <br> - **Configuration Management:** Use secure methods for managing and deploying the configuration file. <br> - **Monitoring:** Monitor changes to the configuration file. |
| **FRP Client Credential Theft** | Attacker compromises the host where the FRP client (`frpc`) is running and steals the authentication credentials (e.g., authentication token) used to connect to the FRP server. | Ability to impersonate the legitimate client, create or modify tunnels, potentially gaining access to internal network services. | `frpc` configuration file, memory | **High** | - **Secure Host:** Harden the host where the FRP client is running, including strong passwords, regular security updates, and endpoint security software. <br> - **Secure Storage:** Protect the FRP client configuration file with appropriate permissions. Consider encrypting the configuration file. <br> - **Credential Rotation:** Implement a mechanism for rotating FRP client credentials. |
| **Compromised FRP Client as Pivot Point** | Attacker compromises an FRP client (`frpc`) host and uses it as a pivot point to access other internal network resources that are managed or accessible through that client's network context. | Lateral movement within the internal network, access to sensitive data and systems. | `frpc` process, client host | **High** | - **Network Segmentation:** Isolate the FRP client within a restricted network segment. <br> - **Principle of Least Privilege:** Only grant the FRP client host the necessary permissions and network access. <br> - **Endpoint Security:** Implement robust endpoint security measures on the FRP client host. |
| **Man-in-the-Middle (MITM) Attack on FRP Communication** | Attacker intercepts the communication between the FRP client (`frpc`) and server (`frps`) if TLS encryption is not enforced or is improperly configured. This allows them to eavesdrop on traffic and potentially modify it. | Information disclosure (sensitive data transmitted through tunnels), potential for traffic manipulation and redirection. | Network communication between `frpc` and `frps` | **High** | - **Enforce TLS Encryption:** Always configure and enforce TLS encryption for all communication between FRP clients and the server. <br> - **Verify Certificates:** Ensure proper certificate validation is in place to prevent using self-signed or untrusted certificates. |
| **Unauthorized Tunnel Creation/Modification** | Attacker gains unauthorized access to the FRP server (through a vulnerability or compromised credentials) and creates or modifies tunnels to expose internal services they shouldn't have access to. | Exposure of unintended internal services, potential for unauthorized access and exploitation of those services. | `frps` process, tunnel management | **High** | - **Strong Authentication:** As mentioned before, robust authentication is key. <br> - **Authorization Controls:** Implement granular authorization controls on the FRP server to restrict which clients can create or modify specific tunnels. <br> - **Monitoring:** Monitor tunnel creation and modification events for suspicious activity. |
| **FRP Client Configuration Tampering (Malicious)** | Attacker gains access to the FRP client's configuration file and modifies it to create malicious tunnels, potentially redirecting traffic to attacker-controlled servers or exposing sensitive internal services. | Data exfiltration, redirection of traffic to malicious endpoints, exposure of unintended internal services. | `frpc` configuration file | **High** | - **Secure File Permissions:** Restrict access to the FRP client configuration file. <br> - **Integrity Checks:** Implement mechanisms to verify the integrity of the FRP client configuration file. <br> - **Centralized Management:** Consider using a centralized configuration management system for FRP clients. |
| **Software Vulnerabilities in FRP (Server or Client)** | Unpatched vulnerabilities in the FRP server (`frps`) or client (`frpc`) software can be exploited by attackers to gain unauthorized access, execute arbitrary code, or cause denial of service. | Complete compromise of the affected component and potentially the underlying system. | `frps` and `frpc` binaries | **High** | - **Regular Updates:** Keep both the FRP server and client software updated with the latest security patches. <br> - **Vulnerability Scanning:** Regularly scan the FRP server and client hosts for known vulnerabilities. |
| **Exposure of Internal Services due to Misconfiguration** | Incorrectly configured FRP tunnels can unintentionally expose internal services to the public internet. | Unauthorized access to internal services, potential for exploitation of vulnerabilities in those services. | `frps` tunnel configuration | **High** | - **Principle of Least Privilege:** Only expose necessary services and ports through FRP. <br> - **Regular Review:** Regularly review the FRP tunnel configurations to ensure they are correct and secure. <br> - **Network Segmentation:** Ensure internal services are also protected by network security measures. |
