
## High and Critical Attack Surfaces Directly Involving frp

| Attack Surface | Description | frp Contribution | Example | Impact | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|---|
| **Compromised `frps` Server** | The public-facing `frps` server is compromised, allowing attackers to control the proxy. | `frps` acts as the central point of entry and control for all tunnels. A compromise grants broad access. | An attacker gains root access to the `frps` server and modifies the configuration to redirect all traffic to a malicious server. | Complete loss of control over exposed services, data interception, potential for further attacks on internal network. | **Critical** | - **Strong Authentication:** Use strong, unique passwords or key-based authentication for `frps` access. - **Regular Updates:** Keep `frps` software updated to patch known vulnerabilities. - **Minimize Exposure:** Only expose necessary ports on the `frps` server. - **Network Segmentation:** Isolate the `frps` server in a DMZ or separate network segment. - **Intrusion Detection/Prevention:** Implement systems to detect and prevent malicious activity on the `frps` server. |
| **Weak `frps` Authentication/Authorization** |  Attackers exploit weak or default credentials or bypass authentication mechanisms on the `frps` server. | `frps` relies on authentication to control access and manage tunnels. Weaknesses allow unauthorized access. | An attacker uses default credentials or exploits a vulnerability to log into the `frps` management interface and create malicious tunnels. | Unauthorized access to internal services, data breaches, potential for denial of service. | **High** | - **Strong Authentication:** Enforce strong password policies or use key-based authentication. - **Disable Default Credentials:** Change or disable any default administrative credentials. - **Principle of Least Privilege:** Grant only necessary permissions to users and clients. - **Rate Limiting:** Implement rate limiting on authentication attempts to prevent brute-force attacks. |
| **Insecure `frps` Configuration** | Misconfigured `frps` settings expose unnecessary ports, use weak encryption, or leak sensitive information. | `frps` configuration dictates security posture. Insecure settings create vulnerabilities. | The `frps` configuration allows unencrypted connections, enabling an attacker to eavesdrop on traffic. | Data interception, potential for man-in-the-middle attacks. | **High** | - **Secure Configuration Practices:** Follow security best practices when configuring `frps`. - **Disable Unnecessary Features:** Disable any features or ports that are not required. - **Enforce Encryption:** Always use TLS encryption for communication between `frpc` and `frps`. - **Regular Configuration Review:** Periodically review the `frps` configuration for potential security weaknesses. |
| **Exploiting Vulnerabilities in `frp` Software** | Attackers exploit known security vulnerabilities in the `frp` software itself. | Like any software, `frp` may contain vulnerabilities that can be exploited. | An attacker exploits a remote code execution vulnerability in an outdated version of `frps` to gain control of the server. | Complete compromise of the `frps` server and potentially the internal network. | **High** | - **Regular Updates:** Keep both `frps` and `frpc` updated to the latest versions to patch known vulnerabilities. - **Vulnerability Scanning:** Regularly scan the `frps` server for known vulnerabilities. - **Follow Security Advisories:** Stay informed about security advisories related to `frp`. |
