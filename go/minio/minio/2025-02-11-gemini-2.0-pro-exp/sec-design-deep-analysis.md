## Deep Analysis of MinIO Security Considerations

### 1. Objective, Scope, and Methodology

**Objective:**

The objective of this deep analysis is to conduct a thorough security assessment of MinIO, focusing on its key components, architecture, and data flow, as inferred from the provided Security Design Review, codebase (https://github.com/minio/minio), and available documentation.  The analysis aims to identify potential security vulnerabilities, assess their impact, and propose specific, actionable mitigation strategies tailored to a MinIO deployment, particularly within a Kubernetes environment.  The analysis will cover authentication, authorization, data protection (at rest and in transit), auditing, network security, and the build process.

**Scope:**

This analysis covers the following aspects of MinIO:

*   **Core Components:**  MinIO API Server, Object Layer, Erasure Code Engine, Identity and Access Management (IAM), and integration with Key Management Services (KMS).
*   **Data Flow:**  How data moves through the system, from client requests to storage and back.
*   **Deployment Model:**  Focus on a Kubernetes-based deployment, as outlined in the design review.
*   **Build Process:**  Security controls within the MinIO build and release pipeline.
*   **Existing and Recommended Security Controls:**  Evaluation of the controls listed in the Security Design Review.
*   **Identified Risks:** Analysis of business and accepted risks.

This analysis *does not* cover:

*   Specific vulnerabilities in third-party libraries, although the *process* for managing such vulnerabilities is considered.
*   The security of the underlying Kubernetes cluster itself (this is assumed to be managed separately).
*   Physical security of the infrastructure.
*   Detailed code-level vulnerability analysis (beyond what can be inferred from the codebase structure and documentation).

**Methodology:**

1.  **Architecture and Component Inference:**  Based on the provided C4 diagrams, codebase structure, and MinIO documentation, we will infer the detailed architecture, components, and data flow within MinIO.
2.  **Security Control Analysis:**  We will analyze the existing and recommended security controls outlined in the Security Design Review, assessing their effectiveness and identifying any gaps.
3.  **Threat Modeling:**  For each key component and data flow, we will identify potential threats based on common attack vectors and MinIO-specific vulnerabilities.  We will consider threats related to confidentiality, integrity, and availability.
4.  **Risk Assessment:**  We will assess the likelihood and impact of each identified threat, considering the existing security controls and the business context.
5.  **Mitigation Strategy Recommendation:**  For each significant threat, we will propose specific, actionable mitigation strategies tailored to MinIO and a Kubernetes deployment.  These recommendations will be prioritized based on their impact on reducing risk.
6.  **Documentation Review:** We will cross-reference our findings with the official MinIO documentation to ensure accuracy and completeness.

### 2. Security Implications of Key Components

This section breaks down the security implications of each key component, identifies potential threats, and proposes mitigation strategies.

**2.1 Client API (S3, MinIO Admin)**

*   **Security Implications:** This is the primary entry point for all client interactions.  It handles authentication and initial authorization checks.  It's exposed to the public internet or internal network, making it a prime target for attacks.
*   **Potential Threats:**
    *   **Brute-force attacks:**  Attempting to guess credentials.
    *   **Credential stuffing:**  Using credentials stolen from other breaches.
    *   **Man-in-the-middle (MITM) attacks:**  Intercepting communication between the client and MinIO.
    *   **Denial-of-service (DoS) attacks:**  Overwhelming the API with requests.
    *   **Improper Input Validation:** Leading to potential vulnerabilities like injection attacks.
    *   **Session Hijacking:** Stealing valid session tokens.
*   **Mitigation Strategies:**
    *   **Strong Authentication:** Enforce strong password policies and *require* multi-factor authentication (MFA) for all users, especially administrative users.  Integrate with existing identity providers (LDAP, Active Directory, OIDC) using secure protocols.
    *   **Rate Limiting:** Implement rate limiting to mitigate brute-force and DoS attacks.  Configure different rate limits for different API endpoints and user roles.  Use MinIO's built-in rate limiting features and consider Kubernetes-level rate limiting (e.g., using an Ingress controller with rate limiting capabilities).
    *   **TLS Enforcement:**  *Always* use TLS (HTTPS) for all communication.  Use strong TLS ciphers and protocols.  Configure the Ingress controller to enforce TLS and redirect HTTP traffic to HTTPS.  Regularly update TLS certificates.
    *   **Input Validation:**  Strictly validate all input parameters on the server-side.  Use a whitelist approach, allowing only known-good input.  Sanitize data to prevent XSS vulnerabilities.  Leverage Go's built-in libraries for input validation and sanitization.
    *   **Session Management:** Use secure, randomly generated session tokens.  Set appropriate session timeouts.  Implement secure cookie attributes (HttpOnly, Secure).
    *   **WAF:** Deploy a Web Application Firewall (WAF) in front of the MinIO service (e.g., at the Ingress level) to protect against common web attacks (OWASP Top 10).  Configure the WAF to specifically protect against attacks targeting object storage services.
    *   **API Gateway:** Consider using an API gateway for additional security features like request transformation, authentication offloading, and advanced threat protection.

**2.2 MinIO API Server**

*   **Security Implications:** This is the core logic of MinIO.  It processes requests, interacts with other components, and enforces access control.  Vulnerabilities here can have a significant impact.
*   **Potential Threats:**
    *   **Authorization bypass:**  Exploiting flaws in access control logic to gain unauthorized access to data or functionality.
    *   **Injection attacks:**  Exploiting vulnerabilities in input validation to inject malicious code or commands.
    *   **Logic flaws:**  Errors in the server's logic that can be exploited to cause unexpected behavior or data corruption.
    *   **Resource exhaustion:**  Attacks that consume excessive server resources (CPU, memory, disk I/O).
    *   **Privilege Escalation:** Gaining higher privileges than authorized.
*   **Mitigation Strategies:**
    *   **Least Privilege:**  Ensure that the MinIO API server itself runs with the least necessary privileges.  Avoid running it as root.  Use Kubernetes service accounts with minimal permissions.
    *   **Regular Security Audits:** Conduct regular security audits of the MinIO codebase, focusing on the API server logic.  Use static analysis tools and manual code review.
    *   **Input Validation (Reinforced):**  Reiterate input validation at this layer, even if it's already performed at the Client API layer.  Defense in depth is crucial.
    *   **Secure Coding Practices:**  Follow secure coding practices to prevent common vulnerabilities (e.g., OWASP guidelines for Go).
    *   **Resource Limits:**  Configure resource limits (CPU, memory) for the MinIO pods in Kubernetes to prevent resource exhaustion attacks.
    *   **Error Handling:** Implement robust error handling to prevent information leakage and ensure graceful degradation under attack.  Avoid returning detailed error messages to clients.
    *   **Regular Updates:** Keep MinIO updated to the latest version to patch security vulnerabilities.  Automate the update process using Kubernetes rolling updates.

**2.3 Object Layer**

*   **Security Implications:** This layer handles object-level operations and metadata.  It's responsible for enforcing object-level access control and features like versioning and object locking.
*   **Potential Threats:**
    *   **Unauthorized object access:**  Bypassing object-level access control policies.
    *   **Data tampering:**  Modifying object data or metadata without authorization.
    *   **Object locking bypass:**  Circumventing object locking mechanisms to delete or modify locked objects.
    *   **Versioning manipulation:**  Exploiting vulnerabilities in versioning to access previous versions of objects or to delete objects permanently.
*   **Mitigation Strategies:**
    *   **Strict Policy Enforcement:**  Implement and rigorously enforce object-level access control policies using MinIO's policy-based access control system.  Regularly review and audit these policies.
    *   **Object Locking (Compliance Mode):**  Use object locking in compliance mode for data that requires strict immutability.  Ensure that the retention policies are correctly configured and cannot be bypassed.
    *   **Versioning (Enabled and Monitored):**  Enable object versioning to protect against accidental deletion and modification.  Monitor versioning activity for suspicious behavior.
    *   **Data Integrity Checks:**  Regularly verify the integrity of object data and metadata using MinIO's built-in checksumming and bit rot detection capabilities.
    *   **Input Validation (Object Names/Metadata):** Validate object names and metadata to prevent injection attacks or path traversal vulnerabilities.

**2.4 Erasure Code Engine**

*   **Security Implications:** This component is critical for data durability and integrity.  Compromise here could lead to data loss or corruption.
*   **Potential Threats:**
    *   **Data corruption:**  Malicious modification of data during the erasure coding process.
    *   **Bit rot exploitation:**  Taking advantage of undetected bit rot to corrupt data.
    *   **Denial of service:**  Attacks that prevent the erasure code engine from functioning correctly, leading to data unavailability.
    *   **Side-channel attacks:**  Attempting to extract information about the data or encryption keys by observing the behavior of the erasure code engine.
*   **Mitigation Strategies:**
    *   **Data Integrity Verification:**  Regularly verify the integrity of data using MinIO's built-in bit rot detection and healing capabilities.  Schedule regular data scrubbing jobs.
    *   **Secure Erasure Coding Implementation:**  Ensure that the erasure coding algorithm is implemented securely and is resistant to known attacks.  Use well-vetted and widely used erasure coding libraries.
    *   **Resource Limits:**  Configure resource limits for the erasure code engine to prevent denial-of-service attacks.
    *   **Monitoring:**  Monitor the performance and health of the erasure code engine for any anomalies.
    *   **Hardware Security:** If possible, use hardware-based security features (e.g., Trusted Platform Module (TPM)) to protect the integrity of the erasure code engine.

**2.5 Identity and Access Management (IAM)**

*   **Security Implications:** This component controls access to all MinIO resources.  Compromise here would grant an attacker full control.
*   **Potential Threats:**
    *   **Credential theft:**  Stealing user credentials or access keys.
    *   **Policy misconfiguration:**  Creating overly permissive policies that grant unauthorized access.
    *   **Privilege escalation:**  Exploiting vulnerabilities to gain higher privileges within the IAM system.
    *   **Account takeover:**  Gaining control of existing user accounts.
*   **Mitigation Strategies:**
    *   **Strong Password Policies:** Enforce strong password policies for all users.
    *   **Multi-Factor Authentication (MFA):**  *Require* MFA for all users, especially administrative users.
    *   **Least Privilege:**  Implement the principle of least privilege, granting users only the minimum necessary permissions.
    *   **Regular Policy Review:**  Regularly review and audit IAM policies to ensure they are correctly configured and enforce least privilege.  Automate this process where possible.
    *   **Secure Credential Storage:**  Store credentials and secrets securely, using a dedicated secrets management solution (e.g., Kubernetes Secrets, HashiCorp Vault).  Never store credentials in plain text.
    *   **Role-Based Access Control (RBAC):**  Use RBAC to define roles with specific permissions and assign users to these roles.
    *   **Auditing:**  Enable detailed audit logging of all IAM activity.  Monitor these logs for suspicious behavior.
    *   **Integration with External Identity Providers:** If integrating with external identity providers (LDAP, Active Directory, OIDC), use secure protocols and configurations.

**2.6 Key Management Service (KMS) Integration**

*   **Security Implications:** This component is responsible for managing encryption keys used for server-side encryption (SSE).  Compromise here could expose encrypted data.
*   **Potential Threats:**
    *   **Key compromise:**  Stealing or unauthorized access to encryption keys.
    *   **Unauthorized key usage:**  Using encryption keys without authorization.
    *   **Key rotation failure:**  Failing to rotate encryption keys regularly, increasing the risk of compromise.
    *   **KMS unavailability:**  Loss of access to the KMS, preventing decryption of data.
*   **Mitigation Strategies:**
    *   **Secure KMS Configuration:**  Use a secure and reliable KMS (e.g., AWS KMS, HashiCorp Vault, or a dedicated hardware security module (HSM)).  Configure the KMS according to best practices.
    *   **Key Rotation:**  Implement automatic key rotation according to a defined schedule.  Use MinIO's integration with the KMS to manage key rotation.
    *   **Access Control:**  Strictly control access to the KMS.  Grant only the minimum necessary permissions to MinIO.
    *   **Auditing:**  Enable audit logging for all KMS operations.  Monitor these logs for suspicious activity.
    *   **High Availability:**  Ensure that the KMS is highly available to prevent data unavailability.  Use a KMS that supports redundancy and failover.
    *   **Key Backup and Recovery:** Implement a secure backup and recovery plan for encryption keys.
    *   **Network Security:** Secure the network communication between MinIO and the KMS using TLS and network segmentation.

**2.7 Storage Disks**

* **Security Implications:** This is where the data resides. Physical or virtual disk compromise can lead to data loss or exfiltration.
* **Potential Threats:**
    * **Unauthorized physical access:** Gaining physical access to the servers and stealing the disks.
    * **Disk failure:** Hardware failure leading to data loss.
    * **Data remanence:** Data remaining on disks after deletion, potentially allowing unauthorized access.
    * **Malware infection:** Malware infecting the underlying operating system and accessing the data on the disks.
* **Mitigation Strategies:**
    * **Disk Encryption:** Encrypt the underlying storage disks using a robust encryption solution (e.g., LUKS, dm-crypt). This protects data at rest even if the disks are stolen.  Integrate this with the KMS for key management.
    * **Physical Security:** Implement strong physical security controls to protect the servers hosting the MinIO deployment.
    * **Data Sanitization:** Implement secure data sanitization procedures to ensure that data is completely erased when disks are decommissioned or replaced. Use methods like cryptographic erasure or physical destruction.
    * **RAID/Erasure Coding:** Use RAID (for standalone deployments) or MinIO's built-in erasure coding to protect against disk failures.
    * **Regular Backups:** Implement a robust backup and disaster recovery plan to protect against data loss.
    * **OS Hardening:** Harden the underlying operating system of the MinIO servers to reduce the attack surface.

### 3. Data Flow Analysis

The following describes the data flow for a typical object storage operation (e.g., PUT request) and highlights the security considerations at each stage:

1.  **Client Request:**
    *   The client (e.g., an S3-compatible application) initiates a PUT request to upload an object.
    *   The request includes the object data, metadata, and authentication credentials (e.g., AWS Signature v4).
    *   **Security Considerations:** Authentication, TLS encryption, input validation (at the client-side, ideally).

2.  **Ingress Controller (Kubernetes):**
    *   The request reaches the Ingress controller, which routes it to the MinIO service.
    *   The Ingress controller may handle TLS termination and perform initial request validation (e.g., WAF rules).
    *   **Security Considerations:** TLS configuration, WAF rules, rate limiting.

3.  **MinIO Service (Kubernetes):**
    *   The MinIO service load balances the request to one of the MinIO pods.
    *   **Security Considerations:** Network policies.

4.  **MinIO API Server (Pod):**
    *   The MinIO API server receives the request.
    *   It performs authentication and authorization checks based on the provided credentials and configured policies.
    *   **Security Considerations:** Authentication, authorization, input validation.

5.  **Object Layer:**
    *   The API server passes the request to the object layer.
    *   The object layer handles object metadata and performs object-level operations.
    *   **Security Considerations:** Object locking, versioning, policy enforcement.

6.  **Erasure Code Engine:**
    *   The object layer passes the object data to the erasure code engine.
    *   The erasure code engine encodes the data and distributes it across the storage disks.
    *   **Security Considerations:** Data integrity, bit rot detection.

7.  **Storage Disks:**
    *   The encoded data is written to the storage disks.
    *   **Security Considerations:** Disk encryption.

8.  **Response:**
    *   The MinIO API server sends a response to the client, indicating the success or failure of the operation.
    *   **Security Considerations:** Secure communication (TLS).

The data flow for other operations (GET, DELETE, etc.) is similar, with variations in the specific steps involved. The key security considerations remain consistent throughout the data flow.

### 4. Build Process Security

The MinIO build process, as described, utilizes Makefiles, shell scripts, and Go's build system, with GitHub Actions for CI/CD.  Here's a breakdown of the security controls and potential improvements:

*   **Existing Security Controls:**
    *   **Code Review:**  This is a crucial control to identify security vulnerabilities before they are merged into the codebase.  Ensure that code reviews specifically focus on security aspects.
    *   **Static Analysis:**  Using tools like `go vet` and `golangci-lint` helps identify potential code quality and security issues.  Configure these tools to use a comprehensive set of rules, including security-focused rules.
    *   **Dependency Management:**  Go modules help manage dependencies, but they don't automatically guarantee security.
    *   **Automated Testing:**  Unit and integration tests help ensure code quality and prevent regressions, but they don't specifically target security vulnerabilities.
    *   **Signed Releases:**  Signing release artifacts is essential to ensure their integrity and authenticity. *Confirm that MinIO signs its releases and provide instructions for users to verify the signatures.*
    *   **Container Image Scanning:** Docker images *should* be scanned for vulnerabilities. *Confirm that MinIO performs container image scanning and publishes the results.*

*   **Potential Improvements:**
    *   **Software Composition Analysis (SCA):** Integrate SCA tools (e.g., Snyk, Dependabot, Trivy) into the CI/CD pipeline to automatically identify vulnerabilities in third-party dependencies.  Configure these tools to block builds if vulnerabilities above a certain severity threshold are found.
    *   **Dynamic Application Security Testing (DAST):**  Consider incorporating DAST tools into the CI/CD pipeline to test the running application for vulnerabilities.  This is more complex to set up but can identify vulnerabilities that static analysis might miss.
    *   **Secret Scanning:**  Use secret scanning tools (e.g., git-secrets, truffleHog) to detect accidental commits of secrets (e.g., API keys, passwords) to the codebase.
    *   **Fuzz Testing:** Implement fuzz testing to automatically generate random inputs and test the application's resilience to unexpected data.
    *   **Supply Chain Security:**  Implement measures to secure the entire software supply chain, from code commit to deployment.  This includes verifying the integrity of build tools and dependencies. Consider using tools like in-toto and SLSA.
    *   **Build Environment Hardening:**  Harden the build environment (e.g., GitHub Actions runners) to prevent compromise.  Use minimal base images, restrict network access, and monitor for suspicious activity.

### 5. Risk Assessment and Mitigation Strategies (Prioritized)

This section combines the threat modeling and mitigation strategies from previous sections, prioritizing them based on likelihood and impact.  We use a simple High/Medium/Low rating for both likelihood and impact.

| Threat                                       | Likelihood | Impact | Mitigation Strategies (Prioritized)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   