## Deep Security Analysis of Alamofire Library

### 1. Objective, Scope, and Methodology

**Objective:**

The objective of this deep security analysis is to thoroughly evaluate the security posture of the Alamofire HTTP networking library. This analysis will focus on identifying potential security vulnerabilities and weaknesses within Alamofire's design, implementation, build process, and deployment model. The goal is to provide actionable, tailored security recommendations to enhance the security of Alamofire and, consequently, applications that depend on it. This analysis will consider the specific context of Alamofire as a widely used open-source library and its reliance on underlying Apple platform frameworks.

**Scope:**

This analysis encompasses the following aspects of Alamofire:

*   **Codebase Analysis:** Examination of the Alamofire source code (as available on the GitHub repository) to understand its architecture, components, and implementation details relevant to security.
*   **Design Review Analysis:**  Deep dive into the provided Security Design Review document, including C4 Context, Container, Deployment, and Build diagrams, to identify potential security implications at each level of abstraction.
*   **Dependency Analysis:** Consideration of Alamofire's dependencies, managed through Swift Package Manager, and their potential security impact.
*   **Build and Deployment Process:** Review of the build process, including CI/CD pipelines and artifact distribution, to identify supply chain security risks.
*   **Security Controls Assessment:** Evaluation of existing and recommended security controls for the Alamofire project, as outlined in the Security Design Review.
*   **Security Requirements Analysis:**  Assessment of how Alamofire addresses the defined security requirements (Authentication, Authorization, Input Validation, Cryptography).

**Methodology:**

This deep security analysis will employ the following methodology:

1.  **Document Review:**  In-depth review of the provided Security Design Review document, including business and security posture, C4 diagrams, and security requirements.
2.  **Codebase Inference:**  Based on the documentation and publicly available codebase (GitHub repository), infer the architecture, key components, and data flow within Alamofire. This will involve analyzing the structure of the project, examining key modules, and understanding how Alamofire interacts with URLSession and other system frameworks.
3.  **Threat Modeling (Lightweight):**  Identify potential threats and vulnerabilities relevant to each component and interaction point within Alamofire, considering the OWASP Top Ten for Mobile and API Security, and common networking library vulnerabilities.
4.  **Security Control Mapping:** Map existing and recommended security controls to the identified threats and vulnerabilities to assess their effectiveness and coverage.
5.  **Risk Assessment (Contextual):** Evaluate the potential impact and likelihood of identified threats, considering the business posture and accepted risks of the Alamofire project.
6.  **Mitigation Strategy Development:**  Develop specific, actionable, and tailored mitigation strategies for identified security risks, focusing on practical recommendations for the Alamofire development team. These strategies will be aligned with the project's business goals and security requirements.
7.  **Documentation and Reporting:**  Document the analysis process, findings, identified threats, and recommended mitigation strategies in a clear and structured report.

### 2. Security Implications of Key Components

Based on the provided Security Design Review and the nature of an HTTP networking library, we can break down the security implications of key components as follows:

**2.1. Networking Container (Alamofire Library Core)**

*   **Inferred Architecture & Data Flow:**
    *   **Request Handling:**  Accepts request parameters from the Mobile App Code, constructs `URLRequest` objects, potentially performs parameter encoding, and manages request lifecycle.
    *   **URLSession Abstraction:**  Acts as an abstraction layer over Apple's `URLSession` framework, utilizing its functionalities for network operations.
    *   **Response Handling:**  Receives responses from `URLSession`, performs response serialization, error handling, and delivers results back to the Mobile App Code.
    *   **Interceptors & Adapters:**  Provides mechanisms for request and response interception, allowing developers to modify requests (e.g., add authentication headers) and process responses.
    *   **Data Flow:** Data flows from Mobile App Code -> Alamofire Networking Container -> `URLSession` -> Network -> Backend API Server and back in reverse order.

*   **Security Implications:**
    *   **Input Validation Vulnerabilities:**
        *   **Threat:**  Improper validation of URLs, headers, parameters, and other inputs provided by the Mobile App Code could lead to vulnerabilities like:
            *   **URL Injection/Redirection:**  Maliciously crafted URLs could redirect requests to unintended destinations.
            *   **Header Injection:**  Injection of malicious headers could lead to HTTP smuggling or other attacks.
            *   **Denial of Service (DoS):**  Processing excessively large or malformed inputs could exhaust resources and cause crashes.
        *   **Specific Alamofire Context:**  While Alamofire likely performs basic URL validation, deeper validation of complex parameters or headers might be lacking, relying on the application developer.
    *   **Insecure Defaults & Configuration:**
        *   **Threat:**  Alamofire might have insecure default configurations or allow developers to easily configure insecure settings, such as:
            *   **Disabling TLS/SSL Verification:**  If developers can easily disable certificate pinning or TLS verification, it could lead to Man-in-the-Middle (MitM) attacks.
            *   **Weak Cipher Suites:**  If Alamofire doesn't enforce or recommend strong cipher suites, communication could be vulnerable to eavesdropping.
            *   **Insecure Cookie Handling:**  Improper handling of cookies could lead to session hijacking or other cookie-related vulnerabilities.
        *   **Specific Alamofire Context:**  Alamofire should default to secure TLS configurations and make it difficult for developers to unintentionally weaken security.
    *   **Memory Safety Issues:**
        *   **Threat:**  Bugs in Alamofire's Swift code (especially if dealing with low-level operations or unsafe code) could lead to memory corruption vulnerabilities like buffer overflows, use-after-free, etc. These can be exploited for code execution.
        *   **Specific Alamofire Context:**  Swift is generally memory-safe, but vulnerabilities can still occur, especially in complex networking logic. Regular code reviews and SAST are crucial.
    *   **Denial of Service (DoS) through Resource Exhaustion:**
        *   **Threat:**  Alamofire's request handling or response processing logic could be vulnerable to DoS attacks if it doesn't handle resource limits properly. For example, processing extremely large responses or handling a flood of requests without proper rate limiting within the library itself (though rate limiting is primarily application responsibility).
        *   **Specific Alamofire Context:**  While `URLSession` provides some level of DoS protection, Alamofire's abstraction layer should not introduce new DoS vulnerabilities.
    *   **Vulnerabilities in Third-Party Dependencies (Indirect):**
        *   **Threat:**  Although Alamofire aims to be lightweight and have minimal dependencies, any third-party libraries it uses (even indirectly through Swift Package Manager) could contain vulnerabilities that could impact Alamofire and applications using it.
        *   **Specific Alamofire Context:**  Dependency scanning is crucial to identify and mitigate vulnerabilities in any transitive dependencies.

**2.2. URLSession Framework (Underlying OS Framework)**

*   **Inferred Architecture & Data Flow:**
    *   **Low-Level Networking:**  Handles the actual network communication, including socket management, TLS/SSL negotiation, and HTTP protocol implementation.
    *   **OS Integration:**  Deeply integrated with the operating system, leveraging OS-level security features and network configurations.

*   **Security Implications:**
    *   **Reliance on OS Security:**  Alamofire's security heavily relies on the security of the underlying `URLSession` framework and the operating system itself. Any vulnerabilities in `URLSession` or the OS could directly impact Alamofire.
    *   **TLS/SSL Implementation:**  `URLSession` is responsible for TLS/SSL encryption.  Alamofire must correctly utilize `URLSession` to ensure secure HTTPS communication. Misconfiguration or improper usage by Alamofire could weaken TLS security.
    *   **Vulnerabilities in `URLSession` (External):**  While Apple actively maintains `URLSession`, vulnerabilities can still be discovered. Alamofire needs to be updated promptly to address any security patches in `URLSession` released by Apple.

**2.3. Mobile App Code (Application Integration)**

*   **Inferred Architecture & Data Flow:**
    *   **Uses Alamofire API:**  Mobile App Code utilizes Alamofire's API to initiate network requests, handle responses, and manage network communication logic.
    *   **Application-Specific Logic:**  Implements application-level authentication, authorization, input validation (beyond basic Alamofire validation), and data processing.

*   **Security Implications:**
    *   **Misuse of Alamofire API:**
        *   **Threat:**  Developers might misuse Alamofire's API in ways that introduce security vulnerabilities in their applications. Examples include:
            *   **Hardcoding Sensitive Data in Requests:**  Accidentally embedding API keys or passwords directly in request URLs or headers.
            *   **Improper Error Handling:**  Not handling network errors or server errors correctly, potentially exposing sensitive information or leading to application crashes.
            *   **Disabling Security Features:**  Unintentionally disabling TLS verification or other security features provided by Alamofire.
        *   **Specific Alamofire Context:**  Alamofire documentation and examples should emphasize secure usage patterns and warn against common pitfalls.
    *   **Application-Level Vulnerabilities:**  While not directly in Alamofire, vulnerabilities in the Mobile App Code that *uses* Alamofire can still compromise security. This includes:
        *   **Insecure Data Storage:**  Storing sensitive data retrieved via Alamofire insecurely on the device.
        *   **Insufficient Input Validation (Application-Level):**  Not performing adequate input validation on data received from APIs, leading to vulnerabilities like Cross-Site Scripting (XSS) or SQL Injection (if data is used in local databases).
        *   **Broken Authentication/Authorization (Application-Level):**  Flaws in the application's authentication and authorization logic, even if Alamofire correctly handles authentication headers.

**2.4. Build Process & Supply Chain**

*   **Inferred Architecture & Data Flow:**
    *   **GitHub Repository:** Source code hosted on GitHub.
    *   **Swift Package Manager:** Used for dependency management.
    *   **GitHub Actions CI:** Automates build, test, and potentially release processes.
    *   **Distribution Channels:**  Library distributed via Swift Package Manager, CocoaPods, and GitHub Releases.

*   **Security Implications:**
    *   **Compromised Dependencies:**
        *   **Threat:**  If any of Alamofire's dependencies (even transitive ones) are compromised with malicious code, it could be incorporated into Alamofire and subsequently into applications using it.
        *   **Specific Alamofire Context:**  Dependency scanning and SBOM generation are crucial to mitigate this risk.
    *   **Insecure CI/CD Pipeline:**
        *   **Threat:**  Vulnerabilities in the CI/CD pipeline (GitHub Actions workflows, build environment) could be exploited to inject malicious code into the Alamofire library during the build process.
        *   **Specific Alamofire Context:**  Secure CI/CD configuration, access controls, and regular audits of the pipeline are necessary.
    *   **Compromised Build Artifacts:**
        *   **Threat:**  If build artifacts (compiled Alamofire library) are compromised after being built but before distribution, users could download and integrate a malicious version of Alamofire.
        *   **Specific Alamofire Context:**  Code signing (if applicable), secure storage and distribution channels (HTTPS for downloads), and integrity checks (checksums) can help mitigate this.
    *   **Lack of Build Reproducibility:**
        *   **Threat:**  If the build process is not reproducible, it becomes harder to verify the integrity of the distributed library and detect potential tampering.
        *   **Specific Alamofire Context:**  Aim for a reproducible build process to enhance trust and verifiability.

### 3. Specific and Actionable Mitigation Strategies for Alamofire

Based on the identified security implications, here are tailored and actionable mitigation strategies for the Alamofire project:

**3.1. Networking Container (Alamofire Library Core) Mitigations:**

*   **Enhanced Input Validation:**
    *   **Action:** Implement more robust input validation within Alamofire for URLs, headers, and parameters. Focus on validating against common injection attack patterns and enforcing reasonable limits on input sizes.
    *   **Specific Implementation:**
        *   Use URL parsing libraries to validate URL structures and schemes.
        *   Implement header validation to prevent injection of control characters or malicious header names.
        *   Consider using schema validation for request parameters when applicable (though this might be better suited for application-level).
*   **Secure Defaults and Configuration Enforcement:**
    *   **Action:** Ensure Alamofire defaults to the most secure configurations for TLS/SSL, cipher suites, and cookie handling. Make it harder for developers to unintentionally weaken security.
    *   **Specific Implementation:**
        *   Default to HTTPS and enforce TLS/SSL verification by default. Provide clear warnings and documentation if developers choose to disable it.
        *   Recommend and default to strong cipher suites.
        *   Implement secure cookie handling practices, such as setting `HttpOnly` and `Secure` flags where appropriate (though cookie management is largely handled by `URLSession`).
        *   Provide clear documentation and examples on how to configure Alamofire securely and avoid common insecure configurations.
*   **Memory Safety & Code Quality:**
    *   **Action:**  Prioritize memory safety in code development. Integrate Static Analysis Security Testing (SAST) tools into the CI pipeline to automatically detect potential memory safety issues and other code flaws. Conduct regular code reviews, especially for critical networking logic.
    *   **Specific Implementation:**
        *   Integrate SAST tools like SonarQube, SwiftLint with security rules, or commercial SAST solutions into GitHub Actions workflows.
        *   Enforce mandatory code reviews by experienced developers for all code changes, focusing on security aspects.
        *   Consider using Swift's memory safety features and best practices to minimize memory-related vulnerabilities.
*   **DoS Protection (Library Level):**
    *   **Action:**  Implement basic DoS protection mechanisms within Alamofire to prevent resource exhaustion from malicious requests or responses.
    *   **Specific Implementation:**
        *   Set reasonable limits on request and response sizes that Alamofire will process by default. Provide options for developers to adjust these limits if needed, but with clear warnings about potential DoS risks.
        *   Implement timeouts for network operations to prevent indefinite hanging and resource exhaustion.
*   **Dependency Management & Scanning:**
    *   **Action:** Implement automated dependency scanning to detect known vulnerabilities in third-party dependencies used by Alamofire (even transitive dependencies).
    *   **Specific Implementation:**
        *   Integrate dependency scanning tools like Snyk, OWASP Dependency-Check, or GitHub Dependency Scanning into the CI pipeline.
        *   Regularly review and update dependencies to patch known vulnerabilities.
        *   Generate and publish a Software Bill of Materials (SBOM) to provide transparency about dependencies.

**3.2. URLSession Framework Mitigations (Indirect - Awareness & Best Practices):**

*   **Action:**  Since Alamofire relies on `URLSession`, stay informed about security updates and best practices related to `URLSession` from Apple. Document any specific security considerations related to `URLSession` that developers using Alamofire should be aware of.
    *   **Specific Implementation:**
        *   Monitor Apple's security advisories and release notes for `URLSession` updates.
        *   Include a section in Alamofire's security documentation that highlights the reliance on `URLSession` and any relevant security considerations.

**3.3. Mobile App Code Mitigations (Guidance & Documentation):**

*   **Action:**  Provide clear and comprehensive documentation and examples that guide developers on how to use Alamofire securely in their applications. Emphasize secure coding practices and common security pitfalls to avoid.
    *   **Specific Implementation:**
        *   Create a dedicated "Security Best Practices" section in the Alamofire documentation.
        *   Include examples of secure authentication handling, error handling, and input validation in application code that uses Alamofire.
        *   Provide warnings and guidance against common insecure usage patterns, such as hardcoding sensitive data or disabling TLS verification without understanding the risks.

**3.4. Build Process & Supply Chain Mitigations:**

*   **Secure CI/CD Pipeline:**
    *   **Action:**  Harden the CI/CD pipeline (GitHub Actions) to prevent unauthorized access and code injection.
    *   **Specific Implementation:**
        *   Implement strong access controls for GitHub Actions workflows and secrets.
        *   Regularly audit CI/CD configurations for security vulnerabilities.
        *   Use dedicated, isolated build environments for CI.
*   **Code Signing & Integrity Checks:**
    *   **Action:**  Consider code signing the Alamofire library artifacts (if applicable and feasible for Swift Packages) to ensure integrity and authenticity. Provide checksums for distributed artifacts.
    *   **Specific Implementation:**
        *   Explore code signing options for Swift Packages and consider implementing it for official releases.
        *   Generate and publish checksums (e.g., SHA256) for all distributed Alamofire releases (GitHub Releases, etc.) to allow users to verify integrity.
*   **Vulnerability Handling Process:**
    *   **Action:**  Establish a clear and documented process for handling security vulnerability reports. Define response time expectations and communication strategies.
    *   **Specific Implementation:**
        *   Create a dedicated security policy document outlining the vulnerability reporting process (e.g., security@alamofire.org or a dedicated GitHub security issue template).
        *   Define SLAs for acknowledging, triaging, and fixing reported vulnerabilities.
        *   Establish a communication strategy for informing users about security vulnerabilities and released patches.

### 4. Risk Assessment (Refined)

**Critical Business Process:** Secure and reliable network communication in applications using Alamofire.

**Data to Protect (Application-Specific):**  Sensitivity ranges from low to high depending on the application. Alamofire itself handles the *transport* of this data.

**Refined Risk Assessment based on Analysis:**

| Threat Category                     | Specific Threat Examples                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            