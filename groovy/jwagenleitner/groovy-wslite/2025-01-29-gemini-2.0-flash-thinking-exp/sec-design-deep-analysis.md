## Deep Security Analysis of Application Using groovy-wslite

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to identify and evaluate potential security vulnerabilities and risks associated with an application utilizing the `groovy-wslite` library for interacting with SOAP-based web services. The analysis will focus on understanding the architecture, components, and data flow of such an application, specifically in the context of the `groovy-wslite` library, to provide actionable and tailored security recommendations. The ultimate goal is to enhance the security posture of applications built with `groovy-wslite` and mitigate identified threats effectively.

**Scope:**

This analysis encompasses the following areas:

* **Codebase Analysis (Simulated):**  While direct code review of `groovy-wslite` is outside the scope of this exercise, we will infer potential security implications based on the library's purpose as a SOAP client and common vulnerabilities associated with SOAP, XML processing, and HTTP clients.
* **Architecture and Component Review:**  Analysis of the provided C4 Context, Container, Deployment, and Build diagrams to understand the application's architecture and identify key components involved in SOAP communication.
* **Data Flow Analysis:**  Tracing the flow of data between the application, `groovy-wslite`, HTTP client, and external SOAP services to pinpoint potential points of vulnerability.
* **Security Design Review Analysis:**  Detailed examination of the provided Security Design Review document, including Business Posture, Security Posture, Security Requirements, Risk Assessment, and Questions & Assumptions.
* **Mitigation Strategy Development:**  Formulation of specific and actionable mitigation strategies tailored to the identified threats and applicable to applications using `groovy-wslite`.

**Methodology:**

The analysis will be conducted using the following methodology:

1. **Document Review:**  Thorough review of the provided Security Design Review document and the documentation for `groovy-wslite` (inferred from its GitHub repository description).
2. **Architecture Decomposition:**  Breaking down the application architecture into its constituent components based on the C4 diagrams and inferring data flow paths.
3. **Threat Modeling (Component-Based):**  Identifying potential threats and vulnerabilities associated with each key component, focusing on those relevant to SOAP interactions and the `groovy-wslite` library. This will include considering common SOAP vulnerabilities, HTTP client security issues, and general web application security risks.
4. **Security Requirement Mapping:**  Mapping the identified threats to the security requirements outlined in the Security Design Review to ensure comprehensive coverage.
5. **Mitigation Strategy Formulation:**  Developing specific and actionable mitigation strategies for each identified threat, tailored to the context of `groovy-wslite` and the described application architecture. These strategies will be practical and implementable by the development team.
6. **Recommendation Prioritization:**  Prioritizing recommendations based on risk severity and feasibility of implementation.

### 2. Security Implications of Key Components

Based on the provided Security Design Review and inferred architecture, the key components and their security implications are analyzed below:

**2.1. Web Application (Container Diagram - Web Application Component):**

* **Security Implications:**
    * **Input Validation & Output Encoding (Application Level):** The Web Application is responsible for handling user input and data from SOAP responses. Failure to properly validate input can lead to injection attacks (e.g., SQL injection if interacting with a database, command injection if processing SOAP data in OS commands). Lack of output encoding when displaying data from SOAP responses in the UI can lead to Cross-Site Scripting (XSS) vulnerabilities.
    * **Session Management & Authentication:**  The Web Application manages user sessions and authentication. Weak session management or authentication mechanisms can lead to unauthorized access.
    * **Authorization Logic:**  Improper authorization logic can allow users to access functionalities or data they are not permitted to, including interactions with SOAP services.
    * **Error Handling & Logging:**  Insufficient error handling can expose sensitive information or make debugging harder during security incidents. Inadequate logging can hinder incident response and security monitoring.
    * **Dependency Vulnerabilities (Indirect):** While not directly `groovy-wslite`, the Web Application itself will have dependencies. Vulnerabilities in these dependencies can indirectly impact the security of SOAP interactions if they affect data processing or overall application behavior.

**2.2. groovy-wslite Library (Container Diagram - groovy-wslite Library Component):**

* **Security Implications:**
    * **XML Parsing Vulnerabilities (XXE, Billion Laughs):** As a SOAP client, `groovy-wslite` likely parses XML responses. Vulnerabilities in the XML parsing process, such as XML External Entity (XXE) injection or denial-of-service attacks like "Billion Laughs," could be present if the library doesn't handle XML securely.
    * **SOAP Message Manipulation Vulnerabilities:**  If `groovy-wslite` allows for manipulation of SOAP messages in a way that bypasses intended security mechanisms of the SOAP service, it could lead to vulnerabilities. This is less likely in a client library but needs consideration.
    * **Dependency Vulnerabilities (Direct):** `groovy-wslite` itself will have dependencies. Vulnerabilities in these dependencies (e.g., HTTP client, XML parsing libraries) can directly impact the security of the library and applications using it.
    * **Insecure Defaults:**  The library might have insecure default configurations, such as not enforcing HTTPS, weak TLS settings, or permissive XML parsing configurations.
    * **Lack of Security Features:**  The library might lack support for important security features like WS-Security for advanced authentication and encryption, forcing applications to implement these manually and potentially incorrectly.

**2.3. HTTP Client (Container Diagram - HTTP Client Component):**

* **Security Implications:**
    * **TLS/SSL Configuration:**  Insecure TLS/SSL configuration of the HTTP client (e.g., weak cipher suites, disabled certificate validation) can compromise the confidentiality and integrity of communication with SOAP services over HTTPS.
    * **Man-in-the-Middle (MITM) Attacks:**  If certificate validation is not properly configured or disabled, the application becomes vulnerable to MITM attacks, allowing attackers to intercept and potentially modify SOAP messages.
    * **Connection Pooling & Reuse:**  While beneficial for performance, improper handling of connection pooling could lead to security issues if connections are reused across different security contexts unintentionally.
    * **Timeouts & Resource Exhaustion:**  Inadequate timeouts for HTTP requests can lead to denial-of-service if SOAP services are slow or unresponsive.

**2.4. External SOAP Services (Context & Container Diagrams - SOAP Service Components):**

* **Security Implications:**
    * **SOAP Service Vulnerabilities:**  The security of the application is inherently dependent on the security of the external SOAP services. Vulnerabilities in these services (e.g., SOAP injection, business logic flaws, authentication bypasses) can be exploited through the `groovy-wslite` client.
    * **Authentication & Authorization Weaknesses:**  Weak or improperly implemented authentication and authorization mechanisms in the SOAP services can be exploited, even if the client application is secure.
    * **Data Exposure:**  Vulnerabilities in the SOAP services could lead to unauthorized access and exposure of sensitive data processed by these services.
    * **Denial of Service (DoS):**  SOAP services might be vulnerable to DoS attacks, impacting the availability of the integrated functionality in the application.

**2.5. Build Process (Build Diagram - Build Steps):**

* **Security Implications:**
    * **Dependency Vulnerabilities (Build Time):**  Vulnerabilities in dependencies introduced during the build process (including `groovy-wslite` and its transitive dependencies) can be packaged into the application container image.
    * **Compromised Build Environment:**  If the build environment is compromised, attackers could inject malicious code into the application build artifacts, including the container image.
    * **Insecure Container Image:**  Building container images from insecure base images or with unnecessary components increases the attack surface and potential vulnerabilities.
    * **Lack of Security Scanning in Build Pipeline:**  Not incorporating security scanning (SAST, dependency scanning, container image scanning) in the build pipeline allows vulnerabilities to propagate to the deployment environment.

**2.6. Deployment Environment (Deployment Diagram - Cloud Environment Components):**

* **Security Implications:**
    * **Exposed Application Instances:**  If application instances are directly exposed to the internet without proper network segmentation or load balancer protection, they become more vulnerable to direct attacks.
    * **Insecure Container Configuration:**  Misconfigured containers (e.g., running as root, exposed ports, insecure resource limits) can introduce vulnerabilities.
    * **Vulnerable Infrastructure:**  Vulnerabilities in the underlying cloud infrastructure or container orchestration platform can impact the security of the deployed application.
    * **Lack of Monitoring & Logging (Deployment):**  Insufficient monitoring and logging in the deployment environment can hinder detection and response to security incidents.

### 3. Architecture, Components, and Data Flow Inference

Based on the diagrams and descriptions, the inferred architecture, components, and data flow are as follows:

**Architecture:**  The application follows a typical three-tier web application architecture, deployed in a cloud environment using containers. It interacts with external SOAP services over the internet.

**Components:**

1. **User:** Initiates requests through a web browser.
2. **Web Application:**  Handles user requests, business logic, and UI. Written in Groovy/Java.
3. **groovy-wslite Library:**  Embedded within the Web Application. Used to simplify SOAP communication.
4. **HTTP Client:**  Underlying library used by `groovy-wslite` for HTTP communication (e.g., Apache HttpClient).
5. **Internet:**  Public network for communication with external SOAP services.
6. **External SOAP Services:**  Remote services providing specific functionalities via SOAP API.
7. **Load Balancer:**  Distributes traffic to application instances and provides HTTPS termination.
8. **Application Instances (Containers):**  Run the Web Application and `groovy-wslite`.
9. **Container Registry:**  Stores container images.
10. **Build Environment (CI/CD):**  Automates the build, test, and containerization process.

**Data Flow:**

1. **User Request:** User sends a request to the Web Application via HTTPS.
2. **Application Logic & SOAP Call:** Web Application processes the request. If interaction with a SOAP service is needed, it uses `groovy-wslite` to construct a SOAP request.
3. **SOAP Request via HTTP Client:** `groovy-wslite` uses the HTTP Client to send the SOAP request over HTTPS to the external SOAP service via the Internet.
4. **SOAP Service Processing:** The external SOAP service receives the request, authenticates and authorizes it, processes it, and generates a SOAP response.
5. **SOAP Response via HTTP Client:** The SOAP service sends the SOAP response back to the application via HTTPS and the HTTP Client.
6. **Response Parsing & Processing:** `groovy-wslite` parses the SOAP response. The Web Application then processes the data from the SOAP response.
7. **Application Response to User:** The Web Application generates a response for the user, potentially including data from the SOAP response, and sends it back to the user via HTTPS.

**Data Flow Security Considerations:**

* **Data in Transit:**  HTTPS is used for communication between the user, application, and SOAP services, ensuring encryption of data in transit. However, proper TLS configuration is crucial.
* **Data at Rest (Application):**  Sensitive data received from SOAP services might be stored or processed within the application. Secure storage and handling practices are needed.
* **Data Processing (Application & groovy-wslite):**  Data is processed by both `groovy-wslite` (XML parsing) and the Web Application. Vulnerabilities in parsing or processing can lead to attacks.
* **Authentication Credentials:**  Authentication credentials for accessing SOAP services need to be securely managed within the application.

### 4. Tailored Security Recommendations for groovy-wslite Application

Based on the analysis, here are specific security recommendations tailored to an application using `groovy-wslite`:

**4.1. groovy-wslite Library Specific Recommendations:**

* **Dependency Vulnerability Scanning:**  **Recommendation:** Regularly scan `groovy-wslite` and all its transitive dependencies for known vulnerabilities using tools integrated into the build pipeline (e.g., OWASP Dependency-Check, Snyk). **Rationale:** Proactively identify and address vulnerabilities in the library itself and its dependencies to prevent exploitation.
* **HTTP Client Configuration:** **Recommendation:**  Explicitly configure the underlying HTTP client used by `groovy-wslite` to enforce strong TLS settings. This includes:
    * **Enable HTTPS only:** Ensure all SOAP communication is over HTTPS.
    * **Use strong cipher suites:**  Configure the client to prefer strong and modern cipher suites.
    * **Enable certificate validation:**  Verify the SSL/TLS certificates of the SOAP services to prevent MITM attacks.
    * **Set appropriate timeouts:** Configure connection and request timeouts to prevent resource exhaustion and DoS.
    **Rationale:** Secure the communication channel with SOAP services and prevent common HTTP-related attacks.
* **XML Parsing Security:** **Recommendation:**  Investigate `groovy-wslite`'s XML parsing mechanism. If configurable, ensure it is configured to mitigate XXE and similar XML vulnerabilities.  Specifically:
    * **Disable external entity resolution:**  If possible, configure the XML parser to disallow external entity resolution to prevent XXE attacks.
    * **Limit XML resource consumption:**  Implement safeguards against XML-based DoS attacks (e.g., "Billion Laughs") by setting limits on XML parsing resources.
    **Rationale:** Protect against XML-specific vulnerabilities that are common in SOAP interactions.
* **WS-Security Support (If Required):** **Recommendation:** If the SOAP services require WS-Security for authentication or encryption, verify if `groovy-wslite` provides adequate support. If not, evaluate alternative libraries or implement WS-Security handling carefully in the application. **Rationale:** Ensure secure authentication and message-level security when interacting with SOAP services that require WS-Security.
* **Library Updates:** **Recommendation:**  Stay updated with the latest versions of `groovy-wslite` to benefit from bug fixes and security patches released by the library maintainers. **Rationale:**  Address known vulnerabilities and improve library security over time.

**4.2. Web Application Level Recommendations:**

* **Input Validation and Sanitization (SOAP Responses):** **Recommendation:**  Strictly validate and sanitize all data received from SOAP responses before using it within the application. This includes:
    * **Data type validation:**  Verify that data received from SOAP responses conforms to expected data types.
    * **Range checks and format validation:**  Validate data against expected ranges and formats.
    * **Sanitization for specific contexts:**  Sanitize data before using it in contexts susceptible to injection attacks (e.g., SQL queries, OS commands, HTML output).
    **Rationale:** Prevent injection attacks and data corruption arising from malicious or malformed SOAP responses.
* **Output Encoding (SOAP Data in UI):** **Recommendation:**  Properly encode data from SOAP responses before displaying it in the user interface to prevent Cross-Site Scripting (XSS) vulnerabilities. Use context-aware encoding (e.g., HTML encoding for HTML output, JavaScript encoding for JavaScript output). **Rationale:** Protect users from XSS attacks by preventing malicious scripts from being injected through SOAP data displayed in the application.
* **Authentication and Authorization (Application Level):** **Recommendation:** Implement robust authentication and authorization mechanisms within the Web Application to control user access to functionalities that interact with SOAP services. Follow the principle of least privilege. **Rationale:** Ensure that only authorized users can initiate actions that trigger SOAP calls and access sensitive data from SOAP responses.
* **Secure Credential Management:** **Recommendation:**  Securely store and manage authentication credentials used to access SOAP services. Avoid hardcoding credentials in the application. Use secure configuration management, secrets management tools (e.g., HashiCorp Vault, AWS Secrets Manager), or environment variables. **Rationale:** Protect sensitive credentials from unauthorized access and exposure.
* **Error Handling and Logging (Security Focused):** **Recommendation:** Implement comprehensive error handling and logging, specifically focusing on security-related events. Log SOAP request/response details (without sensitive data), authentication attempts, authorization failures, and any detected anomalies. Use structured logging for easier analysis. **Rationale:**  Enable detection of security incidents, facilitate incident response, and provide audit trails.

**4.3. Deployment and Build Pipeline Recommendations:**

* **Container Security:** **Recommendation:**
    * **Use minimal base images:**  Build container images from minimal and hardened base images.
    * **Regularly scan container images:**  Scan container images for vulnerabilities in the build pipeline and in the container registry.
    * **Apply least privilege to containers:**  Run containers with the least necessary privileges. Avoid running containers as root.
    * **Implement network segmentation:**  Isolate application containers within secure network segments and restrict network access based on the principle of least privilege.
    **Rationale:** Reduce the attack surface of containerized applications and mitigate potential container-specific vulnerabilities.
* **Web Application Firewall (WAF):** **Recommendation:**  Consider deploying a Web Application Firewall (WAF) in front of the application to protect against common web attacks, including those targeting SOAP endpoints if exposed directly. **Rationale:** Provide an additional layer of defense against web-based attacks and potentially filter malicious SOAP requests.
* **Security Scanning in CI/CD Pipeline:** **Recommendation:** Integrate security scanning tools (SAST, DAST, dependency scanning, container image scanning) into the CI/CD pipeline to automatically detect vulnerabilities early in the development lifecycle. **Rationale:** Shift security left and prevent vulnerabilities from reaching production.
* **Secure Build Environment:** **Recommendation:**  Harden the build environment and ensure its security. Implement access controls, secure secrets management for build processes, and regularly patch the build environment. **Rationale:** Protect the build process from compromise and prevent injection of malicious code into build artifacts.

### 5. Actionable and Tailored Mitigation Strategies

Here are actionable mitigation strategies applicable to the identified threats, tailored to `groovy-wslite`:

| Threat                                      | Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             