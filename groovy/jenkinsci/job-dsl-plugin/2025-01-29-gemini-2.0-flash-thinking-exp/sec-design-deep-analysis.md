## Deep Security Analysis of Jenkins Job DSL Plugin

### 1. Objective, Scope, and Methodology

**Objective:**

This deep security analysis aims to provide a thorough evaluation of the security posture of the Jenkins Job DSL Plugin within a CI/CD pipeline context. The primary objective is to identify potential security vulnerabilities and risks associated with the plugin's architecture, components, and data flow, and to recommend specific, actionable mitigation strategies tailored to its usage. This analysis will focus on understanding how the Job DSL Plugin interacts with Jenkins core, DSL scripts, and external systems, and how these interactions can impact the overall security of the CI/CD environment.

**Scope:**

This analysis covers the following key areas related to the Jenkins Job DSL Plugin, as outlined in the provided Security Design Review:

* **Architecture and Components:** Analysis of the C4 Context, Container, Deployment, and Build diagrams to understand the plugin's architecture, key components (Jenkins Web Application, Job DSL Plugin, Jenkins Core, DSL Scripts), and their interactions.
* **Data Flow:** Examination of how DSL scripts are processed, how job configurations are generated and applied, and how sensitive data (credentials, configurations) is handled throughout the process.
* **Security Controls:** Review of existing and recommended security controls mentioned in the design review, and their effectiveness in mitigating identified risks.
* **Risk Assessment:** Evaluation of the business and security risks associated with the Job DSL Plugin, focusing on misconfiguration, unauthorized access, supply chain vulnerabilities, and operational disruption.
* **Security Requirements:** Analysis of the defined security requirements (Authentication, Authorization, Input Validation, Cryptography) and how the Job DSL Plugin addresses them.

The analysis is specifically focused on the Job DSL Plugin and its immediate interactions within the Jenkins ecosystem. It does not extend to a comprehensive security audit of the entire Jenkins environment or the security of target systems, unless directly relevant to the plugin's operation.

**Methodology:**

This deep security analysis will employ the following methodology:

1. **Document Review:**  In-depth review of the provided Security Design Review document, including business posture, security posture, design diagrams (C4 Context, Container, Deployment, Build), risk assessment, questions, and assumptions.
2. **Codebase Inference (Limited):** While direct codebase access is not provided, we will infer architectural details, component functionalities, and data flow based on the plugin's documentation, the provided design review, and general knowledge of Jenkins plugin architecture and Groovy scripting. We will leverage the information available at the provided GitHub repository (https://github.com/jenkinsci/job-dsl-plugin) and official Jenkins documentation to understand the plugin's inner workings.
3. **Threat Modeling:** Based on the inferred architecture and data flow, we will perform threat modeling to identify potential vulnerabilities and attack vectors relevant to the Job DSL Plugin. This will involve considering common web application and plugin security risks, as well as risks specific to DSL processing and CI/CD automation.
4. **Security Control Mapping:** We will map the existing and recommended security controls against the identified threats to assess their effectiveness and identify gaps.
5. **Recommendation and Mitigation Strategy Development:** Based on the threat modeling and security control assessment, we will develop specific, actionable, and tailored security recommendations and mitigation strategies for the Job DSL Plugin. These recommendations will be practical and directly address the identified risks within the context of a Jenkins CI/CD environment.
6. **Output Generation:**  The findings, analysis, recommendations, and mitigation strategies will be documented in this deep security analysis report.

### 2. Security Implications of Key Components

Based on the C4 Container diagram and descriptions, the key components and their security implications are analyzed below:

**a) Jenkins Web Application:**

* **Security Implications:** As the user interface and API entry point to Jenkins, the Web Application is a critical component for authentication, authorization, and input validation. Vulnerabilities here could lead to unauthorized access to Jenkins, manipulation of CI/CD pipelines, and exposure of sensitive information.
    * **Risk of XSS and CSRF:**  If input validation and output encoding are not properly implemented, the web application could be vulnerable to Cross-Site Scripting (XSS) attacks, allowing malicious scripts to be injected and executed in users' browsers. Cross-Site Request Forgery (CSRF) vulnerabilities could allow attackers to perform actions on behalf of authenticated users without their consent.
    * **API Security:**  The Jenkins API, if not properly secured, could be exploited for unauthorized access and manipulation of Jenkins configurations and jobs. Weak authentication or authorization mechanisms in the API endpoints could be targeted.
    * **Session Management:** Insecure session management could lead to session hijacking or session fixation attacks, allowing attackers to impersonate legitimate users.

**b) Job DSL Plugin:**

* **Security Implications:** This plugin is central to processing DSL scripts and generating Jenkins job configurations. Its security is paramount as vulnerabilities here could directly impact the integrity and security of the entire CI/CD pipeline.
    * **DSL Script Injection:** The plugin must rigorously validate DSL scripts to prevent injection attacks. Maliciously crafted DSL scripts could potentially execute arbitrary code on the Jenkins server, bypass security controls, or gain unauthorized access to resources. This is the most critical security concern for this plugin.
    * **Authorization Bypass:**  If the plugin does not properly integrate with Jenkins' authorization model, it could be possible for unauthorized users to create or modify jobs through DSL scripts, even if they lack permissions through the Jenkins UI.
    * **Secure Credential Handling:** DSL scripts might need to handle credentials. If the plugin doesn't enforce secure credential management practices (e.g., using Jenkins credential store), sensitive information could be exposed in plain text within DSL scripts or job configurations.
    * **Plugin Vulnerabilities:** Like any software, the Job DSL Plugin itself could contain vulnerabilities (e.g., in parsing logic, dependency libraries). Exploiting these vulnerabilities could compromise the Jenkins server.

**c) Jenkins Core:**

* **Security Implications:** Jenkins Core provides the underlying security framework and execution environment. Its security is fundamental to the overall security of Jenkins and its plugins.
    * **Core Vulnerabilities:** Vulnerabilities in Jenkins Core itself could be exploited to compromise the entire Jenkins instance, including the Job DSL Plugin.
    * **Plugin Isolation Issues:** If Jenkins Core's plugin isolation mechanisms are weak, vulnerabilities in the Job DSL Plugin could potentially affect other parts of Jenkins or vice versa.
    * **Resource Management:**  Jenkins Core's resource management capabilities are crucial to prevent denial-of-service attacks or resource exhaustion caused by malicious DSL scripts or plugin vulnerabilities.

**d) DSL Scripts:**

* **Security Implications:** DSL scripts are configuration-as-code and directly control the behavior of Jenkins jobs. Their security is critical as they can introduce misconfigurations or vulnerabilities into the CI/CD pipeline.
    * **Misconfigurations:**  Incorrectly written DSL scripts can lead to misconfigured jobs, creating security weaknesses in deployed applications or the CI/CD pipeline itself. This includes overly permissive permissions, exposed credentials, or insecure build steps.
    * **Accidental Exposure of Secrets:** Developers might unintentionally embed sensitive information (credentials, API keys) directly into DSL scripts if secure credential management practices are not followed.
    * **Lack of Version Control and Review:** If DSL scripts are not properly version controlled and subjected to code review, it becomes difficult to track changes, audit configurations, and identify potential security issues before they are deployed.

### 3. Architecture, Components, and Data Flow Inference

Based on the provided diagrams and descriptions, we can infer the following architecture, components, and data flow:

**Architecture:**

The Job DSL Plugin operates within the Jenkins Server environment, extending the functionality of Jenkins Core. It interacts with the Jenkins Web Application for user interaction and management. DSL scripts, stored in Source Code Repositories, are the input to the plugin. The plugin processes these scripts to generate Jenkins job configurations, which are then managed and executed by Jenkins Core.

**Components:**

* **Jenkins Users:** Interact with Jenkins through the Web Application or API to manage DSL scripts and jobs.
* **Source Code Repositories:** Store DSL scripts alongside application code, providing version control and access control.
* **Jenkins Web Application:** Provides UI and API for managing Jenkins, including DSL script management and job monitoring.
* **Job DSL Plugin:** Parses DSL scripts, generates Jenkins job configurations, and manages the lifecycle of DSL-generated jobs.
* **Jenkins Core:**  Provides the runtime environment, security framework, job scheduling, and execution capabilities for Jenkins and its plugins.
* **Target Systems:**  External systems where applications are deployed, interacted with by Jenkins jobs defined by DSL scripts.

**Data Flow:**

1. **DSL Script Creation/Modification:** Jenkins Users create or modify DSL scripts and commit them to Source Code Repositories.
2. **DSL Script Retrieval:** Jenkins (potentially triggered by a webhook or user action) retrieves DSL scripts from Source Code Repositories.
3. **DSL Script Processing:** The Job DSL Plugin parses and interprets the retrieved DSL scripts.
4. **Job Configuration Generation:** Based on the DSL script, the plugin generates Jenkins job configurations in Jenkins' internal format.
5. **Job Creation/Update:** The plugin uses Jenkins Core APIs to create new Jenkins jobs or update existing ones based on the generated configurations.
6. **Job Execution:** Jenkins Core schedules and executes the jobs defined by the DSL scripts, potentially interacting with Target Systems for deployment or other tasks.
7. **Job Management:** Jenkins Users can manage (view, trigger, monitor) the DSL-generated jobs through the Jenkins Web Application or API.

**Inferred Security-Relevant Data Flow Points:**

* **DSL Script Input to Job DSL Plugin:** This is a critical point for input validation. Malicious scripts could be injected here.
* **Job Configuration Generation within Job DSL Plugin:**  Sensitive data handling (credentials) and authorization checks should occur here.
* **Job Creation/Update via Jenkins Core API:** Authorization should be enforced by Jenkins Core at this point to ensure only authorized actions are performed.
* **Job Execution by Jenkins Core:** Least privilege principle should be applied to job execution to limit the impact of compromised jobs.
* **Storage of Job Configurations within Jenkins Core:** Secure storage of sensitive information within job configurations is important.

### 4. Specific Security Recommendations for Job DSL Plugin

Based on the analysis, here are specific security recommendations tailored to the Job DSL Plugin:

1. ** 강화된 DSL 스크립트 입력 유효성 검사 (Enhanced DSL Script Input Validation):**
    * **Recommendation:** Implement strict input validation for all DSL script inputs within the Job DSL Plugin. This should go beyond basic syntax checks and include semantic validation to prevent injection attacks.
    * **Specific Actions:**
        * **Whitelist allowed DSL commands and parameters:** Define a strict whitelist of allowed Groovy commands and Job DSL constructs. Disallow or sanitize potentially dangerous commands (e.g., `executeShell`, `systemGroovyScript`) unless explicitly required and carefully controlled.
        * **Parameter validation:** Validate the data type, format, and allowed values for all parameters used in DSL scripts. Enforce constraints to prevent unexpected or malicious inputs.
        * **Contextual validation:**  Validate DSL script logic based on the intended context. For example, if a DSL script is supposed to create a deployment job, validate that it only uses deployment-related commands and parameters.
        * **Consider using a sandboxed Groovy environment:** Explore the feasibility of running DSL scripts in a sandboxed Groovy environment to limit the impact of malicious code execution.

2. **최소 권한 원칙 DSL 스크립트 실행 (Least Privilege Principle for DSL Script Execution):**
    * **Recommendation:** Ensure that Jenkins jobs generated by DSL scripts execute with the minimum necessary privileges.
    * **Specific Actions:**
        * **Default to restricted execution context:** By default, configure DSL-generated jobs to run with restricted permissions.
        * **Granular permission control:** Provide mechanisms within the DSL to allow users to explicitly define the required permissions for jobs, but enforce a review process for requests for elevated privileges.
        * **Avoid running jobs as the Jenkins master user:**  Never default to running jobs as the Jenkins master user. Utilize agent-specific users or dedicated service accounts with limited permissions.
        * **Implement workspace isolation:** Ensure proper workspace isolation between jobs to prevent cross-job contamination or unauthorized access to other job's data.

3. **보안 기본값 작업 구성 (Secure Defaults for Job Configurations):**
    * **Recommendation:** Encourage or enforce secure default settings for jobs created via DSL.
    * **Specific Actions:**
        * **Enable security plugins by default:**  If applicable, DSL scripts should automatically enable recommended security plugins (e.g., Credentials Binding Plugin, Role-Based Authorization Strategy) for generated jobs.
        * **Enforce authentication and authorization:** Ensure that DSL-generated jobs, by default, inherit or explicitly configure appropriate authentication and authorization settings.
        * **Disable anonymous access:**  Discourage or prevent DSL scripts from creating jobs with anonymous access enabled.
        * **Secure credential management by default:**  Guide users to use Jenkins credential store within DSL scripts and provide DSL constructs that simplify secure credential retrieval and usage.

4. **정적 분석 DSL 스크립트 (Static Analysis of DSL Scripts):**
    * **Recommendation:** Integrate static analysis tools into the CI/CD pipeline to automatically scan DSL scripts for potential security vulnerabilities and misconfigurations before they are applied to Jenkins.
    * **Specific Actions:**
        * **Integrate linters and SAST tools:** Use linters and Static Application Security Testing (SAST) tools specifically designed for Groovy or general-purpose scripting languages to scan DSL scripts.
        * **Custom security rules:** Develop custom security rules for static analysis tools to detect Job DSL-specific security issues, such as use of insecure commands, hardcoded credentials, or overly permissive configurations.
        * **Automated scanning in CI/CD pipeline:**  Integrate static analysis as a mandatory step in the CI/CD pipeline for DSL script changes. Fail the pipeline if critical security issues are detected.
        * **Provide feedback to developers:**  Provide clear and actionable feedback to developers on identified security issues in DSL scripts, guiding them to remediate vulnerabilities.

5. **보안 감사 및 로깅 강화 (Enhanced Security Auditing and Logging):**
    * **Recommendation:** Improve auditing and logging related to DSL script processing and job generation to enhance security monitoring and incident response capabilities.
    * **Specific Actions:**
        * **Log DSL script processing events:** Log events related to DSL script parsing, validation, and job configuration generation, including timestamps, user information, and script details.
        * **Audit job creation/modification via DSL:**  Implement detailed audit logging for job creation and modification actions performed through the Job DSL Plugin, including who initiated the action and what changes were made.
        * **Centralized logging:**  Ensure that Job DSL Plugin logs are integrated into a centralized logging system for security monitoring and analysis.
        * **Security dashboards and alerts:**  Create security dashboards and alerts based on Job DSL Plugin logs to detect suspicious activities or potential security incidents.

6. **정기적인 플러그인 보안 업데이트 및 패치 (Regular Plugin Security Updates and Patching):**
    * **Recommendation:**  Maintain the Job DSL Plugin with regular security updates and patching to address any identified vulnerabilities.
    * **Specific Actions:**
        * **Monitor security advisories:**  Actively monitor security advisories and vulnerability reports related to the Job DSL Plugin and its dependencies.
        * **Timely patching:**  Apply security patches and updates promptly when they are released by the plugin maintainers.
        * **Automated plugin update process:**  Implement an automated process for checking and applying plugin updates to ensure timely patching.
        * **Vulnerability scanning of plugin dependencies:**  Regularly scan the plugin's dependencies for known vulnerabilities and update them as needed.

### 5. Tailored Mitigation Strategies Applicable to Identified Threats

Here are tailored mitigation strategies for the identified threats, applicable to the Job DSL Plugin:

| **Threat**                                  | **Mitigation Strategy**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | **Mitigation**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       