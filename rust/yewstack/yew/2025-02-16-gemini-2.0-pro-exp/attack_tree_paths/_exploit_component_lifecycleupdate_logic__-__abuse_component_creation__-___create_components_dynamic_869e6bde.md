Okay, let's craft a deep analysis of the specified attack tree path, focusing on the Yew framework.

```markdown
# Deep Analysis of Yew Attack Tree Path: Dynamic Component Abuse

## 1. Objective

This deep analysis aims to thoroughly examine the security risks associated with the dynamic creation and manipulation of Yew components, specifically focusing on the attack path:

`[Exploit Component Lifecycle/Update Logic] -> [Abuse Component Creation] -> [[Create Components Dynamically]] / [[Inject Malicious Props]]`

The goal is to:

*   Identify specific vulnerabilities within this attack path.
*   Assess the likelihood and impact of these vulnerabilities.
*   Propose concrete mitigation strategies for Yew developers.
*   Provide guidance on detection and prevention.

## 2. Scope

This analysis is limited to the specified attack tree path within the context of a Yew-based web application.  It focuses on:

*   **Dynamic Component Creation:**  How user input can influence the *number* and *type* of components created.
*   **Malicious Prop Injection:** How user input can be used to inject malicious values into component props.
*   **Yew-Specific Considerations:**  We will consider Yew's component model, lifecycle methods, and rendering mechanisms.

We will *not* cover:

*   General web application vulnerabilities (e.g., SQL injection, session management issues) that are not directly related to Yew's component system.
*   Attacks targeting the server-side infrastructure (unless Yew is used for server-side rendering and the attack path is relevant).
*   Attacks that exploit vulnerabilities in third-party libraries *unless* those libraries are commonly used with Yew and the interaction creates a specific risk.

## 3. Methodology

This analysis will employ the following methodology:

1.  **Threat Modeling:**  We will use the attack tree as a starting point to identify potential threat actors, attack vectors, and attack goals.
2.  **Code Review (Hypothetical):**  Since we don't have access to a specific application's codebase, we will construct hypothetical Yew code snippets that demonstrate the vulnerabilities and mitigations.  This will be based on best practices and common patterns in Yew development.
3.  **Vulnerability Analysis:**  We will analyze the hypothetical code and the attack vectors to determine the likelihood, impact, effort, skill level, and detection difficulty of each vulnerability.
4.  **Mitigation Recommendation:**  For each identified vulnerability, we will propose specific, actionable mitigation strategies that Yew developers can implement.
5.  **Detection Guidance:**  We will provide guidance on how to detect these vulnerabilities during development and in production.

## 4. Deep Analysis of the Attack Tree Path

### 4.1.  `[Create Components Dynamically]`

#### 4.1.1. Attack Vector Analysis

*   **User Input Controls Number of Components:**

    *   **Scenario:**  Imagine a Yew component that displays a list of items.  The user can enter a number, and the application creates that many `ListItem` components.
    *   **Attack:**  An attacker enters a very large number (e.g., 1,000,000).  This could lead to:
        *   **Browser Freeze/Crash:**  The browser's JavaScript engine and rendering engine may be overwhelmed by the sheer number of DOM nodes.
        *   **Memory Exhaustion:**  Each component consumes memory.  A massive number of components can exhaust available memory.
        *   **Network Bandwidth Consumption (if data is fetched per component):**  If each component triggers a network request, this could flood the server and consume excessive bandwidth.

    *   **Hypothetical Code (Vulnerable):**

        ```rust
        use yew::prelude::*;

        pub struct MyComponent {
            count: usize,
        }

        pub enum Msg {
            UpdateCount(String),
        }

        impl Component for MyComponent {
            type Message = Msg;
            type Properties = ();

            fn create(_ctx: &Context<Self>) -> Self {
                Self { count: 0 }
            }

            fn update(&mut self, _ctx: &Context<Self>, msg: Self::Message) -> bool {
                match msg {
                    Msg::UpdateCount(value) => {
                        if let Ok(new_count) = value.parse::<usize>() {
                            self.count = new_count;
                            true // Re-render
                        } else {
                            false // Don't re-render on invalid input
                        }
                    }
                }
            }

            fn view(&self, ctx: &Context<Self>) -> Html {
                html! {
                    <div>
                        <input type="text" oninput={ctx.link().callback(|e: InputEvent| Msg::UpdateCount(e.data().unwrap_or_default()))} />
                        <div>
                            { for (0..self.count).map(|_| html! { <MySubComponent /> }) }
                        </div>
                    </div>
                }
            }
        }

        pub struct MySubComponent;

        impl Component for MySubComponent {
            type Message = ();
            type Properties = ();

            fn create(_ctx: &Context<Self>) -> Self {
                Self
            }

            fn view(&self, _ctx: &Context<Self>) -> Html {
                html! { <div>{"Subcomponent"}</div> }
            }
        }
        ```

*   **User Input Controls Type of Component:**

    *   **Scenario:**  A Yew application allows users to select a "widget" type from a dropdown, and then creates a component of that type.
    *   **Attack:**  An attacker manipulates the request (e.g., using browser developer tools) to specify a component type that is not intended to be created by the user.  This could lead to:
        *   **Logic Errors:**  The unexpected component might interact with the application state in unintended ways.
        *   **Exploitation of Component Vulnerabilities:**  If the attacker can trigger the creation of a component with known vulnerabilities, they might be able to exploit those vulnerabilities.
        *   **Information Disclosure:**  The unexpected component might reveal sensitive information.

    *   **Hypothetical Code (Vulnerable):**

        ```rust
        // ... (Similar structure to the previous example) ...

        fn view(&self, ctx: &Context<Self>) -> Html {
            html! {
                <div>
                    <select onchange={ctx.link().callback(|e: Event| {
                        let target: HtmlSelectElement = e.target_unchecked_into();
                        Msg::UpdateComponentType(target.value())
                    })}>
                        <option value="WidgetA">{"Widget A"}</option>
                        <option value="WidgetB">{"Widget B"}</option>
                    </select>
                    <div>
                        { self.render_selected_component() }
                    </div>
                </div>
            }
        }

        fn render_selected_component(&self) -> Html {
            match self.component_type.as_str() {
                "WidgetA" => html! { <WidgetA /> },
                "WidgetB" => html! { <WidgetB /> },
                // NO DEFAULT CASE!  This is the vulnerability.
                _ => html!{}, //Should return error or default component
            }
        }
        ```

#### 4.1.2. Mitigation Strategies

*   **Strictly Limit Component Creation:**

    *   **Hard Limit:**  Define a maximum number of components that can be created dynamically.  Reject any attempts to exceed this limit.

        ```rust
        // ... (Inside the `update` method) ...
        Msg::UpdateCount(value) => {
            if let Ok(new_count) = value.parse::<usize>() {
                self.count = new_count.min(MAX_COMPONENTS); // MAX_COMPONENTS is a constant
                true
            } else {
                false
            }
        }
        ```

*   **Whitelist Allowed Component Types:**

    *   **Enum for Component Types:**  Use an enum to represent the allowed component types.  This provides type safety and makes it easy to validate the input.

        ```rust
        #[derive(Clone, PartialEq)]
        pub enum AllowedComponentType {
            WidgetA,
            WidgetB,
        }

        // ... (Inside the component) ...
        component_type: AllowedComponentType,

        // ... (Inside the `update` method) ...
        Msg::UpdateComponentType(value) => {
            self.component_type = match value.as_str() {
                "WidgetA" => AllowedComponentType::WidgetA,
                "WidgetB" => AllowedComponentType::WidgetB,
                _ => return false, // Invalid component type
            };
            true
        }

        // ... (Inside the `view` method) ...
        fn render_selected_component(&self) -> Html {
            match self.component_type {
                AllowedComponentType::WidgetA => html! { <WidgetA /> },
                AllowedComponentType::WidgetB => html! { <WidgetB /> },
            }
        }
        ```

*   **Rate Limiting:**

    *   **Debounce/Throttle Input:**  Use Yew's `setTimeout` or a custom debouncing/throttling mechanism to limit the frequency of component creation requests.  This prevents an attacker from rapidly submitting requests to create many components.

        ```rust
        use std::time::Duration;
        use yew::platform::time::sleep;
        // ... (Inside the `update` method) ...
         Msg::UpdateCount(value) => {
                    if let Ok(new_count) = value.parse::<usize>() {
                        let link = ctx.link().clone();
                        let new_count =  new_count.min(MAX_COMPONENTS);
                        spawn_local(async move {
                            sleep(Duration::from_millis(500)).await; //Debounce 500ms
                            link.send_message(Msg::SetCount(new_count));
                        });
                    }
                    false // Prevent immediate re-render
                },
                Msg::SetCount(new_count) => {
                    self.count = new_count;
                    true
                }
        ```

#### 4.1.3.  Vulnerability Assessment (Create Components Dynamically)

| Metric              | Assessment     | Justification                                                                                                                                                                                                                                                           |
| --------------------- | -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Likelihood**      | Medium         | Attackers can easily manipulate client-side input.  The prevalence of dynamic component creation in web applications makes this a likely target.                                                                                                                      |
| **Impact**          | Medium to High | DoS is a significant concern.  Unexpected component creation can lead to logic errors, data leaks, or even further exploitation.                                                                                                                                     |
| **Effort**          | Low to Medium  | Manipulating input is trivial.  Crafting a sophisticated attack to exploit unexpected component creation might require more effort.                                                                                                                                  |
| **Skill Level**     | Intermediate   | Requires understanding of web application fundamentals and potentially some knowledge of Yew's component model.                                                                                                                                                     |
| **Detection Difficulty** | Medium to Hard | DoS is relatively easy to detect (performance degradation).  Detecting subtle logic errors caused by unexpected component creation can be very difficult, especially in complex applications.  Requires thorough logging, monitoring, and potentially fuzz testing. |

### 4.2. `[Inject Malicious Props]`

#### 4.2.1. Attack Vector Analysis

*   **User Input as Props:**

    *   **Scenario:**  A Yew component receives user input (e.g., a comment, a username, a URL) and uses it as a prop for a child component.
    *   **Attack:**  An attacker injects malicious content into the input field.  This could be:
        *   **XSS Payload:**  `<script>alert('XSS')</script>` or a more sophisticated JavaScript payload.
        *   **Malformed Data:**  Data that violates the expected format or constraints of the prop, leading to errors or unexpected behavior in the child component.
        *   **Control Characters:**  Characters that might interfere with the component's logic or rendering.

    *   **Hypothetical Code (Vulnerable):**

        ```rust
        use yew::prelude::*;

        #[derive(Properties, PartialEq)]
        pub struct MySubComponentProps {
            pub user_input: String,
        }

        pub struct MySubComponent {
            props: MySubComponentProps
        }

        impl Component for MySubComponent {
            type Message = ();
            type Properties = MySubComponentProps;

            fn create(ctx: &Context<Self>) -> Self {
                Self {
                    props: ctx.props().clone()
                }
            }
            fn changed(&mut self, ctx: &Context<Self>) -> bool {
                if self.props != *ctx.props() {
                    self.props = ctx.props().clone();
                    true
                } else {
                    false
                }
            }

            fn view(&self, _ctx: &Context<Self>) -> Html {
                // DANGEROUS: Directly rendering user input without sanitization!
                html! { <div>{self.props.user_input.clone()}</div> }
            }
        }

        pub struct MyComponent;
        //...
        fn view(&self, ctx: &Context<Self>) -> Html {
                html! {
                    <div>
                        <input type="text" oninput={ctx.link().callback(|e: InputEvent| Msg::UpdateUserInput(e.data().unwrap_or_default()))} />
                        <MySubComponent user_input={self.user_input.clone()} />
                    </div>
                }
            }
        ```

#### 4.2.2. Mitigation Strategies

*   **Thorough Prop Validation:**

    *   **Strong Typing:**  Use appropriate types for props (e.g., `String`, `i32`, custom enums).  Avoid using `String` for everything if more specific types are available.
    *   **Custom Validation Logic:**  Implement validation logic within the `changed` lifecycle method (or in a separate validation function) to ensure that props meet specific criteria.

        ```rust
        // ... (Inside `MySubComponent`) ...
        fn changed(&mut self, ctx: &Context<Self>) -> bool {
            if self.props != *ctx.props() {
                if is_valid_user_input(&ctx.props().user_input) { // Custom validation function
                    self.props = ctx.props().clone();
                    true
                } else {
                    // Handle invalid input (e.g., display an error message)
                    false
                }
            } else {
                false
            }
        }

        fn is_valid_user_input(input: &str) -> bool {
            // Implement validation logic here (e.g., length checks, character restrictions, etc.)
            input.len() <= 255 && !input.contains("<script>") // Example: Basic length and XSS check
        }
        ```

*   **Sanitize Props (if necessary):**

    *   **`html! {}` Escaping:**  Yew's `html! {}` macro automatically escapes HTML entities, preventing basic XSS attacks.  This is the *primary* defense against XSS.  The vulnerable example above *would* be safe if it used `html! { <div>{&self.props.user_input}</div> }` (note the `&`). The `clone()` call was making it vulnerable.
    *   **`VNode::from_html_unchecked` (Use with Extreme Caution):**  If you *must* use `VNode::from_html_unchecked` (e.g., to render HTML from a trusted source), you are responsible for sanitizing the input *yourself*.  Use a dedicated HTML sanitization library (e.g., `ammonia`, `sanitize-html`).  **Never use `VNode::from_html_unchecked` with untrusted input.**
    * **Sanitization Example (using ammonia):**
        ```rust
        use ammonia::clean;
        // ...
        fn view(&self, _ctx: &Context<Self>) -> Html {
            let sanitized_input = clean(&self.props.user_input);
            // It's still better to use the escaped version if possible:
            html! { <div inner_html={sanitized_input}></div> }
            // Or, even better, if you don't need HTML:
            // html! { <div>{sanitized_input}</div> }
        }
        ```

*   **Consider Immutable Props:**

    *   **`Rc<String>` or `Cow<'static, str>`:**  Using immutable data structures for props can prevent accidental modification of the prop values within the component. This is a good practice in general, but it's not a primary defense against malicious input.

#### 4.2.3. Vulnerability Assessment (Inject Malicious Props)

| Metric              | Assessment     | Justification                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

In this