Unable to find image 'ghcr.io/xvnpw/ai-security-analyzer:latest' locally
latest: Pulling from xvnpw/ai-security-analyzer
38a8310d387e: Pulling fs layer
f4d80a761251: Pulling fs layer
98636e63ee65: Pulling fs layer
976ae72214aa: Pulling fs layer
d007902a3e68: Pulling fs layer
6a74ba77fcee: Pulling fs layer
20aefc12af1b: Pulling fs layer
8f1a114c690c: Pulling fs layer
abea7197442a: Pulling fs layer
b5c921081441: Pulling fs layer
e109f0568a82: Pulling fs layer
71433fcbef62: Pulling fs layer
976ae72214aa: Waiting
d007902a3e68: Waiting
6a74ba77fcee: Waiting
8f1a114c690c: Waiting
20aefc12af1b: Waiting
abea7197442a: Waiting
e109f0568a82: Waiting
b5c921081441: Waiting
71433fcbef62: Waiting
38a8310d387e: Verifying Checksum
38a8310d387e: Download complete
f4d80a761251: Verifying Checksum
f4d80a761251: Download complete
98636e63ee65: Verifying Checksum
98636e63ee65: Download complete
976ae72214aa: Verifying Checksum
976ae72214aa: Download complete
38a8310d387e: Pull complete
d007902a3e68: Verifying Checksum
d007902a3e68: Download complete
20aefc12af1b: Verifying Checksum
20aefc12af1b: Download complete
8f1a114c690c: Download complete
abea7197442a: Verifying Checksum
abea7197442a: Download complete
6a74ba77fcee: Verifying Checksum
6a74ba77fcee: Download complete
e109f0568a82: Verifying Checksum
e109f0568a82: Download complete
71433fcbef62: Verifying Checksum
71433fcbef62: Download complete
f4d80a761251: Pull complete
b5c921081441: Verifying Checksum
b5c921081441: Download complete
98636e63ee65: Pull complete
976ae72214aa: Pull complete
d007902a3e68: Pull complete
6a74ba77fcee: Pull complete
20aefc12af1b: Pull complete
8f1a114c690c: Pull complete
abea7197442a: Pull complete
b5c921081441: Pull complete
e109f0568a82: Pull complete
71433fcbef62: Pull complete
Digest: sha256:74d3aa62420762cf8217587f5f1cec2e42b4b56554fc4d0f18532c5200a4e6c3
Status: Downloaded newer image for ghcr.io/xvnpw/ai-security-analyzer:latest
2025-01-10 07:26:02,470 - __main__ - INFO - Starting AI Security Analyzer
2025-01-10 07:26:02,506 - ai_security_analyzer.github2sd_agents - INFO - Internal step 1 of 2
2025-01-10 07:26:18,024 - ai_security_analyzer.github2sd_agents - INFO - Internal step 2 of 2
2025-01-10 07:26:33,880 - ai_security_analyzer.github2sd_agents - INFO - Getting intermediate response
2025-01-10 07:26:33,881 - ai_security_analyzer.github2sd_agents - INFO - Getting deep analysis of security design review
2025-01-10 07:26:54,055 - ai_security_analyzer.graphs - INFO - Actual token usage: 17152
2025-01-10 07:26:54,055 - __main__ - INFO - AI Security Analyzer completed successfully
2025-01-10 07:26:58,894 - __main__ - INFO - Starting AI Security Analyzer
2025-01-10 07:26:58,933 - ai_security_analyzer.github2tm_agents - INFO - Internal step 1 of 3
2025-01-10 07:27:12,490 - ai_security_analyzer.github2tm_agents - INFO - Internal step 2 of 3
2025-01-10 07:27:26,551 - ai_security_analyzer.github2tm_agents - INFO - Internal step 3 of 3
2025-01-10 07:27:34,963 - ai_security_analyzer.github2tm_agents - INFO - Getting intermediate response
2025-01-10 07:27:34,964 - ai_security_analyzer.github2tm_agents - INFO - Getting structured threat model
2025-01-10 07:27:39,202 - ai_security_analyzer.github2tm_agents - INFO - Getting threat details 1 of 4
2025-01-10 07:27:55,167 - ai_security_analyzer.github2tm_agents - INFO - Getting threat details 2 of 4
2025-01-10 07:28:10,289 - ai_security_analyzer.github2tm_agents - INFO - Getting threat details 3 of 4
2025-01-10 07:28:36,512 - ai_security_analyzer.github2tm_agents - INFO - Getting threat details 4 of 4
2025-01-10 07:28:54,316 - ai_security_analyzer.github2tm_agents - INFO - Getting threats final response
2025-01-10 07:28:54,317 - ai_security_analyzer.graphs - INFO - Actual token usage: 35218
2025-01-10 07:28:54,318 - __main__ - INFO - AI Security Analyzer completed successfully
2025-01-10 07:28:58,695 - __main__ - INFO - Starting AI Security Analyzer
2025-01-10 07:28:58,734 - ai_security_analyzer.github2as_agents - INFO - Internal step 1 of 3
2025-01-10 07:29:08,481 - ai_security_analyzer.github2as_agents - INFO - Internal step 2 of 3
2025-01-10 07:29:19,563 - ai_security_analyzer.github2as_agents - INFO - Internal step 3 of 3
2025-01-10 07:29:25,604 - ai_security_analyzer.github2as_agents - INFO - Getting intermediate response
2025-01-10 07:29:25,605 - ai_security_analyzer.github2as_agents - INFO - Getting structured attack surface analysis
2025-01-10 07:29:29,651 - ai_security_analyzer.github2as_agents - INFO - Getting attack surface details 1 of 4
2025-01-10 07:29:48,526 - ai_security_analyzer.github2as_agents - INFO - Getting attack surface details 2 of 4
2025-01-10 07:30:05,313 - ai_security_analyzer.github2as_agents - INFO - Getting attack surface details 3 of 4
2025-01-10 07:30:23,864 - ai_security_analyzer.github2as_agents - INFO - Getting attack surface details 4 of 4
2025-01-10 07:30:41,880 - ai_security_analyzer.github2as_agents - INFO - Getting attack surfaces final response
2025-01-10 07:30:41,881 - ai_security_analyzer.graphs - INFO - Actual token usage: 29023
2025-01-10 07:30:41,881 - __main__ - INFO - AI Security Analyzer completed successfully
2025-01-10 07:30:46,487 - __main__ - INFO - Starting AI Security Analyzer
2025-01-10 07:30:46,525 - ai_security_analyzer.github2at_agents - INFO - Internal step 1 of 4
2025-01-10 07:31:03,021 - ai_security_analyzer.github2at_agents - INFO - Internal step 2 of 4
2025-01-10 07:31:21,517 - ai_security_analyzer.github2at_agents - INFO - Internal step 3 of 4
2025-01-10 07:31:40,992 - ai_security_analyzer.github2at_agents - INFO - Internal step 4 of 4
2025-01-10 07:31:45,065 - ai_security_analyzer.github2at_agents - INFO - Getting intermediate response
2025-01-10 07:31:45,066 - ai_security_analyzer.github2at_agents - INFO - Getting structured attack tree path analysis
2025-01-10 07:31:50,339 - ai_security_analyzer.github2at_agents - ERROR - Error on structured attack tree path analysis: Failed to parse AttackTreeAnalysis from completion {"attack_tree_objective": "Gain unauthorized access to Spotify accounts or manipulate Spotify data through the application using librespot.", "attack_sub_tree_visualization": "*   Compromise Application via Librespot\n    *   Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**\n            *   Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Replay Attacks **[HIGH RISK PATH]**\n    *   Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**\n    *   Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**\n    *   Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "attack_sub_tree_paths": [{"title": "Compromise Application via Librespot", "text": null}, {"title": "Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot communicates with Spotify servers. Attackers might try to intercept or manipulate this communication."}, {"title": "Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The attacker positions themselves between the application and Spotify servers to eavesdrop and potentially alter communication. This could involve stealing credentials, injecting malicious data, or downgrading security."}, {"title": "Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot transmits Spotify credentials could allow attackers to intercept and steal them during network communication."}, {"title": "Replay Attacks **[HIGH RISK PATH]**", "text": "Attackers capture valid authentication tokens or API requests and resend them later to perform actions as the legitimate user."}, {"title": "Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Attackers target the mechanisms Librespot uses to authenticate with Spotify."}, {"title": "Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot stores or handles Spotify credentials could allow attackers to steal them."}, {"title": "Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Exploiting weaknesses in how Librespot manages authentication tokens could allow attackers to steal or forge them."}, {"title": "Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**", "text": "If Librespot doesn't securely manage refresh tokens, attackers could steal them and generate new access tokens indefinitely."}, {"title": "Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot relies on other libraries. Attackers could exploit known vulnerabilities in these dependencies."}, {"title": "Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The way the application uses Librespot can introduce vulnerabilities."}, {"title": "Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might not use Librespot's API securely, leading to vulnerabilities. For example, improper input validation before calling Librespot functions."}, {"title": "Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might expose Librespot functionality directly to users without proper authorization or input validation, allowing attackers to bypass application-level security."}, {"title": "Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might store Spotify credentials or tokens obtained through Librespot insecurely, making them accessible to attackers."}]}. Got: 1 validation error for AttackTreeAnalysis
attack_sub_tree_paths.0.text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
2025-01-10 07:31:50,339 - ai_security_analyzer.graphs - ERROR - Graph execution failed: Failed to parse AttackTreeAnalysis from completion {"attack_tree_objective": "Gain unauthorized access to Spotify accounts or manipulate Spotify data through the application using librespot.", "attack_sub_tree_visualization": "*   Compromise Application via Librespot\n    *   Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**\n            *   Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Replay Attacks **[HIGH RISK PATH]**\n    *   Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**\n    *   Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**\n    *   Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "attack_sub_tree_paths": [{"title": "Compromise Application via Librespot", "text": null}, {"title": "Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot communicates with Spotify servers. Attackers might try to intercept or manipulate this communication."}, {"title": "Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The attacker positions themselves between the application and Spotify servers to eavesdrop and potentially alter communication. This could involve stealing credentials, injecting malicious data, or downgrading security."}, {"title": "Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot transmits Spotify credentials could allow attackers to intercept and steal them during network communication."}, {"title": "Replay Attacks **[HIGH RISK PATH]**", "text": "Attackers capture valid authentication tokens or API requests and resend them later to perform actions as the legitimate user."}, {"title": "Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Attackers target the mechanisms Librespot uses to authenticate with Spotify."}, {"title": "Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot stores or handles Spotify credentials could allow attackers to steal them."}, {"title": "Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Exploiting weaknesses in how Librespot manages authentication tokens could allow attackers to steal or forge them."}, {"title": "Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**", "text": "If Librespot doesn't securely manage refresh tokens, attackers could steal them and generate new access tokens indefinitely."}, {"title": "Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot relies on other libraries. Attackers could exploit known vulnerabilities in these dependencies."}, {"title": "Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The way the application uses Librespot can introduce vulnerabilities."}, {"title": "Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might not use Librespot's API securely, leading to vulnerabilities. For example, improper input validation before calling Librespot functions."}, {"title": "Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might expose Librespot functionality directly to users without proper authorization or input validation, allowing attackers to bypass application-level security."}, {"title": "Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might store Spotify credentials or tokens obtained through Librespot insecurely, making them accessible to attackers."}]}. Got: 1 validation error for AttackTreeAnalysis
attack_sub_tree_paths.0.text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
2025-01-10 07:31:50,339 - __main__ - ERROR - Application error: Failed to parse AttackTreeAnalysis from completion {"attack_tree_objective": "Gain unauthorized access to Spotify accounts or manipulate Spotify data through the application using librespot.", "attack_sub_tree_visualization": "*   Compromise Application via Librespot\n    *   Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**\n            *   Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Replay Attacks **[HIGH RISK PATH]**\n    *   Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**\n    *   Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**\n    *   Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**\n        *   Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "attack_sub_tree_paths": [{"title": "Compromise Application via Librespot", "text": null}, {"title": "Exploit Librespot Network Communication Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot communicates with Spotify servers. Attackers might try to intercept or manipulate this communication."}, {"title": "Man-in-the-Middle (MitM) Attack **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The attacker positions themselves between the application and Spotify servers to eavesdrop and potentially alter communication. This could involve stealing credentials, injecting malicious data, or downgrading security."}, {"title": "Steal Spotify credentials transmitted by Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot transmits Spotify credentials could allow attackers to intercept and steal them during network communication."}, {"title": "Replay Attacks **[HIGH RISK PATH]**", "text": "Attackers capture valid authentication tokens or API requests and resend them later to perform actions as the legitimate user."}, {"title": "Exploit Librespot Authentication and Authorization Vulnerabilities **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Attackers target the mechanisms Librespot uses to authenticate with Spotify."}, {"title": "Credential Theft via Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Vulnerabilities in how Librespot stores or handles Spotify credentials could allow attackers to steal them."}, {"title": "Token Exploitation **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Exploiting weaknesses in how Librespot manages authentication tokens could allow attackers to steal or forge them."}, {"title": "Insecure Handling of Refresh Tokens **[HIGH RISK PATH]**", "text": "If Librespot doesn't securely manage refresh tokens, attackers could steal them and generate new access tokens indefinitely."}, {"title": "Exploit Vulnerabilities in Librespot Dependencies **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "Librespot relies on other libraries. Attackers could exploit known vulnerabilities in these dependencies."}, {"title": "Exploit Application's Interaction with Librespot **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The way the application uses Librespot can introduce vulnerabilities."}, {"title": "Insecure Handling of Librespot API **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might not use Librespot's API securely, leading to vulnerabilities. For example, improper input validation before calling Librespot functions."}, {"title": "Exposed Librespot Functionality **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might expose Librespot functionality directly to users without proper authorization or input validation, allowing attackers to bypass application-level security."}, {"title": "Insecure Storage of Librespot Credentials/Tokens by the Application **[CRITICAL NODE]** **[HIGH RISK PATH]**", "text": "The application might store Spotify credentials or tokens obtained through Librespot insecurely, making them accessible to attackers."}]}. Got: 1 validation error for AttackTreeAnalysis
attack_sub_tree_paths.0.text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
2025-01-10 07:32:04,759 - __main__ - INFO - Starting AI Security Analyzer
2025-01-10 07:32:04,796 - ai_security_analyzer.github2at_agents - INFO - Internal step 1 of 4
2025-01-10 07:32:21,020 - ai_security_analyzer.github2at_agents - INFO - Internal step 2 of 4
2025-01-10 07:32:37,844 - ai_security_analyzer.github2at_agents - INFO - Internal step 3 of 4
2025-01-10 07:32:50,520 - ai_security_analyzer.github2at_agents - INFO - Internal step 4 of 4
2025-01-10 07:32:55,866 - ai_security_analyzer.github2at_agents - INFO - Getting intermediate response
2025-01-10 07:32:55,867 - ai_security_analyzer.github2at_agents - INFO - Getting structured attack tree path analysis
2025-01-10 07:33:02,226 - ai_security_analyzer.github2at_agents - INFO - Getting attack tree path details 1 of 2
2025-01-10 07:33:14,113 - ai_security_analyzer.github2at_agents - INFO - Getting attack tree path details 2 of 2
2025-01-10 07:33:28,239 - ai_security_analyzer.github2at_agents - INFO - Getting attack tree paths final response
2025-01-10 07:33:28,240 - ai_security_analyzer.graphs - INFO - Actual token usage: 41622
2025-01-10 07:33:28,240 - __main__ - INFO - AI Security Analyzer completed successfully
