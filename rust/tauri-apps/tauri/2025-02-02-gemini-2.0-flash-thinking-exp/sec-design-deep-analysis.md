## Deep Security Analysis of Tauri Application Framework

### 1. Objective, Scope, and Methodology

**Objective:**

The objective of this deep security analysis is to thoroughly evaluate the security posture of the Tauri application framework, based on the provided security design review documentation. This analysis aims to identify potential security vulnerabilities inherent in the Tauri architecture and its components, and to provide specific, actionable, and tailored security recommendations and mitigation strategies. The focus is on ensuring the confidentiality, integrity, and availability of applications built using Tauri, as well as the framework itself.

**Scope:**

This analysis encompasses the following aspects of the Tauri framework, as described in the provided security design review:

* **Architecture and Components:**  Rust Backend, WebView Frontend, Inter-Process Communication (IPC), Configuration Files, Resources (Assets), Operating System, System WebView, Package Managers, External Services.
* **Data Flow:** Communication pathways between components, data handling within the application, and interactions with external systems.
* **Build and Deployment Processes:** Security considerations during development, build, and distribution of Tauri applications.
* **Identified Security Controls and Requirements:** Review of existing and recommended security controls, and security requirements outlined in the design review.
* **Risk Assessment:** Analysis of critical business processes and data sensitivity related to Tauri applications.

This analysis is limited to the information provided in the security design review document and does not include external testing or source code review beyond what is publicly available.

**Methodology:**

This deep security analysis will follow these steps:

1. **Component Decomposition:** Break down the Tauri framework into its core components as defined in the C4 Context and Container diagrams.
2. **Threat Modeling:** For each component, identify potential security threats and vulnerabilities based on its function, interactions, and dependencies. This will consider common web and desktop application security risks, as well as risks specific to Tauri's architecture.
3. **Security Implication Analysis:** Analyze the potential impact of each identified threat on the confidentiality, integrity, and availability of Tauri applications and the framework.
4. **Tailored Recommendation Generation:** Develop specific security recommendations tailored to the Tauri framework and applications built with it. These recommendations will be directly relevant to the identified threats and the Tauri ecosystem.
5. **Actionable Mitigation Strategy Formulation:** For each recommendation, propose concrete and actionable mitigation strategies that can be implemented by the Tauri core team or application developers. These strategies will be practical, feasible, and aligned with Tauri's design principles.
6. **Documentation and Reporting:**  Document the entire analysis process, including identified threats, recommendations, and mitigation strategies in a clear and structured report.

### 2. Security Implications of Key Components and Mitigation Strategies

#### 2.1. Rust Backend

**Security Implications:**

* **Vulnerability in Rust Code:** Despite Rust's memory safety, logic errors or vulnerabilities can still be introduced in the Rust backend code. These could lead to crashes, denial of service, or even privilege escalation if not handled correctly.
* **API Exposure:** The Rust backend exposes APIs to the WebView Frontend via IPC. Improperly designed or secured APIs can be exploited by malicious frontend code (e.g., due to XSS) to perform unauthorized actions or access sensitive data.
* **Dependency Vulnerabilities:** The Rust backend relies on external Rust crates (dependencies). Vulnerabilities in these dependencies can directly impact the security of the backend.
* **File System Access:** The backend often requires file system access for application logic, data storage, and configuration. Improperly managed file system permissions or vulnerabilities in file handling logic can lead to unauthorized access or manipulation of files.
* **System API Interactions:** The backend interacts with operating system APIs. Vulnerabilities in these interactions or misuse of system APIs can lead to security breaches.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 1: Robust Input Validation and Sanitization in Backend APIs.**
    * **Mitigation Strategy:** Implement strict input validation and sanitization for all data received from the WebView Frontend via IPC in the Rust backend. This includes validating data types, formats, ranges, and lengths. Sanitize inputs to prevent injection attacks if data is used in system commands or database queries. Use libraries like `serde` for safe data deserialization and validation.
* **Recommendation 2: Principle of Least Privilege for Backend Functionality.**
    * **Mitigation Strategy:** Design backend APIs with the principle of least privilege in mind. Only expose necessary functionalities to the frontend and restrict access to sensitive system resources. Implement fine-grained permissions for backend APIs, potentially using a permission system that can be configured in `tauri.conf.json`.
* **Recommendation 3: Regular Dependency Audits and Management for Rust Crates.**
    * **Mitigation Strategy:** Implement automated dependency scanning for Rust crates using tools like `cargo audit` in the CI/CD pipeline. Regularly review and update dependencies to patch known vulnerabilities. Consider using dependency pinning to ensure consistent and secure dependency versions.
* **Recommendation 4: Secure File System Operations in Backend.**
    * **Mitigation Strategy:** When performing file system operations in the Rust backend, carefully validate file paths to prevent path traversal vulnerabilities. Use secure file handling practices, such as avoiding direct user-controlled file paths and implementing proper error handling. Consider using Tauri's path API for secure path resolution.
* **Recommendation 5: Security Hardening of System API Interactions.**
    * **Mitigation Strategy:** When interacting with system APIs, follow secure coding practices and best practices for the specific OS API. Validate inputs and outputs of system API calls. Handle potential errors and exceptions gracefully to prevent information leakage or unexpected behavior. Consider using Tauri's built-in APIs where possible, as they are designed with security in mind.

#### 2.2. WebView Frontend

**Security Implications:**

* **Cross-Site Scripting (XSS):**  If the WebView Frontend renders untrusted or unsanitized user input, it is vulnerable to XSS attacks. Malicious JavaScript code can be injected and executed within the WebView, potentially stealing user data, performing actions on behalf of the user, or compromising the application.
* **Dependency Vulnerabilities (JavaScript):** The WebView Frontend relies on JavaScript libraries and frameworks (managed by npm/yarn). Vulnerabilities in these dependencies can be exploited by attackers.
* **Insecure Content Loading:** If the application loads resources (scripts, stylesheets, images) from untrusted sources over HTTP, it can be vulnerable to Man-in-the-Middle (MITM) attacks and resource injection.
* **Clickjacking:**  If the application does not implement proper frame busting techniques, it might be vulnerable to clickjacking attacks, where malicious websites can overlay transparent frames and trick users into performing unintended actions within the Tauri application.
* **Open Redirects:** If the frontend handles redirects based on user-controlled input without proper validation, it can be vulnerable to open redirect attacks, potentially leading users to phishing sites.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 6: Implement Robust XSS Prevention Measures.**
    * **Mitigation Strategy:** Employ Content Security Policy (CSP) to restrict the sources from which the WebView can load resources, significantly reducing the attack surface for XSS. Use template engines and frameworks that automatically escape user inputs by default. Sanitize user inputs before rendering them in the WebView, especially when dealing with HTML content. Regularly audit frontend code for potential XSS vulnerabilities.
* **Recommendation 7: Secure JavaScript Dependency Management.**
    * **Mitigation Strategy:** Implement automated dependency scanning for JavaScript dependencies using tools like `npm audit` or `yarn audit` in the CI/CD pipeline. Regularly review and update dependencies to patch known vulnerabilities. Use `npm shrinkwrap` or `yarn.lock` to ensure consistent dependency versions and prevent supply chain attacks.
* **Recommendation 8: Enforce HTTPS and Secure Resource Loading.**
    * **Mitigation Strategy:** Ensure that all resources loaded by the WebView Frontend are served over HTTPS. Configure CSP to only allow loading resources from trusted origins and enforce HTTPS. Avoid loading resources from untrusted or unknown sources.
* **Recommendation 9: Implement Frame Busting and Clickjacking Protection.**
    * **Mitigation Strategy:** Implement frame busting techniques in the WebView Frontend to prevent the application from being embedded in frames on malicious websites. Set appropriate HTTP headers like `X-Frame-Options` or `Content-Security-Policy: frame-ancestors 'self'` to control framing behavior.
* **Recommendation 10: Secure Handling of Redirects.**
    * **Mitigation Strategy:** Avoid using user-controlled input directly in redirect URLs. If redirects are necessary, validate and sanitize the target URLs against a whitelist of allowed domains to prevent open redirect vulnerabilities.

#### 2.3. Inter-Process Communication (IPC)

**Security Implications:**

* **IPC Message Tampering:** If the IPC channel is not properly secured, malicious processes or compromised components could potentially intercept and tamper with messages exchanged between the Rust Backend and WebView Frontend.
* **Unauthorized IPC Commands:** If the backend does not properly authorize IPC commands, a compromised WebView Frontend (e.g., due to XSS) could send unauthorized commands to the backend, potentially leading to privilege escalation or unauthorized actions.
* **Data Injection via IPC:**  Vulnerabilities in the IPC message handling logic in either the backend or frontend could allow attackers to inject malicious data or commands through the IPC channel.
* **Denial of Service (DoS) via IPC:**  An attacker could flood the IPC channel with excessive messages, potentially causing a denial of service for the application.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 11: Secure and Authenticated IPC Channel.**
    * **Mitigation Strategy:** Ensure that the IPC channel used by Tauri is inherently secure and provides confidentiality and integrity for messages.  (Tauri already uses a secure IPC mechanism, reinforce this in documentation and testing). Implement authentication and authorization mechanisms for IPC commands to verify the origin and legitimacy of requests.
* **Recommendation 12: Strict Authorization for IPC Commands in Backend.**
    * **Mitigation Strategy:** Implement a robust authorization mechanism in the Rust backend to control which IPC commands can be executed by the WebView Frontend. Define permissions for each IPC command and enforce these permissions based on the context and origin of the request. Use a declarative permission system defined in `tauri.conf.json` to manage IPC command access.
* **Recommendation 13: Input Validation and Sanitization for IPC Messages.**
    * **Mitigation Strategy:** Implement strict input validation and sanitization for all data received via IPC in both the Rust Backend and WebView Frontend. Validate message formats, data types, and content to prevent data injection vulnerabilities.
* **Recommendation 14: Rate Limiting and DoS Prevention for IPC.**
    * **Mitigation Strategy:** Implement rate limiting on IPC message processing in the Rust backend to prevent denial of service attacks caused by excessive IPC requests. Monitor IPC traffic for anomalies and implement mechanisms to detect and mitigate DoS attacks.

#### 2.4. Configuration Files (`tauri.conf.json`)

**Security Implications:**

* **Exposure of Sensitive Information:** Configuration files might inadvertently contain sensitive information such as API keys, database credentials, or other secrets if not managed properly.
* **Configuration Tampering:** If configuration files are not protected, malicious actors could potentially tamper with them to alter application behavior, disable security features, or inject malicious settings.
* **Insecure Default Configurations:**  Default configurations might not be secure by design, potentially leaving applications vulnerable if developers do not customize them appropriately.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 15: Secure Management of Secrets in Configuration.**
    * **Mitigation Strategy:** Avoid storing sensitive secrets directly in `tauri.conf.json` or any configuration files committed to version control. Use environment variables or secure secret management solutions to handle API keys, database credentials, and other sensitive information. Tauri should provide guidance and tools for secure secret management.
* **Recommendation 16: Access Control for Configuration Files.**
    * **Mitigation Strategy:** Ensure that configuration files are protected with appropriate file system permissions to prevent unauthorized access or modification. During deployment, ensure that only authorized processes have read and write access to configuration files.
* **Recommendation 17: Secure Default Configurations and Security Hardening Guidance.**
    * **Mitigation Strategy:**  Provide secure default configurations in `tauri.conf.json` and clearly document security-related configuration options. Offer comprehensive security hardening guidelines and best practices for developers to configure their Tauri applications securely. Include security checklists and examples in the documentation.

#### 2.5. Resources (Assets)

**Security Implications:**

* **Resource Tampering:** If application resources (HTML, CSS, JavaScript, images) are not protected, attackers could potentially tamper with them to inject malicious code or alter application functionality.
* **Supply Chain Attacks via Resources:** If resources are loaded from external sources or dependencies, they could be compromised in a supply chain attack.
* **Information Leakage via Resources:** Resources might inadvertently contain sensitive information if not properly reviewed and managed.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 18: Integrity Checks for Application Resources.**
    * **Mitigation Strategy:** Implement integrity checks (e.g., using checksums or digital signatures) for application resources to detect tampering. Verify resource integrity during application startup or updates. Consider using Subresource Integrity (SRI) for resources loaded from CDNs (though less relevant for packaged desktop apps, still good practice for web-based content).
* **Recommendation 19: Secure Resource Loading and Origin Control.**
    * **Mitigation Strategy:**  Enforce strict origin control for resource loading using Content Security Policy (CSP). Only allow loading resources from trusted origins and package resources within the application bundle to minimize reliance on external sources.
* **Recommendation 20: Regular Security Review of Application Resources.**
    * **Mitigation Strategy:** Conduct regular security reviews of application resources to identify and remove any inadvertently included sensitive information or potential vulnerabilities. Include resource review as part of the secure development lifecycle.

#### 2.6. Operating System and System WebView

**Security Implications:**

* **System WebView Vulnerabilities:** Tauri applications rely on the system WebView for rendering web content. Vulnerabilities in the underlying WebView (Chromium, WebKit) can directly impact the security of Tauri applications. Tauri has limited control over these vulnerabilities, as they are managed by OS vendors.
* **OS-Level Security Vulnerabilities:** Vulnerabilities in the underlying operating system can also be exploited to compromise Tauri applications.
* **Sandboxing Limitations:** While Tauri leverages OS-level sandboxing, the effectiveness of sandboxing can vary across different operating systems and WebView implementations. Sandboxing might not be foolproof and could potentially be bypassed.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 21: Stay Updated with System WebView and OS Security Patches.**
    * **Mitigation Strategy:**  Advise Tauri application developers to encourage end-users to keep their operating systems and system WebViews up-to-date with the latest security patches. Tauri documentation should emphasize the importance of OS and WebView updates for application security.
* **Recommendation 22: Enhance Sandboxing and Principle of Least Privilege.**
    * **Mitigation Strategy:**  Continuously explore and implement stronger sandboxing techniques within Tauri to further isolate the WebView process and limit its access to system resources.  Refine the permission system to enforce the principle of least privilege for both the WebView Frontend and Rust Backend.
* **Recommendation 23: WebView Security Configuration and Hardening.**
    * **Mitigation Strategy:**  Provide guidance and tools for developers to configure the system WebView with secure settings. This might include disabling unnecessary WebView features, enabling security features like site isolation (if available), and configuring appropriate permissions for WebView functionalities.

#### 2.7. Package Managers (npm, yarn, cargo)

**Security Implications:**

* **Dependency Vulnerabilities:** Package managers download dependencies from external registries. These dependencies can contain vulnerabilities that can be exploited in Tauri applications.
* **Supply Chain Attacks:** Package registries or individual packages can be compromised, leading to the distribution of malicious code through dependencies.
* **Typosquatting:** Attackers can create packages with names similar to popular packages (typosquatting) to trick developers into installing malicious dependencies.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 24: Automated Dependency Vulnerability Scanning in CI/CD.**
    * **Mitigation Strategy:** Implement automated dependency vulnerability scanning for both Rust (cargo audit) and JavaScript (npm/yarn audit, Snyk, etc.) dependencies in the CI/CD pipeline. Fail builds if critical vulnerabilities are detected.
* **Recommendation 25: Dependency Pinning and Lock Files.**
    * **Mitigation Strategy:** Encourage developers to use dependency pinning and lock files (Cargo.lock, package-lock.json, yarn.lock) to ensure consistent dependency versions and prevent unexpected updates that might introduce vulnerabilities.
* **Recommendation 26: Use Trusted Package Registries and Package Integrity Checks.**
    * **Mitigation Strategy:**  Advise developers to use trusted package registries and verify package integrity using checksums or signatures when possible. Tauri documentation should recommend best practices for secure dependency management.

#### 2.8. External Services (APIs, Databases)

**Security Implications:**

* **Insecure Communication:** Communication with external services over unencrypted channels (HTTP) can expose sensitive data to interception.
* **API Vulnerabilities:** External APIs might have their own vulnerabilities that can be exploited by attackers.
* **Data Breaches in External Services:** If external services are compromised, data accessed by Tauri applications could be at risk.
* **Authentication and Authorization Issues:** Improperly implemented authentication and authorization mechanisms when interacting with external services can lead to unauthorized access or data breaches.

**Tailored Recommendations & Mitigation Strategies:**

* **Recommendation 27: Enforce HTTPS for All External Communication.**
    * **Mitigation Strategy:**  Ensure that all communication between Tauri applications and external services is conducted over HTTPS to protect data in transit. Enforce HTTPS in application code and configurations.
* **Recommendation 28: Secure API Integration and Input Validation.**
    * **Mitigation Strategy:**  Follow secure API integration best practices when interacting with external APIs. Implement robust input validation and sanitization for data received from external APIs. Be aware of potential vulnerabilities in external APIs and implement appropriate security measures.
* **Recommendation 29: Secure Authentication and Authorization for External Services.**
    * **Mitigation Strategy:** Implement strong authentication and authorization mechanisms when accessing external services. Use industry-standard protocols like OAuth 2.0 or OpenID Connect where appropriate. Securely store and manage API keys and credentials.
* **Recommendation 30: Data Minimization and Privacy Considerations for External Data.**
    * **Mitigation Strategy:**  Minimize the amount of sensitive data exchanged with external services. Implement data privacy measures and comply with relevant data protection regulations (e.g., GDPR, CCPA) when handling data from external sources.

### 3. Actionable and Tailored Mitigation Strategies Summary

| Recommendation # | Security Area             | Recommendation                                                                 | Actionable Mitigation Strategy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     