
## High and Critical FlatBuffers Threats

| Threat | Description (Attacker Action & How) | Impact | Affected FlatBuffers Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Malformed Message Parsing** | Attacker crafts a FlatBuffers message that violates the schema or contains unexpected data types or values. This could involve incorrect offsets, out-of-bounds access, or invalid enum values. | Can cause application crashes, unexpected behavior, data corruption, or potential security vulnerabilities if unchecked data is used in sensitive operations. | Generated Code (Table/Struct Accessors), FlatBuffers Parsing Logic (within generated code) | High |  Implement strict schema validation on received messages before processing. Use the generated verification functions. Implement robust error handling for parsing failures. |
| **Integer Overflow in Offset/Size Fields** | Attacker manipulates offset or size fields within the FlatBuffers binary data to cause integer overflows. This can lead to out-of-bounds memory access during parsing or processing. | Can lead to application crashes, memory corruption, and potentially arbitrary code execution if the overflowed value is used in memory operations. | FlatBuffers Parsing Logic (within generated code), Wire Format | Critical |  Use the generated verification functions which often include checks for valid offsets and sizes. Be aware of potential integer overflow issues in custom processing logic. |
| **Schema Poisoning** | Attacker modifies the `.fbs` schema file before it's used for compilation. This could involve adding malicious fields, changing data types, or introducing circular dependencies. |  Can lead to generation of vulnerable code, unexpected application behavior, data corruption, or denial of service if circular dependencies cause infinite loops during processing. | Schema Definition (`.fbs` files), Compiler (`flatc`) | High |  Store schema files securely with restricted access. Implement version control and integrity checks for schema files. Review schema changes carefully. |
| **Vulnerabilities in Generated Code** |  Bugs or vulnerabilities might exist in the code generated by the `flatc` compiler for specific languages or features. |  Can lead to various security issues depending on the nature of the vulnerability, including crashes, memory corruption, or even code execution. | Generated Code (language-specific) | High | Keep the `flatc` compiler updated to the latest version to benefit from bug fixes and security patches. Review the generated code for potential issues if necessary. Report any suspected vulnerabilities in the `flatc` compiler. |
