Okay, here's a deep analysis of the provided Denial of Service (DoS) attack tree path, focusing on the use of the Facebook Yoga layout engine.

```markdown
# Deep Analysis of Denial of Service (DoS) Attack Path on Yoga-based Application

## 1. Objective, Scope, and Methodology

### 1.1. Objective

The primary objective of this deep analysis is to thoroughly investigate the potential for Denial of Service (DoS) attacks targeting an application that utilizes the Facebook Yoga layout engine.  We aim to identify specific attack vectors, assess their feasibility, and propose mitigation strategies.  This analysis will focus on vulnerabilities *within* Yoga's implementation and how they can be exploited, rather than general DoS attacks against the application's infrastructure (e.g., network flooding).  We will prioritize vulnerabilities that are unique to, or exacerbated by, the use of a layout engine like Yoga.

### 1.2. Scope

This analysis is limited to the following:

*   **Target:**  The Yoga layout engine (https://github.com/facebook/yoga) and its integration within a hypothetical application.  We assume the application uses Yoga for UI layout calculations.  We do *not* cover the application's server-side logic, database, or network infrastructure, except where Yoga's behavior directly impacts them.
*   **Attack Type:**  Denial of Service (DoS) attacks specifically.  We will not analyze other attack types like data breaches, code injection, or privilege escalation, except where they might indirectly contribute to a DoS.
*   **Yoga Version:**  We will consider the latest stable release of Yoga at the time of this analysis, and any known vulnerabilities in previous versions that might still be relevant.  We will also consider common usage patterns and potential misconfigurations.
* **Hypothetical Application:** Since a specific application is not provided, we will analyze based on common use cases of Yoga in mobile (React Native, ComponentKit, Litho) and web (Yoga in JavaScript) applications.

### 1.3. Methodology

The analysis will follow these steps:

1.  **Attack Surface Identification:**  Identify the points of interaction between user-supplied data (or attacker-controlled data) and the Yoga engine.  This includes any APIs, configuration options, or data structures that influence layout calculations.
2.  **Vulnerability Research:**  Review existing Yoga documentation, source code, issue trackers (GitHub), and security advisories for known vulnerabilities or potential weaknesses related to DoS.
3.  **Hypothetical Attack Vector Generation:**  Based on the attack surface and vulnerability research, brainstorm specific attack vectors that could lead to a DoS.  This will involve considering how malicious input could exploit Yoga's algorithms or resource management.
4.  **Feasibility Assessment:**  Evaluate the likelihood, impact, effort, skill level, and detection difficulty of each hypothetical attack vector.  This will involve considering factors like the complexity of the required input, the resources consumed by the attack, and the visibility of the attack's effects.
5.  **Mitigation Strategy Recommendation:**  For each feasible attack vector, propose specific mitigation strategies.  These may include input validation, resource limits, algorithmic improvements, or changes to the application's architecture.
6. **Code Review Focus Areas:** Identify specific areas within the Yoga codebase (or the application's integration with Yoga) that warrant closer scrutiny during code reviews.

## 2. Deep Analysis of the DoS Attack Path

Given the attack tree path:

1.  Denial of Service (DoS) [HIGH RISK]

    *   Overall Description: This is the most likely and impactful category of attacks. The attacker aims to make the application unresponsive or crash it by exploiting vulnerabilities in Yoga's layout calculations or resource management.
    *   Likelihood: High
    *   Impact: High (Application freeze/crash, potential server impact)
    *   Effort: Varies (Low to High, depending on the specific sub-attack)
    *   Skill Level: Varies (Intermediate to Advanced)
    *   Detection Difficulty: Varies (Easy to Hard)

We will now delve into specific attack vectors and their analysis.

### 2.1. Attack Surface Identification

The primary attack surface for Yoga-related DoS attacks lies in the data that defines the layout structure and styling.  This data can be influenced by:

*   **User-Generated Content (UGC):**  If the application allows users to create or modify content that affects the layout (e.g., custom profiles, rich text editors, dynamic layouts based on user input), this is a major attack vector.
*   **External Data Sources:**  If the application fetches layout data from external APIs or databases, and this data is not properly validated, an attacker could compromise the external source to inject malicious layout definitions.
*   **Application Configuration:**  Even if the layout is primarily defined by the application developers, overly complex or poorly configured layouts could be vulnerable to resource exhaustion.
* **Yoga API Misuse:** Incorrect or unintended use of the Yoga API by developers can create vulnerabilities.

### 2.2. Vulnerability Research

Based on a review of Yoga's documentation, source code, and issue tracker, the following potential vulnerabilities and areas of concern are identified:

*   **Deeply Nested Layouts:**  Yoga's layout algorithm, while generally efficient, has a computational complexity that increases with the depth of the layout tree.  Excessively nested layouts can lead to significant CPU consumption and potentially a stack overflow. (See [Hypothetical Attack Vector 1](#231-hypothetical-attack-vector-1-deeply-nested-layouts))
*   **Large Numbers of Nodes:**  A layout with a very large number of nodes, even if not deeply nested, can consume significant memory and processing time. (See [Hypothetical Attack Vector 2](#232-hypothetical-attack-vector-2-excessive-number-of-nodes))
*   **Conflicting Constraints:**  Certain combinations of layout constraints (e.g., `flexGrow`, `flexShrink`, `width`, `height`, `minWidth`, `maxWidth`, etc.) can lead to complex calculations and potentially long resolution times.  An attacker might craft input to trigger these worst-case scenarios. (See [Hypothetical Attack Vector 3](#233-hypothetical-attack-vector-3-conflicting-constraints))
*   **Dynamic Layout Updates:**  Frequent and rapid updates to the layout, especially if triggered by user input or external events, can overwhelm the layout engine and lead to performance degradation. (See [Hypothetical Attack Vector 4](#234-hypothetical-attack-vector-4-frequent-layout-updates))
*   **Memory Leaks (Less Likely, but Possible):**  While Yoga is generally well-managed, bugs in the C/C++ implementation could lead to memory leaks, especially with unusual or edge-case layout configurations.  Repeatedly triggering these leaks could eventually exhaust available memory. (See [Hypothetical Attack Vector 5](#235-hypothetical-attack-vector-5-memory-leaks))
* **Unvalidated Input to Yoga API:** If the application directly exposes Yoga API calls to user-controlled data without proper sanitization, this opens a direct path for exploitation. (See [Hypothetical Attack Vector 6](#236-hypothetical-attack-vector-6-unvalidated-api-input))
* **Yoga Rounding Errors:** In some cases, rounding errors in floating-point calculations within Yoga could potentially lead to unexpected layout behavior or infinite loops, although this is less likely to cause a full DoS. (See [Hypothetical Attack Vector 7](#237-hypothetical-attack-vector-7-rounding-errors))

### 2.3. Hypothetical Attack Vectors

#### 2.3.1. Hypothetical Attack Vector 1: Deeply Nested Layouts

*   **Description:**  The attacker crafts input that results in a layout tree with an extremely high nesting depth (e.g., hundreds or thousands of nested views).
*   **Exploitation:**  The attacker could achieve this through UGC (e.g., a forum post with deeply nested HTML tags, if the application renders HTML using Yoga) or by manipulating external data sources that influence the layout.
*   **Feasibility:**
    *   Likelihood: High (if UGC or external data sources are not validated)
    *   Impact: High (application freeze/crash due to excessive CPU usage or stack overflow)
    *   Effort: Low (relatively easy to create deeply nested structures)
    *   Skill Level: Intermediate
    *   Detection Difficulty: Medium (requires monitoring layout depth)
*   **Mitigation:**
    *   **Input Validation:**  Limit the maximum nesting depth of layout elements.  This can be enforced through schema validation or custom validation logic.
    *   **Recursive Depth Limit:**  Implement a hard limit on the recursion depth within the Yoga engine itself (this would require modifying Yoga's source code).
    *   **Progressive Loading/Rendering:**  For very large or complex layouts, consider rendering only the visible portion initially and loading the rest on demand.

#### 2.3.2. Hypothetical Attack Vector 2: Excessive Number of Nodes

*   **Description:**  The attacker crafts input that results in a layout with a very large number of nodes (e.g., tens of thousands of individual views).
*   **Exploitation:**  Similar to deeply nested layouts, this could be achieved through UGC or manipulation of external data.  For example, a malicious user could create a very long list of items in a social media feed.
*   **Feasibility:**
    *   Likelihood: High (if UGC or external data sources are not validated)
    *   Impact: High (application freeze/crash due to excessive memory consumption and CPU usage)
    *   Effort: Low (relatively easy to create long lists or tables)
    *   Skill Level: Intermediate
    *   Detection Difficulty: Medium (requires monitoring the number of layout nodes)
*   **Mitigation:**
    *   **Input Validation:**  Limit the maximum number of elements in lists, tables, or other structures that can generate large numbers of layout nodes.
    *   **Pagination/Virtualization:**  Implement pagination or virtualization techniques to render only the visible portion of long lists or tables.
    *   **Resource Limits:**  Set limits on the total memory or CPU time that can be consumed by layout calculations.

#### 2.3.3. Hypothetical Attack Vector 3: Conflicting Constraints

*   **Description:**  The attacker crafts input with a combination of layout constraints that are difficult or impossible for Yoga to resolve efficiently.  This might involve conflicting `flexGrow`, `flexShrink`, `minWidth`, `maxWidth`, and other properties.
*   **Exploitation:**  This requires a deeper understanding of Yoga's layout algorithm and how it handles constraint resolution.  The attacker would need to experiment with different combinations of properties to find those that trigger long calculation times.
*   **Feasibility:**
    *   Likelihood: Medium (requires more specialized knowledge of Yoga)
    *   Impact: High (application freeze/crash due to excessive CPU usage)
    *   Effort: High (requires experimentation and analysis of Yoga's behavior)
    *   Skill Level: Advanced
    *   Detection Difficulty: Hard (difficult to identify specific constraint combinations that are problematic)
*   **Mitigation:**
    *   **Constraint Simplification:**  Avoid overly complex layout constraints.  Simplify the layout structure where possible.
    *   **Timeout Mechanism:**  Implement a timeout mechanism for layout calculations.  If a calculation takes too long, abort it and display an error or fallback layout.
    *   **Profiling and Optimization:**  Use profiling tools to identify performance bottlenecks in layout calculations and optimize the layout structure or constraint definitions.

#### 2.3.4. Hypothetical Attack Vector 4: Frequent Layout Updates

*   **Description:**  The attacker triggers frequent and rapid updates to the layout, forcing Yoga to recalculate the layout repeatedly.
*   **Exploitation:**  This could be achieved by sending a stream of updates to the application that modify layout-related properties.  For example, rapidly changing the size or position of a view.
*   **Feasibility:**
    *   Likelihood: Medium (depends on the application's architecture and how it handles updates)
    *   Impact: Medium to High (performance degradation, potential application freeze)
    *   Effort: Low (relatively easy to send frequent updates)
    *   Skill Level: Intermediate
    *   Detection Difficulty: Medium (requires monitoring the frequency of layout updates)
*   **Mitigation:**
    *   **Debouncing/Throttling:**  Implement debouncing or throttling techniques to limit the rate of layout updates.  Only process updates after a certain period of inactivity or at a fixed interval.
    *   **Batching Updates:**  Batch multiple layout updates together and apply them in a single operation.
    *   **Asynchronous Layout Calculation:**  Perform layout calculations in a background thread to avoid blocking the main UI thread.

#### 2.3.5. Hypothetical Attack Vector 5: Memory Leaks

*   **Description:**  The attacker repeatedly triggers a specific layout configuration that causes a memory leak within Yoga.  Over time, this exhausts available memory and leads to a crash.
*   **Exploitation:**  This requires identifying a bug in Yoga's memory management.  The attacker would need to analyze Yoga's source code and find a scenario where memory is allocated but not properly released.
*   **Feasibility:**
    *   Likelihood: Low (Yoga is generally well-tested, but bugs are always possible)
    *   Impact: High (application crash)
    *   Effort: Very High (requires deep understanding of Yoga's internals and C/C++ memory management)
    *   Skill Level: Advanced
    *   Detection Difficulty: Hard (requires specialized memory analysis tools)
*   **Mitigation:**
    *   **Code Reviews:**  Thorough code reviews of Yoga's C/C++ code, focusing on memory allocation and deallocation.
    *   **Memory Analysis Tools:**  Use memory analysis tools (e.g., Valgrind) to detect memory leaks during testing.
    *   **Regular Updates:**  Keep Yoga up-to-date with the latest releases, which may include bug fixes and security patches.
    * **Fuzz Testing:** Use fuzz testing techniques to provide a wide range of inputs to Yoga and identify potential crashes or memory leaks.

#### 2.3.6. Hypothetical Attack Vector 6: Unvalidated API Input

*   **Description:** The application directly exposes Yoga API calls (e.g., `node.setWidth(value)`) to user-controlled data without proper validation or sanitization.
*   **Exploitation:** An attacker could inject malicious values (e.g., extremely large numbers, negative values, non-numeric values) into these API calls, potentially causing unexpected behavior, crashes, or resource exhaustion.
*   **Feasibility:**
    *   Likelihood: High (if API calls are not properly protected)
    *   Impact: High (application crash or unpredictable behavior)
    *   Effort: Low (direct access to the API)
    *   Skill Level: Intermediate
    *   Detection Difficulty: Easy (requires code review and input validation checks)
*   **Mitigation:**
    *   **Strict Input Validation:** Implement rigorous input validation for all data passed to Yoga API calls.  Check for data types, ranges, and allowed values.
    *   **Data Sanitization:** Sanitize user-provided data before passing it to Yoga API calls.  This might involve escaping special characters or converting data to the expected format.
    *   **Principle of Least Privilege:**  Do not expose Yoga API calls directly to untrusted code.  Use a secure intermediary layer to handle user input and interact with Yoga.

#### 2.3.7. Hypothetical Attack Vector 7: Rounding Errors

*   **Description:**  The attacker crafts input that exploits floating-point rounding errors within Yoga's calculations, potentially leading to infinite loops or unexpected layout behavior.
*   **Exploitation:** This is highly theoretical and would require a deep understanding of Yoga's internal calculations and how floating-point numbers are handled.
*   **Feasibility:**
    *   Likelihood: Very Low
    *   Impact: Low to Medium (unpredictable layout behavior, potential minor performance issues)
    *   Effort: Extremely High
    *   Skill Level: Expert
    *   Detection Difficulty: Extremely Hard
*   **Mitigation:**
    *   **Robustness Testing:**  Test Yoga with a wide range of input values, including edge cases and values that are likely to trigger rounding errors.
    *   **Code Review:**  Carefully review Yoga's code for potential rounding error vulnerabilities.
    * **Consider Fixed-Point Arithmetic:** In extremely sensitive scenarios, consider using fixed-point arithmetic instead of floating-point arithmetic to avoid rounding errors altogether (this would require significant changes to Yoga).

### 2.4. Mitigation Strategy Summary

| Attack Vector                     | Mitigation Strategies                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
    public