
## High and Critical vcpkg Threats

| Threat | Description (Attacker Actions & How) | Impact | Affected vcpkg Component | Risk Severity | Mitigation Strategies |
|---|---|---|---|---|---|
| **Malicious Package Injection (Registry)** | An attacker gains control of the official vcpkg registry or a community-maintained repository. They upload a malicious package disguised as a legitimate one or modify an existing package to include malicious code. When a developer uses `vcpkg install <package>`, the malicious package is downloaded and potentially built, injecting malware into the application's dependencies. | **Critical:**  Arbitrary code execution within the application's process, data exfiltration, denial of service, or compromise of the developer's machine during the build process. | vcpkg Registry/Repositories, `vcpkg.exe` (package download and installation logic) | **Critical** | * **Pin specific package versions:** Avoid using wildcards or `latest`. * **Verify package integrity:** Utilize checksums or signatures if available (currently limited in vcpkg). * **Monitor vcpkg updates and announcements:** Stay informed about potential security incidents. * **Consider using a private vcpkg registry:** For sensitive projects, host your own curated package repository. * **Implement code signing for internally built vcpkg packages.** |
| **Compromised Upstream Source** | An attacker compromises the source code repository of a library managed by vcpkg (e.g., a GitHub repository). When `vcpkg.exe` fetches the source code for building, it retrieves the compromised version, leading to malicious code being included in the application's dependencies. | **High:** Similar to registry compromise, leading to malicious code execution within the application. | `vcpkg.exe` (source code download logic), `ports/<package>/portfile.cmake` (source fetching instructions) | **High** | * **Monitor upstream repository activity:** Be aware of unusual commits or changes. * **Review dependency source code:** For critical dependencies, consider auditing the source code. * **Utilize Software Composition Analysis (SCA) tools:** Identify known vulnerabilities in dependencies. * **Consider forking and maintaining your own version of critical dependencies.** |
| **Man-in-the-Middle (MITM) Attack on Download** | An attacker intercepts the download of a vcpkg package or source code by `vcpkg.exe`, replacing it with a malicious version. This could happen if HTTPS is not enforced or if there are vulnerabilities in the TLS implementation used by `vcpkg.exe`. | **High:**  Can lead to the inclusion of compromised libraries in the application. | `vcpkg.exe` (download logic) | **Medium** | * **Ensure HTTPS is enforced for all vcpkg operations.** * **Implement certificate pinning for critical repositories (if feasible).** * **Verify package integrity after download (checksums).** * **Use a secure network connection for development and build processes.** |
| **Malicious Build Scripts (Portfile Compromise)** | An attacker compromises the `portfile.cmake` or other build scripts within a vcpkg package. This allows them to inject malicious commands that are executed by `vcpkg.exe` during the build process on the developer's machine or the build server. | **High:** Arbitrary code execution during the build process, potentially compromising the build environment or developer's machine. | `ports/<package>/portfile.cmake`, `vcpkg.exe` (build execution logic) | **High** | * **Review `portfile.cmake` and other build scripts for suspicious commands before using a new package.** * **Utilize sandboxed build environments:** Limit the privileges of the build process. * **Implement code signing for vcpkg packages (if available).** * **Regularly audit and update vcpkg and its ports.** |
| **Compromised Local vcpkg Instance** | An attacker gains access to a developer's machine and modifies the local vcpkg installation, including cached packages or metadata used by `vcpkg.exe`. This can lead to `vcpkg.exe` installing malicious libraries without the developer's knowledge. | **High:**  Can lead to the inclusion of malicious libraries in the application during development and testing. | Local vcpkg installation directory, `vcpkg.exe` | **Medium** | * **Enforce strong security practices on developer machines.** * **Use separate accounts for development and administrative tasks.** * **Regularly scan developer machines for malware.** * **Implement file integrity monitoring for the vcpkg installation directory.** |
| **Vulnerable Transitive Dependencies** | A direct dependency managed by vcpkg relies on another vulnerable library (transitive dependency). `vcpkg.exe`, by default, will install these transitive dependencies, potentially introducing known vulnerabilities into the application. | **Medium:**  Introduces known vulnerabilities into the application, which could be exploited by attackers. | `vcpkg.exe` (dependency resolution logic), `ports/<package>/portfile.cmake` (dependency declarations) | **High** | * **Utilize Software Composition Analysis (SCA) tools to identify vulnerable transitive dependencies.** * **Keep vcpkg and its managed packages up-to-date using `vcpkg update`.** * **Consider using dependency management tools that provide vulnerability scanning and remediation advice.** * **Evaluate if the vulnerable transitive dependency is truly necessary and explore alternatives.** |
| **Outdated Dependencies** | Developers fail to regularly update vcpkg and its managed packages using `vcpkg update`. This leaves the application vulnerable to known exploits in older versions of the libraries managed by vcpkg. | **Medium:**  Exposes the application to known exploits, increasing the attack surface. | `vcpkg.exe` | **High** | * **Regularly update vcpkg and its managed packages using `vcpkg update --no-dry-run`.** * **Implement automated dependency update processes.** * **Monitor security advisories for used libraries.** * **Establish a policy for timely updates of dependencies.** |